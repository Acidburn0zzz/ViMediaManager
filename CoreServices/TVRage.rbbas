#tag ClassProtected Class TVRageInherits HTTPSocket	#tag Event		Sub Error(code as integer)		  SocketError(code, self)		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub ScrapeResults(Content As String)		  Content = DefineEncoding( Content, Encodings.UTF8 )		  Dim NxtAired, NxtEpisode as String		  Dim idx1, idx2 as Integer		  Dim EpisodeNumber, EpisodeTitle, NextAiredDate(), NextAired(), NextAiredTime as String		  		  idx1 = Content.InStr( 0, "Next Episode@" ) + 13		  idx2 = Content.InStr( idx1, chr(10) ) + 1		  NextAired = Content.Mid(idx1, idx2 - idx1 - 1).Split("^")		  		  if NextAired.Ubound > 0 then		    EpisodeNumber = NextAired(0)		    EpisodeTitle  = NextAired(1)		    NextAiredDate = NextAired(2).Split( "/" )		    		    idx1 = Content.InStr( 0, "Airtime@" ) + 8		    idx2 = Content.InStr( idx1, chr(10) ) + 1		    NextAiredTime = Content.Mid(idx1, idx2 - idx1 - 1).ReplaceAll("am", "AM").ReplaceAll("pm", "PM")		    		    NxtEpisode = "S"+ EpisodeNumber.ReplaceAll( "x", "E" ) + " - " + EpisodeTitle		    		    if NextAiredTime.InStr( -1, "@" ) > -1 then		      'TVAttr.NextAired = NextAiredDate(1) + " " + NextAiredDate(0) + ", " + NextAiredDate(2)		      		      if NextAiredDate.Ubound = 0 then		        NxtAired = NextAiredDate(0)		      elseif NextAiredDate.Ubound = 1 then		        NxtAired = NextAiredDate(1) + " " + NextAiredDate(0)		      elseif NextAiredDate.Ubound = 2 then		        NxtAired = NextAiredDate(1) + " " + NextAiredDate(0) + ", " + NextAiredDate(2)		      elseif NextAiredDate.Ubound = -1 then		        NxtAired = ""		      end if		      		    else		      if NextAiredDate.Ubound = 0 then		        NxtAired = NextAiredDate(0) + " - " + NextAiredTime		      elseif NextAiredDate.Ubound = 1 then		        NxtAired = NextAiredDate(1) + " " + NextAiredDate(0) + " - " + NextAiredTime		      elseif NextAiredDate.Ubound = 2 then		        NxtAired = NextAiredDate(1) + " " + NextAiredDate(0) + ", " + NextAiredDate(2) + " - " + NextAiredTime		      elseif NextAiredDate.Ubound = -1 then		        NxtAired = NextAiredTime		      end if		      // TVAttr.NextAired = NextAiredDate(1) + " " + NextAiredDate(0) + ", " + NextAiredDate(2) + " - " + NextAiredTime		    end if		    'MsgBox EpisodeNumber + " - " + EpisodeTitle + " @ " + NextAiredDate		  end if		  		  if wndMain.ppMedia.Value = 1 then		    TVAttr.NextAired = NxtAired		    TVAttr.NextEpisode = NxtEpisode		  elseif wndMain.ppMedia.Value = 2 then		    AnimeAttr.NextAired = NxtAired		    AnimeAttr.NextEpisode = NxtEpisode		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function URL_QuickInfo(Name as String) As String		  Return "http://services.tvrage.com/tools/quickinfo.php?show=" + String2Entities( Name )		End Function	#tag EndMethod	#tag Note, Name = TVRage Api		http://services.tvrage.com/tools/quickinfo.php?show=%s		http://services.tvrage.com/	#tag EndNote	#tag Constant, Name = ApiKey, Type = String, Dynamic = False, Default = \"HDeBGd0RITrO3fPOTBr2", Scope = Protected	#tag EndConstant	#tag ViewBehavior		#tag ViewProperty			Name="Address"			Visible=true			Group="Behavior"			Type="String"			InheritedFrom="TCPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="defaultPort"			Group="Behavior"			InitialValue="0"			Type="integer"			InheritedFrom="HTTPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="httpProxyAddress"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="HTTPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="httpProxyPort"			Group="Behavior"			InitialValue="0"			Type="integer"			InheritedFrom="HTTPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			Type="Integer"			InheritedFrom="TCPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InheritedFrom="TCPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="TCPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="Port"			Visible=true			Group="Behavior"			InitialValue="0"			Type="Integer"			InheritedFrom="TCPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="TCPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InheritedFrom="TCPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="yield"			Visible=true			Group="Behavior"			InitialValue="1"			Type="boolean"			InheritedFrom="HTTPSocket"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass