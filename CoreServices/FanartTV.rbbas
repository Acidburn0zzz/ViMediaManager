#tag ClassProtected Class FanartTVInherits HTTPSocket	#tag Event		Sub Error(code as integer)		  SocketError(code, self)		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub GetArt(XmlContent As String, Mode As String)		  // Modes: clearart, clearlogo, tvthumb, seasonthumb		  Dim Xml as new XmlDocument		  Dim xroot, xnode as XmlNode		  Dim i, ArtIndex as Integer		  		  Xml.PreserveWhitespace = False		  Xml.LoadXml( XmlContent )		  xroot = Xml.Child(0).FirstChild		  ReDim Scrape.ArtThumb(-1)		  		  if xroot = nil or xroot.ChildCount <= 0 then		    MsgBox "No images found"		    Return		  end if		  Scrape.ClearArts		  ArtIndex = xroot.ChildCount		  for i = 0 to xroot.ChildCount - 1		    		    xnode = xroot.Child(i)		    if Mode <> "tvthumb" and Mode <> "seasonthumb" then		      Scrape.ArtThumb.Append URL2Picture( xnode.GetAttribute("url").ReplaceAll(" ", "%20"), "Thumb_" + str(i), "png" )		    else		      Scrape.ArtThumb.Append URL2Picture( xnode.GetAttribute("url").ReplaceAll(" ", "%20"), "Thumb_" + str(i) )		    end if		    		    if Mode = "clearart" then		      Progressor("Downloading:", str(ArtIndex) + " ClearArt images...", ArtIndex - 1, i )		    elseif Mode = "tvthumb" then		      Progressor("Downloading:", str(ArtIndex) + " TV Thumb images...", ArtIndex - 1, i )		    elseif Mode = "clearlogo" then		      Progressor("Downloading:", str(ArtIndex) + " Logo images...", ArtIndex - 1, i )		    end if		    		  next // @END xroot.ChildCount		  		  Progressor("close")		  if Mode = "clearart"  or Mode = "tvthumb" then		    wndArtPreview.Width = 500		    wndArtPreview.Height = 281 + 52		  elseif Mode = "clearlogo" then		    wndArtPreview.Width = 400 + 20		    wndArtPreview.Height = 155 + 20 + 52		  elseif Mode = "seasonthumb" then		    // :ToDo		  end if		  wndArtPreview.Mode = "FanartTV-" + Mode		  wndArtPreview.Show		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function URL_Images(ID As String, Type As String) As String		  Return "http://fanart.tv/api/fanart.php?id=" + ID + "&type=" + Type + "&sort=favdesc"		End Function	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="Address"			Visible=true			Group="Behavior"			Type="String"			InheritedFrom="TCPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="defaultPort"			Group="Behavior"			InitialValue="0"			Type="integer"			InheritedFrom="HTTPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="httpProxyAddress"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="HTTPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="httpProxyPort"			Group="Behavior"			InitialValue="0"			Type="integer"			InheritedFrom="HTTPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			Type="Integer"			InheritedFrom="TCPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InheritedFrom="TCPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="TCPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="Port"			Visible=true			Group="Behavior"			InitialValue="0"			Type="Integer"			InheritedFrom="TCPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="TCPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InheritedFrom="TCPSocket"		#tag EndViewProperty		#tag ViewProperty			Name="yield"			Visible=true			Group="Behavior"			InitialValue="1"			Type="boolean"			InheritedFrom="HTTPSocket"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass