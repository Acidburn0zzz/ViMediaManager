#tag WindowBegin Window wndEpisodes   BackColor       =   &hFFFFFF   Backdrop        =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   7.02e+2   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   3   Resizeable      =   False   Title           =   "#Loc.kEpisodes"   Visible         =   True   Width           =   9.02e+2   Begin HierListBox lstEpisodes      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   ""      Border          =   False      ColumnCount     =   5      ColumnsResizable=   ""      ColumnWidths    =   "100%, 0"      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   48      Enabled         =   True      EnableDrag      =   ""      EnableDragReorder=   ""      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   ""      HeadingIndex    =   -1      Height          =   703      HelpTag         =   ""      Hierarchical    =   False      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   -1      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   True      RequiresSelection=   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollBarVertical=   True      SelectionType   =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   13      TextUnit        =   0      Top             =   -1      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   337      _ScrollWidth    =   -1   End   Begin ccCancelSave CancelSave      AcceptFocus     =   ""      AcceptTabs      =   True      AutoDeactivate  =   True      BackColor       =   &hFFFFFF      Backdrop        =   ""      Enabled         =   True      EraseBackground =   True      HasBackColor    =   False      Height          =   22      HelpTag         =   ""      InitialParent   =   ""      Left            =   682      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Top             =   659      UseFocusRing    =   ""      Visible         =   True      Width           =   200   End   Begin PagePanel ppEpisodes      AutoDeactivate  =   True      Enabled         =   True      Height          =   648      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   336      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      PanelCount      =   3      Panels          =   ""      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      Top             =   -1      Value           =   2      Visible         =   True      Width           =   566      Begin ExtraArtCanvas cvsSeasonArt         AcceptFocus     =   ""         AcceptTabs      =   ""         AutoDeactivate  =   True         Backdrop        =   ""         DoubleBuffer    =   False         Enabled         =   True         EraseBackground =   True         Height          =   377         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Left            =   336         LockBottom      =   True         LockedInPosition=   False         LockLeft        =   True         LockRight       =   True         LockTop         =   True         Mode            =   "Poster"         Scope           =   0         Season          =   -1         TabIndex        =   0         TabPanelIndex   =   1         TabStop         =   True         Top             =   -1         UseFocusRing    =   True         Visible         =   True         Width           =   566         Begin PopupArrow popSeasonArt            AutoDeactivate  =   True            Enabled         =   True            Facing          =   1            Height          =   10            HelpTag         =   ""            Index           =   -2147483648            InitialParent   =   "cvsSeasonArt"            Left            =   874            LockBottom      =   True            LockedInPosition=   False            LockLeft        =   False            LockRight       =   True            LockTop         =   False            Scope           =   0            TabIndex        =   0            TabPanelIndex   =   1            TabStop         =   True            Top             =   351            Visible         =   True            Width           =   10         End      End      Begin TextField edtTitle         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   358         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   2         TabStop         =   True         Text            =   ""         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   34         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   524      End      Begin Label lblArray         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   16         HelpTag         =   ""         Index           =   0         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   358         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         Selectable      =   False         TabIndex        =   1         TabPanelIndex   =   2         Text            =   "#Loc.mTitle"         TextAlign       =   0         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   14         Transparent     =   False         Underline       =   ""         Visible         =   True         Width           =   524      End      Begin Label lblArray         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   16         HelpTag         =   ""         Index           =   2         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   358         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         Selectable      =   False         TabIndex        =   5         TabPanelIndex   =   2         Text            =   "#Loc.kPlot"         TextAlign       =   0         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   131         Transparent     =   False         Underline       =   ""         Visible         =   True         Width           =   524      End      Begin TextArea edtPlot         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   True         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   122         HelpTag         =   ""         HideSelection   =   True         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   358         LimitText       =   0         LineHeight      =   0         LineSpacing     =   1         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Multiline       =   True         ReadOnly        =   ""         Scope           =   0         ScrollbarHorizontal=   ""         ScrollbarVertical=   True         Styled          =   True         TabIndex        =   6         TabPanelIndex   =   2         TabStop         =   True         Text            =   ""         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   151         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   524      End      Begin Canvas cvsActorIMG         AcceptFocus     =   ""         AcceptTabs      =   ""         AutoDeactivate  =   True         Backdrop        =   ""         DoubleBuffer    =   False         Enabled         =   True         EraseBackground =   True         Height          =   191         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Left            =   752         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   True         LockTop         =   True         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   3         TabStop         =   True         Top             =   283         UseFocusRing    =   True         Visible         =   True         Width           =   130         Begin HTTPSocket scktActor            Address         =   ""            Height          =   32            Index           =   -2147483648            InitialParent   =   "cvsActorIMG"            Left            =   779            LockedInPosition=   False            Port            =   0            Scope           =   0            TabPanelIndex   =   3            Top             =   300            Width           =   32            yield           =   0         End         Begin Thread thrActor            Height          =   32            Index           =   -2147483648            InitialParent   =   "cvsActorIMG"            Left            =   823            LockedInPosition=   False            Priority        =   5            Scope           =   0            StackSize       =   0            TabPanelIndex   =   3            Top             =   300            Width           =   32         End      End      Begin ProgressBar pgActor         AutoDeactivate  =   True         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Left            =   752         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   False         LockRight       =   True         LockTop         =   True         Maximum         =   100         Scope           =   0         TabPanelIndex   =   3         Top             =   486         Value           =   0         Visible         =   False         Width           =   130      End      Begin SuperTextfield edtWriter         AcceptTabs      =   ""         Alignment       =   0         AutoComplete    =   ""         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   348         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   4         TabPanelIndex   =   3         TabStop         =   True         Text            =   ""         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   353         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   250      End      Begin Label lblArray         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   16         HelpTag         =   ""         Index           =   27         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   348         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         Selectable      =   False         TabIndex        =   5         TabPanelIndex   =   3         Text            =   "#Loc.mWriter"         TextAlign       =   0         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   12         TextUnit        =   0         Top             =   335         Transparent     =   False         Underline       =   ""         Visible         =   True         Width           =   250      End      Begin Label lblArray         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   16         HelpTag         =   ""         Index           =   26         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   348         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         Selectable      =   False         TabIndex        =   6         TabPanelIndex   =   3         Text            =   "#Loc.mDirector"         TextAlign       =   0         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   12         TextUnit        =   0         Top             =   283         Transparent     =   False         Underline       =   ""         Visible         =   True         Width           =   250      End      Begin SuperTextfield edtDirector         AcceptTabs      =   ""         Alignment       =   0         AutoComplete    =   ""         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   348         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   7         TabPanelIndex   =   3         TabStop         =   True         Text            =   ""         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   301         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   250      End      Begin SuperTextfield edtSound         AcceptTabs      =   ""         Alignment       =   0         AutoComplete    =   ""         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   348         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   8         TabPanelIndex   =   3         TabStop         =   True         Text            =   ""         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   405         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   250      End      Begin Label lblArray         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   16         HelpTag         =   ""         Index           =   28         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   348         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         Selectable      =   False         TabIndex        =   9         TabPanelIndex   =   3         Text            =   "#Loc.mSound"         TextAlign       =   0         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   12         TextUnit        =   0         Top             =   387         Transparent     =   False         Underline       =   ""         Visible         =   True         Width           =   250      End      Begin SuperTextfield edtActorThumbURL         AcceptTabs      =   ""         Alignment       =   0         AutoComplete    =   ""         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   696         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   11         TabPanelIndex   =   3         TabStop         =   True         Text            =   ""         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   249         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   129      End      Begin SuperTextfield edtActorName         AcceptTabs      =   ""         Alignment       =   0         AutoComplete    =   ""         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   348         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   12         TabPanelIndex   =   3         TabStop         =   True         Text            =   ""         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   249         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   150      End      Begin SuperTextfield edtActorRole         AcceptTabs      =   ""         Alignment       =   0         AutoComplete    =   ""         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   497         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   13         TabPanelIndex   =   3         TabStop         =   True         Text            =   ""         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   249         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   200      End      Begin ListboxPRO lstActors         AlternatingRows =   True         AutoDeactivate  =   True         AutoHideScrollbars=   True         Bold            =   ""         Border          =   True         ColumnCount     =   4         ColumnsResizable=   ""         ColumnWidths    =   "150, 200, *, 0"         DataField       =   ""         DataSource      =   ""         DefaultRowHeight=   22         Enabled         =   True         EnableDrag      =   ""         EnableDragReorder=   True         GridLinesHorizontal=   0         GridLinesVertical=   0         HasHeading      =   True         HeadingIndex    =   -1         Height          =   223         HelpTag         =   ""         Hierarchical    =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         InitialValue    =   "#Loc.kName	#Loc.kRole	#Loc.kThumbURL	ID"         Italic          =   ""         Left            =   348         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         RequiresSelection=   ""         Scope           =   0         ScrollbarHorizontal=   ""         ScrollBarVertical=   True         SelectionGradient=   True         SelectionType   =   0         SourceList      =   False         TabIndex        =   15         TabPanelIndex   =   3         TabStop         =   True         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   14         TypeToSearch    =   True         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   534         _ScrollWidth    =   -1      End      Begin Label lblArray         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   22         HelpTag         =   ""         Index           =   3         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   358         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         Selectable      =   False         TabIndex        =   7         TabPanelIndex   =   2         Text            =   "#Loc.mSeasonNumber"         TextAlign       =   2         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   69         Transparent     =   False         Underline       =   ""         Visible         =   True         Width           =   120      End      Begin TextField edtSeasonNr         AcceptTabs      =   ""         Alignment       =   3         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   490         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   8         TabPanelIndex   =   2         TabStop         =   True         Text            =   ""         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   68         Underline       =   ""         UseFocusRing    =   True         Visible         =   True         Width           =   44      End      Begin Label lblArray         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   22         HelpTag         =   ""         Index           =   4         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   651         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         Selectable      =   False         TabIndex        =   9         TabPanelIndex   =   2         Text            =   "#Loc.mEpisodeNumber"         TextAlign       =   2         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   69         Transparent     =   False         Underline       =   ""         Visible         =   True         Width           =   150      End      Begin TextField edtEpisodeNr         AcceptTabs      =   ""         Alignment       =   3         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   813         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   10         TabPanelIndex   =   2         TabStop         =   True         Text            =   ""         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   69         Underline       =   ""         UseFocusRing    =   True         Visible         =   True         Width           =   44      End      Begin UpDownArrows udSeason         AcceptFocus     =   False         AutoDeactivate  =   True         Enabled         =   True         Height          =   23         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Left            =   546         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   11         TabPanelIndex   =   2         TabStop         =   True         Top             =   68         Visible         =   True         Width           =   13      End      Begin UpDownArrows udRating         AcceptFocus     =   False         AutoDeactivate  =   True         Enabled         =   True         Height          =   23         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Left            =   546         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   16         TabPanelIndex   =   2         TabStop         =   True         Top             =   104         Visible         =   True         Width           =   13      End      Begin SuperTextfield edtRating         AcceptTabs      =   ""         Alignment       =   3         AutoComplete    =   ""         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   1         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   490         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   "99.#"         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   17         TabPanelIndex   =   2         TabStop         =   True         Text            =   10.9         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   104         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   45      End      Begin Label lblArray         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   22         HelpTag         =   ""         Index           =   9         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   358         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         Selectable      =   False         TabIndex        =   18         TabPanelIndex   =   2         Text            =   "#Loc.mRating"         TextAlign       =   2         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   104         Transparent     =   False         Underline       =   ""         Visible         =   True         Width           =   120      End      Begin Label lblArray         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   22         HelpTag         =   ""         Index           =   8         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   627         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         Selectable      =   False         TabIndex        =   20         TabPanelIndex   =   2         Text            =   "#Loc.kpremiered"         TextAlign       =   2         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   104         Transparent     =   False         Underline       =   ""         Visible         =   True         Width           =   120      End      Begin SuperTextfield edtPremiere         AcceptTabs      =   ""         Alignment       =   3         AutoComplete    =   ""         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   759         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   "9999-99-99"         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   21         TabPanelIndex   =   2         TabStop         =   True         Text            =   "0000-00-00"         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   104         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   98      End      Begin SuperTextfield edtGuests         AcceptTabs      =   ""         Alignment       =   0         AutoComplete    =   ""         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   348         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   16         TabPanelIndex   =   3         TabStop         =   True         Text            =   ""         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   457         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   392      End      Begin Label lblArray         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   15         HelpTag         =   ""         Index           =   29         InitialParent   =   "ppEpisodes"         Italic          =   ""         Left            =   348         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         Selectable      =   False         TabIndex        =   17         TabPanelIndex   =   3         Text            =   "#Loc.kGuests"         TextAlign       =   0         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   12         TextUnit        =   0         Top             =   439         Transparent     =   False         Underline       =   ""         Visible         =   True         Width           =   392      End      Begin UpDownArrows udEpisode         AcceptFocus     =   False         AutoDeactivate  =   True         Enabled         =   True         Height          =   23         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Left            =   869         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   22         TabPanelIndex   =   2         TabStop         =   True         Top             =   69         Visible         =   True         Width           =   13      End      Begin UpDownArrows udDate         AcceptFocus     =   False         AutoDeactivate  =   True         Enabled         =   True         Height          =   23         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Left            =   869         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   23         TabPanelIndex   =   2         TabStop         =   True         Top             =   104         Visible         =   True         Width           =   13      End      Begin Canvas cvsEpisodeThumb         AcceptFocus     =   ""         AcceptTabs      =   ""         AutoDeactivate  =   True         Backdrop        =   ""         DoubleBuffer    =   False         Enabled         =   True         EraseBackground =   True         Height          =   280         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Left            =   358         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Scope           =   0         TabIndex        =   24         TabPanelIndex   =   2         TabStop         =   True         Top             =   285         UseFocusRing    =   True         Visible         =   True         Width           =   524         Begin Thread ThrEpisodeThumb            Height          =   32            Index           =   -2147483648            InitialParent   =   "cvsEpisodeThumb"            Left            =   830            LockedInPosition=   False            Priority        =   5            Scope           =   0            StackSize       =   0            TabPanelIndex   =   2            Top             =   402            Width           =   32         End      End      Begin Canvas grpSpecials         AcceptFocus     =   ""         AcceptTabs      =   ""         AutoDeactivate  =   True         Backdrop        =   ""         DoubleBuffer    =   False         Enabled         =   True         EraseBackground =   True         Height          =   56         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Left            =   358         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   25         TabPanelIndex   =   2         TabStop         =   True         Top             =   577         UseFocusRing    =   True         Visible         =   True         Width           =   524         Begin TextField edtAfterSeason            AcceptTabs      =   ""            Alignment       =   3            AutoDeactivate  =   True            AutomaticallyCheckSpelling=   False            BackColor       =   &hFFFFFF            Bold            =   ""            Border          =   True            CueText         =   ""            DataField       =   ""            DataSource      =   ""            Enabled         =   True            Format          =   ""            Height          =   22            HelpTag         =   ""            Index           =   -2147483648            InitialParent   =   "grpSpecials"            Italic          =   ""            Left            =   813            LimitText       =   0            LockBottom      =   ""            LockedInPosition=   False            LockLeft        =   True            LockRight       =   ""            LockTop         =   True            Mask            =   ""            Password        =   ""            ReadOnly        =   ""            Scope           =   0            TabIndex        =   0            TabPanelIndex   =   2            TabStop         =   True            Text            =   ""            TextColor       =   &h000000            TextFont        =   "System"            TextSize        =   0            TextUnit        =   0            Top             =   577            Underline       =   ""            UseFocusRing    =   True            Visible         =   True            Width           =   44         End         Begin UpDownArrows udAfterSeason            AcceptFocus     =   False            AutoDeactivate  =   True            Enabled         =   True            Height          =   23            HelpTag         =   ""            Index           =   -2147483648            InitialParent   =   "grpSpecials"            Left            =   869            LockBottom      =   ""            LockedInPosition=   False            LockLeft        =   True            LockRight       =   ""            LockTop         =   True            Scope           =   0            TabIndex        =   1            TabPanelIndex   =   2            TabStop         =   True            Top             =   577            Visible         =   True            Width           =   13         End         Begin Label lblArray            AutoDeactivate  =   True            Bold            =   True            DataField       =   ""            DataSource      =   ""            Enabled         =   True            Height          =   22            HelpTag         =   ""            Index           =   5            InitialParent   =   "grpSpecials"            Italic          =   ""            Left            =   438            LockBottom      =   ""            LockedInPosition=   False            LockLeft        =   True            LockRight       =   ""            LockTop         =   True            Multiline       =   ""            Scope           =   0            Selectable      =   False            TabIndex        =   2            TabPanelIndex   =   2            Text            =   "#Loc.kEMBeforeEpisode"            TextAlign       =   2            TextColor       =   &h000000            TextFont        =   "System"            TextSize        =   0            TextUnit        =   0            Top             =   611            Transparent     =   False            Underline       =   ""            Visible         =   True            Width           =   120         End         Begin TextField edtBeforeEpisode            AcceptTabs      =   ""            Alignment       =   3            AutoDeactivate  =   True            AutomaticallyCheckSpelling=   False            BackColor       =   &hFFFFFF            Bold            =   ""            Border          =   True            CueText         =   ""            DataField       =   ""            DataSource      =   ""            Enabled         =   True            Format          =   ""            Height          =   22            HelpTag         =   ""            Index           =   -2147483648            InitialParent   =   "grpSpecials"            Italic          =   ""            Left            =   570            LimitText       =   0            LockBottom      =   ""            LockedInPosition=   False            LockLeft        =   True            LockRight       =   ""            LockTop         =   True            Mask            =   ""            Password        =   ""            ReadOnly        =   ""            Scope           =   0            TabIndex        =   3            TabPanelIndex   =   2            TabStop         =   True            Text            =   ""            TextColor       =   &h000000            TextFont        =   "System"            TextSize        =   0            TextUnit        =   0            Top             =   611            Underline       =   ""            UseFocusRing    =   True            Visible         =   True            Width           =   44         End         Begin UpDownArrows udBeforeEpisode            AcceptFocus     =   False            AutoDeactivate  =   True            Enabled         =   True            Height          =   23            HelpTag         =   ""            Index           =   -2147483648            InitialParent   =   "grpSpecials"            Left            =   626            LockBottom      =   ""            LockedInPosition=   False            LockLeft        =   True            LockRight       =   ""            LockTop         =   True            Scope           =   0            TabIndex        =   5            TabPanelIndex   =   2            TabStop         =   True            Top             =   611            Visible         =   True            Width           =   13         End         Begin UpDownArrows udBeforeSeason            AcceptFocus     =   False            AutoDeactivate  =   True            Enabled         =   True            Height          =   23            HelpTag         =   ""            Index           =   -2147483648            InitialParent   =   "grpSpecials"            Left            =   626            LockBottom      =   ""            LockedInPosition=   False            LockLeft        =   True            LockRight       =   ""            LockTop         =   True            Scope           =   0            TabIndex        =   6            TabPanelIndex   =   2            TabStop         =   True            Top             =   577            Visible         =   True            Width           =   13         End         Begin TextField edtBeforeSeason            AcceptTabs      =   ""            Alignment       =   3            AutoDeactivate  =   True            AutomaticallyCheckSpelling=   False            BackColor       =   &hFFFFFF            Bold            =   ""            Border          =   True            CueText         =   ""            DataField       =   ""            DataSource      =   ""            Enabled         =   True            Format          =   ""            Height          =   22            HelpTag         =   ""            Index           =   -2147483648            InitialParent   =   "grpSpecials"            Italic          =   ""            Left            =   570            LimitText       =   0            LockBottom      =   ""            LockedInPosition=   False            LockLeft        =   True            LockRight       =   ""            LockTop         =   True            Mask            =   ""            Password        =   ""            ReadOnly        =   ""            Scope           =   0            TabIndex        =   7            TabPanelIndex   =   2            TabStop         =   True            Text            =   ""            TextColor       =   &h000000            TextFont        =   "System"            TextSize        =   0            TextUnit        =   0            Top             =   577            Underline       =   ""            UseFocusRing    =   True            Visible         =   True            Width           =   44         End         Begin Label lblArray            AutoDeactivate  =   True            Bold            =   True            DataField       =   ""            DataSource      =   ""            Enabled         =   True            Height          =   22            HelpTag         =   ""            Index           =   7            InitialParent   =   "grpSpecials"            Italic          =   ""            Left            =   438            LockBottom      =   ""            LockedInPosition=   False            LockLeft        =   True            LockRight       =   ""            LockTop         =   True            Multiline       =   ""            Scope           =   0            Selectable      =   False            TabIndex        =   8            TabPanelIndex   =   2            Text            =   "#Loc.kEMBeforeSeason"            TextAlign       =   2            TextColor       =   &h000000            TextFont        =   "System"            TextSize        =   0            TextUnit        =   0            Top             =   577            Transparent     =   False            Underline       =   ""            Visible         =   True            Width           =   120         End         Begin Label lblArray            AutoDeactivate  =   True            Bold            =   True            DataField       =   ""            DataSource      =   ""            Enabled         =   True            Height          =   22            HelpTag         =   ""            Index           =   6            InitialParent   =   "grpSpecials"            Italic          =   ""            Left            =   651            LockBottom      =   ""            LockedInPosition=   False            LockLeft        =   True            LockRight       =   ""            LockTop         =   True            Multiline       =   ""            Scope           =   0            Selectable      =   False            TabIndex        =   4            TabPanelIndex   =   2            Text            =   "#Loc.kEMAfterSeason"            TextAlign       =   2            TextColor       =   &h000000            TextFont        =   "System"            TextSize        =   0            TextUnit        =   0            Top             =   577            Transparent     =   False            Underline       =   ""            Visible         =   True            Width           =   150         End      End      Begin AddRemoveButtons arActor         AcceptFocus     =   ""         AcceptTabs      =   ""         AutoDeactivate  =   True         Backdrop        =   ""         DoubleBuffer    =   False         Enabled         =   True         EraseBackground =   True         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppEpisodes"         Left            =   837         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   18         TabPanelIndex   =   3         TabStop         =   True         Top             =   249         UseFocusRing    =   True         Visible         =   True         Width           =   45      End   End   Begin PushButton PushButton1      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "Switch"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   348      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   659      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin CheckBox chkWatched      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Watched"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   1050      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      State           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   604      Underline       =   ""      Value           =   False      Visible         =   True      Width           =   100   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Close()		  thrActor.Kill		  scktActor.Close		  		  wndMain.lstTVShows.Enabled = True		End Sub	#tag EndEvent	#tag Event		Sub Open()		  wndMain.lstTVShows.Enabled = False		  ReadJSON		  		  If lstEpisodes.ListCount <= 1 Then lstEpisodes.AddRow "Please update " + TVAttr.Title + "."		End Sub	#tag EndEvent	#tag MenuHandler		Function FileCloseWindo() As Boolean Handles FileCloseWindo.Action			Self.Close			Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileOpenInFinder() As Boolean Handles FileOpenInFinder.Action			If lstEpisodes.Cell( lstEpisodes.ListIndex, 2 ) = "" Then Return False						Dim f as FolderItem = GetFolderItem( lstEpisodes.Cell( lstEpisodes.ListIndex, 2 ) )			If f IsA FolderItem Then f.ShowInFinder			Return True					End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Sub GetEpisodeInfo(EpisodeFile as FolderItem)		  If lstEpisodes.ListIndex < 0 Then Return		  		  ThisEpisode = Nil		  If lstEpisodes.Cell( lstEpisodes.ListIndex, 5 ) <> "" Then		    ThisEpisode = Episodes.Child( Val( lstEpisodes.Cell( lstEpisodes.ListIndex, 5 ) ) )		    ThisEpisode.Compact = False		  Else		    Return		  End If		  		  lstActors.DeleteAllRows		  		  		  Dim Xml as New XmlDocument		  Dim xRoot, xNode, xItem as XmlNode		  Xml.PreserveWhitespace = False		  		  If EpisodeFile <> Nil Then		    Dim NFOFile as FolderItem = EpisodeFile.Parent.Child( EpisodeFile.NameWithoutExtension + ".nfo" )		    If NFOFile <> Nil And NFOFile.Exists Then Xml.LoadXml( ReadTextFile( NFOFile ) )		  End If		  		  // Set local NFO data to ThisEpisode.JSON		  If Xml.FirstChild <> Nil Then		    xRoot = Xml.FirstChild		    		    For i as Integer = 0 to xRoot.ChildCount -1		      xNode = xRoot.Child(i)		      		      If xNode.FirstChild = Nil Then Continue		      		      Select Case xNode.Name		        		      Case "id"		        If xNode.GetAttribute("moviedb") = "IMDb" Then		          ThisEpisode.Value("IMDB_ID") = xNode.FirstChild.Value		        ElseIf xNode.GetAttribute("moviedb") = "TVDB" Then		          ThisEpisode.Value("id") = xNode.FirstChild.Value		        End If		        		      Case "title"		        ThisEpisode.Value("EpisodeName") = xNode.FirstChild.Value		        		      Case "season"		        ThisEpisode.Value("SeasonNumber") = xNode.FirstChild.Value		        		      Case "episode"		        ThisEpisode.Value("EpisodeNumber") = xNode.FirstChild.Value		        		      Case "FirstAired"		        ThisEpisode.Value("FirstAired") = xNode.FirstChild.Value		        		      Case "displayseason"		        ThisEpisode.Value("airsbefore_season") = xNode.FirstChild.Value		        		      Case "displayepisode"		        ThisEpisode.Value("airsbefore_episode") = xNode.FirstChild.Value		        		      Case "airsafterseason"		        ThisEpisode.Value("airsafter_season") = xNode.FirstChild.Value		        		      Case "airsbeforeseason"		        ThisEpisode.Value("airsbefore_season") = xNode.FirstChild.Value		        		      Case "airsbeforeepisode"		        ThisEpisode.Value("airsbefore_episode") = xNode.FirstChild.Value		        		      Case "runtime"		        ThisEpisode.Value("Runtime") = xNode.FirstChild.Value		        		      Case "rating"		        ThisEpisode.Value("Rating") = xNode.FirstChild.Value		        		      Case "votes"		        ThisEpisode.Value("Votes") = xNode.FirstChild.Value		        		      Case "watched"		        ThisEpisode.Value("watched") = xNode.FirstChild.Value		        		      Case "outline"		        ThisEpisode.Value("outline") = xNode.FirstChild.Value		        		      Case "plot"		        ThisEpisode.Value("plot") = xNode.FirstChild.Value		        		      Case "thumb"		        ThisEpisode.Value("filename") = xNode.FirstChild.Value		        		      Case "director"		        ThisEpisode.Value("director") = xNode.FirstChild.Value		        		      Case "credits"		        ThisEpisode.Value("credits") = xNode.FirstChild.Value		        		      Case "guests"		        ThisEpisode.Value("guests") = xNode.FirstChild.Value		        		      Case "actor"		        If xNode.AttributeCount > -1 Then		          lstActors.AddRow "", "", "", xNode.GetAttribute("id")		        Else		          lstActors.AddRow		        End If		        		        		        For n as Integer = 0 to xNode.ChildCount -1		          xItem = xNode.Child(n)		          		          Select case xItem.Name		            		          Case "name"		            If xItem.FirstChild <> Nil Then lstActors.Cell( lstActors.LastIndex, 0 ) = xItem.FirstChild.Value		            If ThisEpisode.HasName("guests") And ThisEpisode.Value("guests").InStr( 0, xItem.FirstChild.Value ) > 0 Then		              lstActors.RowPicture( lstActors.LastIndex ) = ScaleImage( starring, 16, 16 )		            End If		            		          Case "role"		            If xItem.FirstChild <> Nil Then lstActors.Cell( lstActors.LastIndex, 1 ) = xItem.FirstChild.Value		          Case "thumb"		            If xItem.FirstChild <> Nil Then lstActors.Cell( lstActors.LastIndex, 2 ) = xItem.FirstChild.Value		            		          End Select		          		        Next		        		      End Select		      		    Next		    		    		    xRoot.Indent(0)		    		  End If		  		  edtTitle.Text      = ThisEpisode.Value("EpisodeName")		  'edtOutline.Text    = ThisEpisode.Value("outline")		  edtPlot.Text       = ThisEpisode.Value("plot")		  		  edtSeasonNr.Text   = ThisEpisode.Value( "SeasonNumber" )		  edtEpisodeNr.Text  = ThisEpisode.Value( "EpisodeNumber" )		  edtPremiere.Text   = ThisEpisode.Value( "FirstAired" )		  edtGuests.Text     = ThisEpisode.Value( "guests" )		  While edtGuests.Text.InStr( 0, " ," ) > 0		    edtGuests.Text = edtGuests.Text.ReplaceAll(" ,", ",")		  Wend		  		  edtRating.Text     = ThisEpisode.Value( "Rating" )		  chkWatched.Value   = ThisEpisode.Value( "watched" )		  		  If ThisEpisode.Value("SeasonNumber") = 0 And ThisEpisode.HasName("airsbefore_season") Then		    grpSpecials.Visible = True		    edtBeforeSeason.Text  = ThisEpisode.Value("airsbefore_season")		    edtAfterSeason.Text   = ThisEpisode.Value("airsafter_season")		    		    edtBeforeEpisode.Text = ThisEpisode.Value("airsbefore_episode")		  Else		    grpSpecials.Visible = False		    edtBeforeSeason.Text  = ""		    edtAfterSeason.Text   = ""		    edtBeforeEpisode.Text = ""		  End If		  		  If lstActors.ListCount = 0 Then		    For i as Integer = 0 to ThisEpisode.Child("Cast").Count -1		      lstActors.AddRow ThisEpisode.Child("Cast").Value(i),  ThisEpisode.Child("Roles").Value(i),  ThisEpisode.Child("CastThumbs").Value(i)		      If ThisEpisode.Value("guests").InStr( 0, ThisEpisode.Child("Cast").Value(i) ) > 0 Then lstActors.RowPicture( lstActors.LastIndex ) = ScaleImage( starring, 16, 16 )		    Next		  End If		  		  // Thumb		  ThrEpisodeThumb.Run		  		  'test.Text = ThisEpisode.ToString + EndOfLine + EndOfLine + Xml.ToString		  Dim s as String		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub GetSeasonInfo(SeasonNr as String, Mode as String = "")		  Dim DisplaySeason as String = SeasonNr		  If DisplaySeason.Len = 1 Then DisplaySeason = "0" + DisplaySeason		  Dim Specials as Boolean = ( Val( DisplaySeason ) = 0 )		  Dim All as Boolean = ( Val( DisplaySeason ) < 0 )		  		  		  Dim SeasonFolder, ImageFile as FolderItem		  		  // Season Folder		  SeasonFolder = TVAttr.FolderParent.Child("Season " + DisplaySeason)		  If SeasonNr = "0" Then SeasonFolder = TVAttr.FolderParent.Child( "Specials" )		  		  If SeasonFolder <> Nil And SeasonFolder.Exists And SeasonFolder.Directory Then		    // Folder exists, don't change anything.		  Else		    SeasonFolder = TVAttr.FolderParent		  End If		  		  		  // Poster		  If Mode = "" Or Mode = "Poster" Then		    If Specials Then		      ImageFile = SeasonFolder.Child("specials.jpg")		    ElseIf All Then		      ImageFile = SeasonFolder.Child("season-all.jpg")		    Else		      ImageFile = SeasonFolder.Child( "season " + DisplaySeason + ".jpg" )		    End If		    If ImageFile IsA FolderItem Then SeasonPoster = Picture.Open( ImageFile ) Else SeasonPoster = Nil		    cvsSeasonArt.Reload( SeasonPoster )		  End If		  ImageFile = Nil		  		  // Fanart		  If Mode = "" Or Mode = "Fanart" Then		    If Specials Then		      ImageFile = SeasonFolder.Child("specials-fanart.jpg")		    ElseIf All Then		      ImageFile = SeasonFolder.Child("seasonall-fanart.jpg")		    Else		      ImageFile = SeasonFolder.Child( "season " + DisplaySeason + "-fanart.jpg" )		    End If		    If ImageFile IsA FolderItem Then SeasonFanart = Picture.Open( ImageFile ) Else SeasonFanart = Nil		  End If		  ImageFile = Nil		  		  // Banner		  If Mode = "" Or Mode = "Banner" Then		    If Specials Then		      ImageFile = SeasonFolder.Child("specialsbanner.jpg")		    ElseIf All Then		      ImageFile = SeasonFolder.Child("seasonbanner-all.jpg")		    Else		      ImageFile = SeasonFolder.Child( "seasonbanner " + DisplaySeason + ".jpg" )		    End If		    If ImageFile IsA FolderItem Then SeasonBanner = Picture.Open( ImageFile )		  End If		  ImageFile = Nil		  		  // Landscape		  If Mode = "" Or Mode = "Thumb" Then		    If Specials Then		      ImageFile = SeasonFolder.Child("specials-landscape.jpg")		    ElseIf All Then		      ImageFile = SeasonFolder.Child("seasonall-landscape.jpg")		    Else		      ImageFile = SeasonFolder.Child( "season " + DisplaySeason + "-landscape.jpg" )		    End If		    If ImageFile IsA FolderItem Then SeasonThumb = Picture.Open( ImageFile )		  End If		  ImageFile = Nil		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub ReadJSON()		  If NOT Preferences.fAppSupport.Child("EpisodeGuides").Child( TVAttr.ID_TVDB + ".json" ).Exists Then Return		  		  Dim Content as String = ReadTextFile( Preferences.fAppSupport.Child("EpisodeGuides").Child( TVAttr.ID_TVDB + ".json" ) )		  		  // Set JSON item		  If Content <> "" Then		    Episodes = new JSONItem		    Episodes.Load( Content )		    If Episodes.HasName("episodes") Then Episodes = Episodes.Child("episodes")		  End If		  		  Dim HighestSeason as Integer = -1		  For i as Integer = 0 to Episodes.Count -1		    If Episodes.Child(i).HasName("SeasonNumber") And Episodes.Child(i).Value("SeasonNumber") > HighestSeason Then		      HighestSeason = Episodes.Child(i).Value("SeasonNumber")		    End If		  Next		  		  For i as Integer = HighestSeason DownTo -1		    Dim DisplaySeason as String = Str( i )		    'If DisplaySeason.Len = 1 Then DisplaySeason = "0" + DisplaySeason		    		    Dim EpisodeCount as Integer = 0		    For n as Integer = 0 to Episodes.Count -1		      If i > -1 And Episodes.Child(n).HasName("SeasonNumber") And Episodes.Child(n).Value("SeasonNumber") = i Then EpisodeCount = EpisodeCount + 1		      If i = -1 Then EpisodeCount = EpisodeCount + 1		    Next		    		    If i = 0 Then		      lstEpisodes.AddFolder Loc.kTVSpecials		    ElseIf i = -1 Then		      lstEpisodes.AddFolder Loc.kEpisodesAll 'Loc.kSeason + " All"		    Else		      lstEpisodes.AddFolder Loc.kSeason + " " + DisplaySeason		    End If		    lstEpisodes.CellTag( lstEpisodes.LastIndex, 0 ) = Str( i )		    lstEpisodes.RowTag( lstEpisodes.LastIndex ) = "Folder"		    lstEpisodes.Cell( lstEpisodes.LastIndex, 1 ) = Str( EpisodeCount )		  Next		  		  		  // Find Episodes		  EpisodeFiles = FindEpisodeFiles( TVAttr.FolderParent )		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SaveEpisodeInfo()		  		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub WatchedStatus(Watched as Boolean = False)		  If lstEpisodes.RowTag( lstEpisodes.ListIndex ) = "Folder" Then		    		    For i as Integer = Episodes.Count -1 DownTo 0		      Dim jItem as New JSONItem		      jItem = Episodes.Child(i)		      		      If jItem.Value("SeasonNumber") = lstEpisodes.CellTag( lstEpisodes.ListIndex, 0 ) Then		        jItem.Value("watched") = Watched		      End If		    Next		    		    lstEpisodes.Expanded( lstEpisodes.ListIndex ) = False		    lstEpisodes.Expanded( lstEpisodes.ListIndex ) = True		    Return		  End If		  		  		  		  lstEpisodes.Cell( lstEpisodes.ListIndex, 3 ) = Str( Watched )		  Episodes.Child( Val( lstEpisodes.Cell( lstEpisodes.ListIndex, 5 ) ) ).Value("watched") = Watched		  		  Dim MarkPreviousEpisodesUnwatched as Boolean = False		  For i as Integer = Episodes.Count -1 DownTo 0		    Dim jItem as New JSONItem		    jItem = Episodes.Child(i)		    		    If jItem.Value("watched") = False And _		      jItem.Value("SeasonNumber") > 0 And _		      jItem.Value("SeasonNumber") < ThisEpisode.Value("SeasonNumber") And _		      jItem.Value("EpisodeNumber") < ThisEpisode.Value("EpisodeNumber") Then		      		      MarkPreviousEpisodesUnwatched = MsgDlg( self, 1, "Mark previous episodes as watched", "Do you want to mark al previous episodes as watched?", "OK", "Cancel" ) = 1		      Exit		    End If		    		  Next		  		  		  If MarkPreviousEpisodesUnwatched Then		    		    For i as Integer = Episodes.Count -1 DownTo 0		      Dim jItem as New JSONItem		      jItem = Episodes.Child(i)		      		      If jItem.Value("SeasonNumber") > 0 And _		        ( jItem.Value("SeasonNumber")  < ThisEpisode.Value("SeasonNumber") OR _		        ( jItem.Value("SeasonNumber")  <= ThisEpisode.Value("SeasonNumber") And _		        jItem.Value("EpisodeNumber") <= ThisEpisode.Value("EpisodeNumber") ) ) Then		        		        jItem.Value("watched") = True		        'Exit		      End If		      		    Next		    		  End If		End Sub	#tag EndMethod	#tag Property, Flags = &h0		ActorIMG As Picture	#tag EndProperty	#tag Property, Flags = &h0		ActorLastSelection As Integer = -1	#tag EndProperty	#tag Property, Flags = &h0		EpisodeFiles() As Folderitem	#tag EndProperty	#tag Property, Flags = &h0		Episodes As JSONItem	#tag EndProperty	#tag Property, Flags = &h0		Modified As Boolean = False	#tag EndProperty	#tag Property, Flags = &h0		ppLastValue As Integer = 1	#tag EndProperty	#tag Property, Flags = &h0		SeasonBanner As Picture	#tag EndProperty	#tag Property, Flags = &h0		SeasonFanart As Picture	#tag EndProperty	#tag Property, Flags = &h0		SeasonPoster As Picture	#tag EndProperty	#tag Property, Flags = &h0		SeasonThumb As Picture	#tag EndProperty	#tag Property, Flags = &h0		ThisEpisode As JSONItem	#tag EndProperty	#tag Property, Flags = &h21		Private ThisEpisodeThumb As Picture = Nil	#tag EndProperty#tag EndWindowCode#tag Events lstEpisodes	#tag Event		Sub ExpandRow(row As Integer)		  Dim Season as Integer = Val( Trim( Me.CellTag( row, 0 ) ) )		  		  For i as Integer = Episodes.Count -1 DownTo 0		    Dim jItem as New JSONItem		    jItem = Episodes.Child(i)		    		    		    // Find the episode		    Dim EpisodeFile as FolderItem		    For n as Integer = 0 to EpisodeFiles.Ubound		      Dim OOxOO as String = RegExEpisode( EpisodeFiles(n) )		      Dim SeasonNr as Integer = Val( OOxOO.NthField( "x", 1 ) )		      Dim EpisodeNr as Integer = Val( OOxOO.NthField( "x", 2 ) )		      		      If SeasonNr = Season And jItem.Value("EpisodeNumber") = EpisodeNr Then		        EpisodeFile = EpisodeFiles(n)		        Exit		      End If		    Next		    Dim Path as String		    If EpisodeFile <> Nil Then Path = EpisodeFile.AbsolutePath		    		    Dim DisplayEpisode as String = jItem.Value("EpisodeNumber")		    If DisplayEpisode.Len = 1 Then DisplayEpisode = "0" + DisplayEpisode		    		    // Append rows		    If jItem.HasName("SeasonNumber") And jItem.Value("SeasonNumber") = Season Then		      		      // ## - Title, ID, Path, Watched, AirDate, Episodes.ChildNumber		      Me.AddRow DisplayEpisode + " - " + jItem.Value("EpisodeName"), jItem.Value("id"), Path, Str( jItem.Value("watched") ), jItem.Value("FirstAired"), Str( i )		      'Me.CellTag( Me.LastIndex, 4 ) = jItem // Append jItem as rowtag for quick data retrieval?		      		      'If Path <> "" Then Me.RowPicture( Me.LastIndex ) = miniconmovieII2x		      		    ElseIf jItem.HasName("SeasonNumber") And Season = -1 Then		      Me.AddRow jItem.Value("SeasonNumber") + "x" + DisplayEpisode + " - " + jItem.Value("EpisodeName"), jItem.Value("id"), Path, Str( jItem.Value("watched") ), jItem.Value("FirstAired"), Str( i )		      'Me.CellTag( Me.LastIndex, 4 ) = jItem // Append jItem as rowtag for quick data retrieval?		    End If		  Next		End Sub	#tag EndEvent	#tag Event		Sub Change()		  cvsSeasonArt.Mode = "SeasonPoster"		  		  ThrEpisodeThumb.Kill		  		  SeasonPoster = Nil		  SeasonFanart = Nil		  SeasonBanner = Nil		  SeasonThumb  = Nil		  		  'ppEpisodes.Visible = True		  popSeasonArt.Visible = True		  If Me.ListIndex > -1 And Me.RowTag( Me.ListIndex ) = "Folder" Then		    ppEpisodes.Value = 0		    cvsSeasonArt.Season = Me.CellTag( Me.ListIndex, 0 )		    GetSeasonInfo( Trim( Me.CellTag( Me.ListIndex, 0 ) ) )		  ElseIf Me.ListIndex > -1 And Me.Cell( Me.ListIndex, 1 ) <> "" Then		    ppEpisodes.Value = ppLastValue		    If Me.Cell( Me.ListIndex, 2 ) = "" Then		      GetEpisodeInfo( Nil )		    Else		      GetEpisodeInfo( GetFolderItem( Me.Cell( Me.ListIndex, 2 ) ) )		    End If		    		  Else		    ppEpisodes.Value = 0		    popSeasonArt.Visible = False		  End If		End Sub	#tag EndEvent	#tag Event		Function CellBackgroundPaint(g As Graphics, row As Integer, column As Integer) As Boolean		  		  		  		  If Me.Active And Me.Enabled And row < Me.ListCount And Me.Cell( row, 3 ) = "true" Then		    g.ForeColor = RGB( 257, 217, 217)		  ElseIf Me.Active And Me.Enabled Then		    g.ForeColor = RGB( 232, 232, 232 )		  Else		    g.ForeColor = RGB( 255, 255, 255 )		  End If		  		  If row < Me.ListCount And Me.RowTag( row ) = "Folder" Then		    g.DrawGradient( RGB(255, 255, 255), RGB(230, 230, 230), 0, 0, g.Width, g.Height )		  Else 'If row < Me.ListCount Then		    g.FillRect 0, 0, g.Width, g.Height		  End If		  		  		  If row < Me.ListCount Then		    g.ForeColor = RGB( 214, 214, 214 )		    g.DrawLine 0, g.Height -1, g.Width, g.Height -1		    		    g.ForeColor = RGB( 255, 255, 255 )		    g.DrawLine 0, 0, g.Width, 0		  End If		  		  // Selection Gradient		  If Row > -1 And Me.Selected( row ) And Me.Cell( row, 3 ) = "true" Then		    g.DrawGradient( RGB(206, 177, 202), RGB(173, 148, 180), 0, 0, g.Width, g.Height )		  ElseIf Row > -1 And Me.Selected( row ) Then		    g.DrawGradient( RGB(115, 176, 227), RGB( 71, 131, 208), 0, 0, g.Width, g.Height )		  End If		  		  		  // Folder shadow		  If Row < Me.ListCount - 1 And row > 0 And Me.RowTag( row - 1 ) = "Folder" And Me.Expanded( row - 1 ) And Me.RowTag( row ) <> "Folder" And NOT Me.Selected( row ) Then		    g.ForeColor = RGB( 150, 150, 150 )		    g.DrawLine 0, 0, g.Width, 0		    g.Transparency = 50		    g.DrawLine 0, 1, g.Width, 1		    g.Transparency = 80		    g.DrawLine 0, 2, g.Width, 2		    g.Transparency = 0		  End If		  		  // Show/Hide Button		  If Row < Me.ListCount And Me.RowTag( row ) = "Folder" Then		    g.TextFont = "Arial Narrow Bold"		    g.TextSize = 13		    		    Dim btnText as String = "Show"		    If Me.Expanded( row ) Then btnText = "Hide"		    btnText = btnText.Uppercase		    		    // Draw button bg		    g.ForeColor = RGB( 255, 255, 255 )		    g.FillRoundRect g.Width - 10 - 50, ( g.Height / 2 ) - 7,   50, 18,   10, 10		    		    g.ForeColor = RGB( 165, 165, 165 )		    g.FillRoundRect g.Width - 10 - 50, ( g.Height / 2 ) - 9,   50, 18,   10, 10		    		    g.ForeColor = RGB( 195, 195, 195 )		    g.FillRoundRect g.Width - 10 - 50, ( g.Height / 2 ) - 8,   50, 18,   10, 10		    		    // Draw button text		    g.ForeColor = RGB( 255, 255, 255 )		    g.DrawString btnText, ( ( g.Width - 10 - 50 ) + 25 ) - ( g.StringWidth( btnText ) / 2 ), g.TextSize + 1 + ( g.Height / 2 ) - ( g.StringHeight( btnText, Me.Width ) / 2 )		    		    g.ForeColor = RGB( 95, 95, 95)		    g.DrawString btnText, ( ( g.Width - 10 - 50 ) + 25 ) - ( g.StringWidth( btnText ) / 2 ), g.TextSize + ( g.Height / 2 ) - ( g.StringHeight( btnText, Me.Width ) / 2 )		    		  End If		  		  		  		  		  'If Row < Me.ListCount And Me.RowTag( row ) <> "Folder" Then		  '		  'If Me.Cell( row, 2 ) <> "" And GetFolderItem( Me.Cell( row, 2 ) ) IsA FolderItem Then		  'Dim Thumb as Picture = Picture.Open( GetFolderItem( Me.Cell( row, 2 ) ) )		  'Dim ScaledImg as Picture = ScaleImage( Thumb, g.Width, g.Height - 10 )		  '		  'If Thumb <> Nil Then		  'g.DrawPicture Thumb, g.Width - ScaledImg.Width - 5, ( g.Height / 2 ) - ( ScaledImg.Height / 2 ), ScaledImg.Width, ScaledImg.Height,   0, 0, Thumb.Width, Thumb.Height		  'End If		  'End If		  '		  'End If		  		  Return True		End Function	#tag EndEvent	#tag Event		Function CellClick(row as Integer, column as Integer, x as Integer, y as Integer) As Boolean		  		  Dim iLeft as Integer = 0		  If ( Me.ListCount - 1 ) * Me.DefaultRowHeight > Me.Height Then iLeft = 16		  		  If Me.RowTag( row ) = "Folder" And _		    y > ( Me.DefaultRowHeight / 2 ) - 8 And y < ( ( Me.DefaultRowHeight / 2 ) - 8 ) + 18 And _		    x > Me.Width - 10 - 50 - iLeft And x < Me.Width - 10 - iLeft Then		    		    Me.Expanded( row ) = NOT Me.Expanded( row )		    Return True		  End If		  		  Return False		End Function	#tag EndEvent	#tag Event		Sub CollapseRow(row As Integer)		  While Me.ListCount > row + 1 And Me.RowTag( row + 1 ) <> "Folder"		    Me.RemoveRow row + 1		  Wend		End Sub	#tag EndEvent	#tag Event		Function ConstructContextualMenu(base as MenuItem, x as Integer, y as Integer) As Boolean		  If Me.RowTag( Me.ListIndex ) = "Folder" Then		    		    base.Append New MenuItem( "Mark as Unwatched", "UnWatched" )		    base.Append New MenuItem( "Mark as Watched", "Watched" )		    		  Else		    		    If Me.Cell( Me.ListIndex, 3 ) = "True" Then		      base.Append New MenuItem( "Mark as Unwatched", "UnWatched" )		    Else		      base.Append New MenuItem( "Mark as Watched", "Watched")		    End If		    		    If Trim( Me.Cell( Me.ListIndex, 2 ) ) <> "" Then base.Append New MenuItem( Menu.FileShowInFinder, "Reveal" )		    		  End If		  		  Return True		End Function	#tag EndEvent	#tag Event		Function ContextualMenuAction(hitItem as MenuItem) As Boolean		  If hitItem = Nil Then Return False		  		  		  Select Case hitItem.Tag		    		  Case "Watched"		    WatchedStatus( True )		    		  Case "UnWatched"		    WatchedStatus( False )		    		  Case "Reveal"		    Dim f as FolderItem = GetFolderItem( Me.Cell( me.ListIndex, 2 ) )		    If f IsA FolderItem Then f.ShowInFinder else MsgBox "Test"		    		  End Select		  		  Return True		End Function	#tag EndEvent	#tag Event		Sub Open()		  'If DebugBuild Then me.ColumnWidths = "80%, 20%, 0"		End Sub	#tag EndEvent	#tag Event		Function CellTextPaint(g As Graphics, row As Integer, column As Integer, x as Integer, y as Integer) As Boolean		  'g.TextFont = "Adventure"		  If Me.Selected( row ) Then g.Bold = True		  		  If Row >= Me.ListCount Then Return False		  		  // Draw Title		  If column = 0 And Me.RowTag( row ) = "Folder" Then		    g.TextSize = 16		    If Me.Selected( row ) = False Then g.ForeColor = &cFFFFFF Else g.ForeColor = &c00000099		    g.DrawString Me.Cell( row, column ), 10, g.TextSize + ( g.Height / 2 ) - ( g.TextSize / 2 ) + 1		    		    If Me.Selected( row ) = False Then g.ForeColor = &c333333 Else g.ForeColor = &cFFFFFF		    g.DrawString Me.Cell( row, column ), 10, g.TextSize + ( g.Height / 2 ) - ( g.TextSize / 2 )		    'End If		    		    // Draw episode count		    'If Row < Me.ListCount And Me.RowTag( row ) = "Folder" Then		    g.TextFont = "Arial Narrow Bold"		    		    g.TextSize = 26		    Dim EpCountStrWidth as Integer = g.StringWidth( Me.Cell( row, 1 ) )		    g.TextSize = 11		    Dim EpisodesStrWidth as Integer = g.StringWidth( Loc.kEpisodes )		    		    g.TextSize = 26		    If Me.Selected( row ) Then g.ForeColor = &c00000099 Else g.ForeColor = &cFFFFFF		    g.DrawString Me.Cell( row, 1 ), g.Width - 80 - ( EpisodesStrWidth / 2 ) - ( EpCountStrWidth / 2 ), 3 + 1 + g.TextSize		    		    If Me.Selected( row ) Then g.ForeColor = &cFFFFFF Else g.ForeColor = &c333333		    g.DrawString Me.Cell( row, 1 ), g.Width - 80 - ( EpisodesStrWidth / 2 ) - ( EpCountStrWidth / 2 ), 3 + g.TextSize		    		    		    g.TextSize = 11		    If Me.Selected( row ) Then g.ForeColor = &c00000099 Else g.ForeColor = &cFFFFFF		    g.DrawString Loc.kEpisodes, g.Width - 80 - EpisodesStrWidth, g.Height - 6 + 1		    		    If Me.Selected( row ) Then g.ForeColor = &cFFFFFF Else g.ForeColor = &c333333		    g.DrawString Loc.kEpisodes, g.Width - 80 - EpisodesStrWidth, g.Height - 6		    		    		    If Me.Selected( row ) Then g.ForeColor = RGBa( 100, 100, 100, 40 ) Else g.ForeColor = RGBa( 0, 0, 0, 20 )		    g.DrawLine g.Width - 80 - EpisodesStrWidth - 10, 10, g.Width - 80 - EpisodesStrWidth - 10, g.Height - 10		    g.DrawLine g.Width - 20 - EpisodesStrWidth - 10, 10, g.Width - 20 - EpisodesStrWidth - 10, g.Height - 10		    		    // Anything that's not a 'folder'.		  ElseIf column = 0 Then 'And Len( Me.Cell( row, column ).NthField( " - ", 1 ) ) <= 2 Then		    g.Bold = True		    Dim TextLeft as Integer = 10		    g.Bold = False		    g.TextSize = 14		    Dim TitleTop as Integer = g.TextSize + ( g.Height / 4 ) - ( g.TextSize / 2 )		    Dim SubTop   as Integer = g.TextSize + ( g.Height / 4 ) + ( g.TextSize )		    		    // ##x## - Title		    If Me.Selected( row ) = False Then g.ForeColor = &cFFFFFF Else g.ForeColor = &c00000099		    g.DrawString Me.Cell( row, column ).ReplaceAll( " - ", ".   " ), TextLeft, TitleTop + 1		    		    If Me.Selected( row ) = False Then g.ForeColor = &c333333 Else g.ForeColor = &cFFFFFF		    g.DrawString Me.Cell( row, column ).ReplaceAll( " - ", ".   " ), TextLeft, TitleTop		    		    TextLeft = TextLeft + g.StringWidth( Me.Cell( row, column ).NthField( " - ", 1 ) + ".   " )		    		    g.TextSize = 12		    g.Bold = False		    // Airdate		    If Me.Selected( row ) = False Then g.ForeColor = &cFFFFFF Else g.ForeColor = &c00000099		    g.DrawString PrettyDate( Me.Cell( row, 4 ), True ), TextLeft, SubTop + 1		    		    If Me.Selected( row ) = False Then g.ForeColor = &c00000099 Else g.ForeColor = &cFFFFFF		    g.DrawString PrettyDate( Me.Cell( row, 4 ), True ), TextLeft, SubTop		    		  End If		  		  g.ForeColor = &c000000		  		  		  		  		  Return True		End Function	#tag EndEvent#tag EndEvents#tag Events CancelSave	#tag Event		Sub ActionCancel()		  Close		End Sub	#tag EndEvent	#tag Event		Sub ActionOK()		  Close		End Sub	#tag EndEvent#tag EndEvents#tag Events ppEpisodes	#tag Event		Sub Change()		  If Me.Value > 0 Then ppLastValue = Me.Value		End Sub	#tag EndEvent#tag EndEvents#tag Events cvsSeasonArt	#tag Event		Sub Open()		  Me.Height = ppEpisodes.Height		  Me.Width = ppEpisodes.Width		  		  Me.Mode = "SeasonPoster"		  Me.Reload( SeasonPoster )		End Sub	#tag EndEvent	#tag Event		Sub Activate()		  		  Dim Season as String = lstEpisodes.CellTag( lstEpisodes.ListIndex, 0 ) 'Trim( lstEpisodes.Cell( lstEpisodes.ListIndex, 0 ).ReplaceAll( Loc.kSeason, "" ) )		  		  Select Case Me.Mode		    		  Case "SeasonPoster"		    GetSeasonInfo( Season, "Poster" )		    Me.Reload( SeasonPoster )		  Case "SeasonFanart"		    GetSeasonInfo( Season, "Fanart" )		    Me.Reload( SeasonFanart )		  Case "SeasonBanner"		    GetSeasonInfo( Season, "Banner" )		    Me.Reload( SeasonBanner )		  Case "SeasonThumb"		    GetSeasonInfo( Season, "Thumb" )		    Me.Reload( SeasonThumb )		    		  End Select		End Sub	#tag EndEvent#tag EndEvents#tag Events popSeasonArt	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  If X > 0 And Y > 0 And _		    X < Me.Width And Y < Me.Width Then		    Return True		  End If		End Function	#tag EndEvent	#tag Event		Sub MouseUp(X As Integer, Y As Integer)		  		  Dim base        as New MenuItem		  Dim miSeperator as New MenuItem ( "-" )		  		  base.Append New MenuItem( Loc.kPoster )		  base.Append New MenuItem( Loc.kFanart )		  base.Append New MenuItem( Loc.kBanner )		  base.Append New MenuItem( Loc.kThumb  )		  		  base.Child( Loc.kPoster ).Checked = SeasonPoster <> Nil		  base.Child( Loc.kFanart ).Checked = SeasonFanart <> Nil		  base.Child( Loc.kBanner ).Checked = SeasonBanner <> Nil		  base.Child( Loc.kThumb ).Checked  = SeasonThumb  <> Nil		  		  base.Append New MenuItem( "-" )		  base.Append New MenuItem( Menu.ToolsExtraArtGetPoster )		  base.Append New MenuItem( Menu.ToolsExtraArtGetFanart )		  base.Append New MenuItem( Menu.ToolsExtraArtGetBanner )		  base.Append New MenuItem( Menu.ToolsExtraArtGetThumb  )		  		  		  Dim HitItem as MenuItem = base.PopUp		  If HitItem = Nil Then Return		  		  Dim Season as Integer = lstEpisodes.CellTag( lstEpisodes.ListIndex, 0 ) 'Val( Trim( lstEpisodes.Cell( lstEpisodes.ListIndex, 0 ).ReplaceAll( Loc.kSeason, "" ) ) )		  		  Select Case HitItem.Text		    		  Case Loc.kPoster		    cvsSeasonArt.Reload( SeasonPoster )		    cvsSeasonArt.Mode = "SeasonPoster"		  Case Loc.kFanart		    cvsSeasonArt.Reload( SeasonFanart )		    cvsSeasonArt.Mode = "SeasonFanart"		  Case Loc.kBanner		    cvsSeasonArt.Reload( SeasonBanner )		    cvsSeasonArt.Mode = "SeasonBanner"		  Case Loc.kThumb		    cvsSeasonArt.Reload( SeasonThumb )		    cvsSeasonArt.Mode = "SeasonThumb"		    		    		  Case Menu.ToolsExtraArtGetPoster		    CommonCore.GetImageSeason( "Poster", Season )		  Case Menu.ToolsExtraArtGetFanart		    CommonCore.GetImageSeason( "Fanart", Season )		  Case Menu.ToolsExtraArtGetBanner		    CommonCore.GetImageSeason( "Banner", Season )		  Case Menu.ToolsExtraArtGetThumb		    CommonCore.GetImageSeason( "Thumb", Season )		    		  End Select		End Sub	#tag EndEvent#tag EndEvents#tag Events cvsActorIMG	#tag Event		Sub Paint(g As Graphics, areas() As REALbasic.Rect)		  If ActorIMG <> Nil Then		    g.ScaleImage ActorIMG, Me.Width, Me.Height, 0, 0, False, True, True		    		    g.ForeColor = &c000000		    g.DrawRect 0, 0, ScaledDim( ActorIMG, Me.Width, Me.Height, True, True ), ScaledDim( ActorIMG, Me.Width, Me.Height, False, True )		  Else		    g.ForeColor = &cFFFFFF		    g.FillRect 0, 0, Me.Width, Me.Height		    		    Dim TextTop as Integer = ( Me.Height / 2 ) - ( g.TextSize * 2 )		    Dim part1, part2 as String		    part1 = Trim( Loc.mNoImageAvailable.Left( Loc.mNoImageAvailable.InStr( 0, chr(13) ) ) )		    part2 = Trim( Loc.mNoImageAvailable.ReplaceAll( part1, "" ) )		    		    g.ForeColor = &cAAAAAA		    'g.DrawString Loc.mNoImageAvailable, ( Me.Width / 2 ) - ( g.StringWidth( Loc.mNoImageAvailable ) / 4 ), ( Me.Height / 2 ) - ( g.TextSize * 2 ), Me.Width, False		    		    g.DrawString part1, ( Me.Width / 2 ) - ( g.StringWidth( part1 ) / 2 ), TextTop, Me.Width, False		    TextTop = TextTop + g.TextSize + 2		    g.DrawString part2, ( Me.Width / 2 ) - ( g.StringWidth( part2 ) / 2 ), TextTop, Me.Width, False		    		    g.ForeColor = &c000000		    g.DrawRect 0, 0, Me.Width, Me.Height		  End If		End Sub	#tag EndEvent#tag EndEvents#tag Events scktActor	#tag Event		Sub ReceiveProgress(bytesReceived as integer, totalBytes as integer, newData as string)		  pgActor.Visible = ( totalBytes < bytesReceived )		  		  pgActor.Maximum = totalBytes		  pgActor.Value   = bytesReceived		  		  pgActor.Visible = ( totalBytes >= bytesReceived )		End Sub	#tag EndEvent	#tag Event		Sub Error(code as integer)		  SocketError( code, Me )		  		Exception err as NilObjectException		  Me.Close		End Sub	#tag EndEvent#tag EndEvents#tag Events thrActor	#tag Event		Sub Run()		  Dim FullURL  as String = Trim( lstActors.Cell( lstActors.ListIndex, 2 ) )		  Dim FullName as String = Trim( lstActors.Cell( lstActors.ListIndex, 0 ) ).ReplaceAll( " ", "_" ).Lowercase		  Dim ActorIMGFolder as FolderItem = Preferences.fAppSupport.Child( "Actors" )		  If NOT ActorIMGFolder.Exists Then ActorIMGFolder.CreateAsFolder		  		  Dim Name as String = Trim( lstActors.Cell( lstActors.ListIndex, 0 ) )		  Dim Name_Parts() as String = Name.Split(" ")		  Dim LastName  as String = Name_Parts( Name_Parts.Ubound )		  Dim FirstName as String = Trim( Name.ReplaceAll( LastName, "" ) ).ReplaceAll( " ", "_" ).Lowercase		  		  If lstActors.ListIndex > -1 And FullURL.Left(4) = "http" Then		    ActorIMG = URL2Picture( FullURL, LastName.Lowercase + ",_" + FirstName, "jpg", ActorIMGFolder )		    		  ElseIf lstActors.ListIndex > -1 Then		    Dim f as FolderItem		    If FullURL.Left(1) = "/" Then		      f = GetFolderItem( FullURL, FolderItem.PathTypeShell )		    Else		      f = GetFolderItem( MovieAttr.FolderParent.ShellPath + "/" + FullURL, FolderItem.PathTypeShell )		    End If		    If f <> Nil Then ActorIMG = Picture.Open( f )		    		  End If		  		  pgActor.Visible = False		  cvsActorIMG.Reload		End Sub	#tag EndEvent#tag EndEvents#tag Events lstActors	#tag Event		Sub Open()		  If DebugBuild Then Me.ColumnWidths = "150, 200, *, 50"		  scktActor.Yield = True		End Sub	#tag EndEvent	#tag Event		Sub DoubleClick()		  Dim row, column as Integer		  row =    Me.RowFromXY(    System.MouseX - Me.Left - Self.Left, System.MouseY - Me.Top - Self.Top )		  column = Me.ColumnFromXY( System.MouseX - Me.Left - Self.Left, System.MouseY - Me.Top - Self.Top )		  Me.EditCell( row, column )		End Sub	#tag EndEvent	#tag Event		Sub Change()		  Dim f as FolderItem = Preferences.fAppSupport.Child("Actors").Child( Me.Cell( Me.ListIndex, 0 ).Lowercase.ReplaceAll( " ", "_" ) + ".jpg" )		  arActor.RemoveEnabled = ( Me.ListIndex > -1 )		  pgActor.Visible = False		  		  If Me.ListIndex = ActorLastSelection Then Return		  thrActor.Kill		  scktActor.Close		  ActorIMG = Nil		  		  If Me.Cell( Me.ListIndex, 0 ) <> "" And f <> Nil and F.Exists Then ActorIMG = Picture.Open( f )		  cvsActorIMG.Reload		  		  		  If ActorIMG = Nil And Me.Cell( Me.ListIndex, 2 ) <> "" And System.Network.IsConnected Then		    pgActor.Visible = True		    thrActor.Run		  End If		  		  ActorLastSelection = Me.ListIndex		End Sub	#tag EndEvent#tag EndEvents#tag Events udSeason	#tag Event		Sub Up()		  edtSeasonNr.Text = Str( Val( edtSeasonNr.Text ) + 1 )		End Sub	#tag EndEvent	#tag Event		Sub Down()		  edtSeasonNr.Text = Str( Val( edtSeasonNr.Text ) - 1 )		End Sub	#tag EndEvent#tag EndEvents#tag Events udRating	#tag Event		Sub Up()		  If Val( edtRating.Text ) < 10 Then edtRating.Text = Str( Val( edtRating.Text ) + .1 )		  If edtRating.Text.Len = 1 Then edtRating.Text = edtRating.Text + ".0"		End Sub	#tag EndEvent	#tag Event		Sub Down()		  If Val( edtRating.Text ) > 0 Then edtRating.Text = Str( Val( edtRating.Text ) - .1 )		  If edtRating.Text.Len = 1 Then edtRating.Text = edtRating.Text + ".0"		End Sub	#tag EndEvent#tag EndEvents#tag Events edtRating	#tag Event		Sub TextChange()		  Modified = ( Prefs.textStringForKey("RenameStringTVShows").InStr(0, "$#") > 0 And Str( TVAttr.Rating ) <> Me.Text )		End Sub	#tag EndEvent#tag EndEvents#tag Events udEpisode	#tag Event		Sub Up()		  edtEpisodeNr.Text = Str( Val( edtEpisodeNr.Text ) + 1 )		End Sub	#tag EndEvent	#tag Event		Sub Down()		  edtEpisodeNr.Text = Str( Val( edtEpisodeNr.Text ) - 1 )		End Sub	#tag EndEvent#tag EndEvents#tag Events udDate	#tag Event		Sub Up()		  Dim DatePremiered() as String = edtPremiere.Text.Split("-")		  		  If Val( DatePremiered( 2 ) ) < 31 Then		    DatePremiered( 2 ) = Str( Val( DatePremiered( 2 ) ) + 1 )		    		  ElseIf Val( DatePremiered( 2 ) ) >= 31 And Val( DatePremiered( 1 ) ) < 12 Then		    DatePremiered( 2 ) = "1"		    DatePremiered( 1 ) = Str( Val( DatePremiered( 1 ) ) + 1 )		    		  ElseIf Val( DatePremiered( 2 ) ) >= 31 And Val( DatePremiered( 1 ) ) >= 12 Then		    DatePremiered( 2 ) = "1"		    DatePremiered( 1 ) = "1"		    DatePremiered( 0 ) = Str( Val( DatePremiered( 0 ) ) + 1 )		    		  ElseIf DatePremiered( 0 ).Val >= 9999 Then		    DatePremiered( 2 ) = "31"		    DatePremiered( 1 ) = "12"		    DatePremiered( 0 ) = "9999"		  End If		  		  If DatePremiered(0).Len = 1 Then DatePremiered(0) = "000" + DatePremiered(0)		  If DatePremiered(0).Len = 2 Then DatePremiered(0) = "00"  + DatePremiered(0)		  If DatePremiered(0).Len = 3 Then DatePremiered(0) = "0"   + DatePremiered(0)		  		  If DatePremiered(1).Len = 1 Then DatePremiered(1) = "0" + DatePremiered(1)		  If DatePremiered(2).Len = 1 Then DatePremiered(2) = "0" + DatePremiered(2)		  		  edtPremiere.Text = DatePremiered( 0 ) + "-" + DatePremiered( 1 ) + "-" + DatePremiered( 2 )		End Sub	#tag EndEvent	#tag Event		Sub Down()		  Dim DatePremiered() as String = edtPremiere.Text.Split("-")		  		  If Val( DatePremiered( 2 ) ) > 1 Then		    DatePremiered( 2 ) = Str( Val( DatePremiered( 2 ) ) - 1 )		    		  ElseIf Val( DatePremiered( 2 ) ) <= 1 And Val( DatePremiered( 1 ) ) > 1 Then		    DatePremiered( 2 ) = "31"		    DatePremiered( 1 ) = Str( Val( DatePremiered( 1 ) ) - 1 )		    		  ElseIf Val( DatePremiered( 2 ) ) <= 1 And Val( DatePremiered( 1 ) ) <= 1 And Val( DatePremiered( 0 ) ) > 0 Then		    DatePremiered( 2 ) = "31"		    DatePremiered( 1 ) = "12"		    DatePremiered( 0 ) = Str( Val( DatePremiered( 0 ) ) - 1 )		    		  ElseIf Val( DatePremiered( 2 ) ) <= 1 And Val( DatePremiered( 1 ) ) <= 1 And Val( DatePremiered(0) ) <= 1 Then		    DatePremiered( 2 ) = "0"		    DatePremiered( 1 ) = "0"		    DatePremiered( 0 ) = "0000"		  End If		  		  If DatePremiered(0).Len = 1 Then DatePremiered(0) = "000" + DatePremiered(0)		  If DatePremiered(0).Len = 2 Then DatePremiered(0) = "00"  + DatePremiered(0)		  If DatePremiered(0).Len = 3 Then DatePremiered(0) = "0"   + DatePremiered(0)		  		  If DatePremiered(1).Len = 1 Then DatePremiered(1) = "0" + DatePremiered(1)		  If DatePremiered(2).Len = 1 Then DatePremiered(2) = "0" + DatePremiered(2)		  		  edtPremiere.Text = DatePremiered( 0 ) + "-" + DatePremiered( 1 ) + "-" + DatePremiered( 2 )		End Sub	#tag EndEvent#tag EndEvents#tag Events cvsEpisodeThumb	#tag Event		Sub Paint(g As Graphics, areas() As REALbasic.Rect)		  If ThisEpisodeThumb = Nil Then Return		  		  Dim ThumbWidth as Integer = ScaledDim( ThisEpisodeThumb, g.Width, g.Height, True, True )		  		  g.ScaleImage( ThisEpisodeThumb, g.Width, g.Height - 2,   ( g.Width / 2 ) - ( ThumbWidth / 2 ), 1, False, True, True )		  g.drawrect( ( g.Width / 2 ) - ( ThumbWidth / 2 ) - 1, 0, ThumbWidth - 2, g.Height )		End Sub	#tag EndEvent#tag EndEvents#tag Events ThrEpisodeThumb	#tag Event		Sub Run()		  If lstEpisodes.RowTag( lstEpisodes.ListIndex ) = "Folder" Then Return		  		  // Load from celltag		  'If lstEpisodes.CellTag( lstEpisodes.ListIndex, 5 ) <> Nil Then		  'SeasonThumb = lstEpisodes.CellTag( lstEpisodes.ListIndex, 5 )		  'cvsEpisodeThumb.Reload		  'Return		  'End If		  		  // Load from file		  Dim f as FolderItem		  If lstEpisodes.Cell( lstEpisodes.ListIndex, 2 ) <> "" Then		    f = GetFolderItem( lstEpisodes.Cell( lstEpisodes.ListIndex, 2 ) )		  Else		    f = Nil		  End If		  		  		  If f <> Nil And f.Exists Then		    f = f.Parent.Child( f.NameWithoutExtension + ".jpg" )		    If f IsA FolderItem Then		      ThisEpisodeThumb = Picture.Open( f.Parent.Child( f.NameWithoutExtension + ".jpg") )		      cvsEpisodeThumb.Reload		      Return		    End If		  End If		  		  // Load from internet		  If ThisEpisode.HasName("filename") And ThisEpisode.Value("filename") <> "" Then		    Dim sckt as New HTTPSocket		    		    ThisEpisodeThumb = Picture.FromData( sckt.Get( ThisEpisode.Value("filename"), Prefs.integerForKey("TimeOut") ) )		    'lstEpisodes.CellTag( lstEpisodes.ListIndex, 5 ) = ThisEpisodeThumb		    cvsEpisodeThumb.Reload		    Return		  End If		  		  ThisEpisodeThumb = Nil		  cvsEpisodeThumb.Reload		End Sub	#tag EndEvent#tag EndEvents#tag Events udAfterSeason	#tag Event		Sub Up()		  edtAfterSeason.Text = Str( Val( edtAfterSeason.Text ) + 1 )		End Sub	#tag EndEvent	#tag Event		Sub Down()		  edtAfterSeason.Text = Str( Val( edtAfterSeason.Text ) - 1 )		End Sub	#tag EndEvent#tag EndEvents#tag Events udBeforeEpisode	#tag Event		Sub Up()		  edtBeforeEpisode.Text = Str( Val( edtBeforeEpisode.Text ) + 1 )		End Sub	#tag EndEvent	#tag Event		Sub Down()		  edtBeforeEpisode.Text = Str( Val( edtBeforeEpisode.Text ) - 1 )		End Sub	#tag EndEvent#tag EndEvents#tag Events udBeforeSeason	#tag Event		Sub Up()		  edtBeforeSeason.Text = Str( Val( edtBeforeSeason.Text ) + 1 )		End Sub	#tag EndEvent	#tag Event		Sub Down()		  edtBeforeSeason.Text = Str( Val( edtBeforeSeason.Text ) - 1 )		End Sub	#tag EndEvent#tag EndEvents#tag Events arActor	#tag Event		Sub ActionAdd()		  lstActors.AddRow edtActorName.Text, edtActorRole.Text, edtActorThumbURL.Text		End Sub	#tag EndEvent	#tag Event		Sub ActionRemove()		  If lstActors.ListIndex = -1 Then Return		  lstActors.RemoveRow lstActors.ListIndex		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton1	#tag Event		Sub Action()		  If ppEpisodes.Value = 1 Then ppEpisodes.Value = 2 Else ppEpisodes.Value = 1		End Sub	#tag EndEvent#tag EndEvents#tag Events chkWatched	#tag Event		Sub Action()		  'WatchedStatus( Me.Value )		End Sub	#tag EndEvent#tag EndEvents