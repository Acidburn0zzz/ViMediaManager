#tag WindowBegin Window dlgProgress   BackColor       =   &hFFFFFF   Backdrop        =   ""   CloseButton     =   False   Composite       =   False   Frame           =   8   FullScreen      =   False   HasBackColor    =   False   Height          =   130   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   False   MinWidth        =   64   Placement       =   3   Resizeable      =   False   Title           =   "#localizable.kProgress"   Visible         =   True   Width           =   486   Begin cvsLogo Logo      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   64      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   14      UseFocusRing    =   True      Visible         =   True      Width           =   64   End   Begin Label lblAction      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   16      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   96      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   1      TabPanelIndex   =   0      Text            =   "Action:"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   14      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   370   End   Begin Label lblDescription      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   16      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   96      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   2      TabPanelIndex   =   0      Text            =   "Description"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   34      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   370   End   Begin ProgressBar pgBar      AutoDeactivate  =   True      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   96      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Maximum         =   100      Scope           =   0      TabPanelIndex   =   0      Top             =   58      Value           =   0      Visible         =   True      Width           =   370   End   Begin PushButton btnCancel      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   True      Caption         =   "#localizable.dlgcancel"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   386      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   90      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin Thread thrProgress      Height          =   32      Index           =   -2147483648      InitialParent   =   ""      Left            =   434      LockedInPosition=   False      Priority        =   5      Scope           =   0      StackSize       =   0      TabPanelIndex   =   0      Top             =   139      Width           =   32   End   Begin Label lblDebug      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   4      TabPanelIndex   =   0      Text            =   ""      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   10      TextUnit        =   0      Top             =   90      Transparent     =   False      Underline       =   ""      Visible         =   False      Width           =   354   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Close()		  ThreadMode = ""		  MovieID = ""		  MovieName = ""		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Add(Action as String = "", Description as String = "", addValue as Integer = 1, MaxValue as Integer = - 1)		  If Action <> "" then lblAction.Text = Action		  If Description <> "" then lblDescription.Text = Description		  If MaxValue > -1 then pgBar.Maximum = MaxValue		  pgBar.Value = pgBar.Value + addValue		  If pgBar.Value >= pgBar.Maximum then pgBar.Maximum = 0		  self.Refresh		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Debug(debugtext as String)		  lblDebug.Text = debugtext		  Self.Refresh		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Reset()		  pgBar.Value = 0		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub ScrapeMovie(tmpMovieID as String, tmpMovieName as String)		  MovieID = tmpMovieID		  MovieName = tmpMovieName		  		  Start( Localizable.kProcessing + ":", "TMDB: " + tmpMovieName, 10, "ScrapeMovie" )		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Start(Action as String, Description as String, Max as Integer, RunThread as String)		  Self.Show		  		  lblAction.Text = Action		  lblDescription.Text = Description		  pgBar.Maximum = Max		  pgBar.Value = 0		  self.Refresh		  		  		  ThreadMode = RunThread		  thrProgress.Run		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Stop(Kill as Boolean = True)		  If Kill then thrProgress.Kill		  pgBar.Value = pgBar.Maximum		  self.Refresh		  Close		  		  		  // Cleanup actions.		  Select Case ThreadMode		    		  Case "AllMovies"		    Scrape.MassSearch = False		    wndMain.lstMovies.CreateList		    		  End Select		  		  ThreadMode = ""		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Update(Action as String = "", Description as String = "", Value as Integer)		  If Action <> "" then lblAction.Text = Action		  If Description <> "" then lblDescription.Text = Description		  If  Value >= pgBar.Maximum then pgBar.Maximum = 0 Else pgBar.Value = Value		  Self.Refresh		End Sub	#tag EndMethod	#tag Property, Flags = &h1		Protected MovieID As String	#tag EndProperty	#tag Property, Flags = &h1		Protected MovieName As String	#tag EndProperty	#tag Property, Flags = &h0		ThreadMode As String	#tag EndProperty#tag EndWindowCode#tag Events btnCancel	#tag Event		Sub Action()		  Stop		End Sub	#tag EndEvent#tag EndEvents#tag Events thrProgress	#tag Event		Sub Run()		  Select Case ThreadMode		    		  Case "AllMovies"		    Scrape.AllMovies		    		  Case "SelectedMovie"		    Scrape.TMDBApiSearch( lblDescription.Text )		    		  Case "ScrapeMovie"		    Scrape.TMDBApi( MovieID )		    		  Case "GetMovieFanart"		    If MovieAttr.ID_TMDB <> "" then		      Scrape.TMDBApiArt( MovieAttr.ID_TMDB, "Fanart" )		    ElseIf MovieAttr.ID_IMDB <> "" then		      Scrape.TMDBApiArt( MovieAttr.ID_IMDB, "Fanart" )		    Else		      MsgBox Scrape.kNoImagesFound.ReplaceAll( "%s", Localizable.kFanart )		    End If		    		  Case "GetMoviePoster"		    If MovieAttr.ID_TMDB <> "" then		      Scrape.TMDBApiArt( MovieAttr.ID_TMDB, "Poster" )		    ElseIf MovieAttr.ID_IMDB <> "" then		      Scrape.TMDBApiArt( MovieAttr.ID_IMDB, "Poster" )		    Else		      MsgBox Scrape.kNoImagesFound.ReplaceAll( "%s", Localizable.kPoster )		    End If		    		  Case "GetMovieExtrathumbs"		    If MovieAttr.ID_TMDB <> "" then		      Scrape.TMDBApiArt( MovieAttr.ID_TMDB, "ExtraThumbs" )		    ElseIf MovieAttr.ID_IMDB <> "" then		      Scrape.TMDBApiArt( MovieAttr.ID_IMDB, "ExtraThumbs" )		    Else		      // Movie has not been indexed yet!		    End If		    		    		  End Select		  		  Close		End Sub	#tag EndEvent#tag EndEvents#tag Events lblDebug	#tag Event		Sub Open()		  If DebugBuild then me.Visible = True		End Sub	#tag EndEvent#tag EndEvents