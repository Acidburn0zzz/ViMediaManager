#tag WindowBegin Window wndSearchMovie   BackColor       =   &hFFFFFF   Backdrop        =   1278171476   CloseButton     =   False   Composite       =   False   Frame           =   8   FullScreen      =   False   HasBackColor    =   False   Height          =   455   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   400   MinimizeButton  =   False   MinWidth        =   500   Placement       =   0   Resizeable      =   False   Title           =   "Search Movie Database"   Visible         =   True   Width           =   760   Begin ListboxPRO lstMovies      AlternatingRows =   True      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   ""      Border          =   True      ColumnCount     =   6      ColumnsResizable=   ""      ColumnWidths    =   "100%, *"      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   22      Enabled         =   True      EnableDrag      =   ""      EnableDragReorder=   ""      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   ""      HeadingIndex    =   -1      Height          =   370      HelpTag         =   ""      Hierarchical    =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   True      RequiresSelection=   True      Scope           =   0      ScrollbarHorizontal=   ""      ScrollBarVertical=   True      SelectionGradient=   True      SelectionType   =   0      SourceList      =   False      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   1      TextFont        =   "System"      TextSize        =   12      TextUnit        =   0      Top             =   33      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   300      _ScrollWidth    =   -1   End   Begin SuperTextfield edtSearch      AcceptTabs      =   ""      Alignment       =   0      AutoComplete    =   ""      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   &hFFFFFF      Bold            =   ""      Border          =   False      CueText         =   "Movie title (year) or IMDb ID"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   16      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   30      LimitText       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Mask            =   ""      Password        =   ""      ReadOnly        =   ""      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   9      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   251   End   Begin Label lblTitle      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   312      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   3      TabPanelIndex   =   0      Text            =   "Title"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   14      TextUnit        =   0      Top             =   14      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   428   End   Begin Canvas cvsPoster      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   168      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   312      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      Top             =   38      UseFocusRing    =   True      Visible         =   True      Width           =   114   End   Begin Canvas cvsFanart      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   168      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   438      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      Top             =   38      UseFocusRing    =   True      Visible         =   True      Width           =   302   End   Begin SuperTextArea edtPlot      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   True      BackColor       =   &hFFFFFF      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   185      HelpTag         =   ""      HideSelection   =   True      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   299      LimitText       =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Mask            =   ""      Multiline       =   True      ReadOnly        =   True      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   True      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   218      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   461   End   Begin ccCancelSave CancelSave      AcceptFocus     =   ""      AcceptTabs      =   True      AutoDeactivate  =   True      BackColor       =   &hFFFFFF      Backdrop        =   ""      Enabled         =   True      EraseBackground =   True      HasBackColor    =   False      Height          =   22      HelpTag         =   ""      InitialParent   =   ""      Left            =   568      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      Top             =   415      UseFocusRing    =   ""      Visible         =   True      Width           =   172   End   Begin Label lblDBID      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   8      TabPanelIndex   =   0      Text            =   "#kUseIMDBID"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   415      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   508   End   Begin ProgressWheel pgWheel      AutoDeactivate  =   True      Enabled         =   True      Height          =   16      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   540      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   9      TabPanelIndex   =   0      TabStop         =   True      Top             =   417      Visible         =   False      Width           =   16   End   Begin HTTPSocket scktArt      Address         =   ""      Height          =   32      Index           =   -2147483648      Left            =   0      LockedInPosition=   False      Port            =   0      Scope           =   0      TabPanelIndex   =   0      Top             =   474      Width           =   32      yield           =   0   End   Begin Thread ThrArt      Height          =   32      Index           =   -2147483648      Left            =   44      LockedInPosition=   False      Priority        =   5      Scope           =   0      StackSize       =   0      TabPanelIndex   =   0      Top             =   474      Width           =   32   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Close()		  'tmrArt.Mode = 0		  ThrArt.Kill		  scktArt.Close		  Scrape.ManualSearch = False		End Sub	#tag EndEvent	#tag Property, Flags = &h1		Protected tmpFanart As Picture	#tag EndProperty	#tag Property, Flags = &h1		Protected tmpPoster As Picture	#tag EndProperty	#tag Constant, Name = kSearchFieldHelpText, Type = String, Dynamic = True, Default = \"Movie title (year) or IMDb ID", Scope = Protected		#Tag Instance, Platform = Any, Language = en, Definition  = \"Movie title (year) or IMDb ID"		#Tag Instance, Platform = Any, Language = nl, Definition  = \"Film titel (jaar) of IMDb ID"	#tag EndConstant	#tag Constant, Name = kUseIMDBID, Type = String, Dynamic = True, Default = \"Instead of key words\x2C you can also use an IMDb ID to search for a movie.", Scope = Protected		#Tag Instance, Platform = Any, Language = en, Definition  = \"Instead of key words\x2C you can also use an IMDb ID to search for a movie."		#Tag Instance, Platform = Any, Language = nl, Definition  = \"In plaats van sleutelwoorden\x2C kunt u ook een IMDb ID gebruiken om te zoeken naar een film."	#tag EndConstant#tag EndWindowCode#tag Events lstMovies	#tag Event		Sub Change()		  scktArt.Yield = True		  		  CancelSave.btnRight.Enabled = Me.ListIndex > -1		  'tmrArt.Mode = 0		  ThrArt.Kill		  scktArt.Close		  pgWheel.Visible = False		  		  If Me.ListIndex > -1 then		    lblTitle.Text = Me.Cell( Me.ListIndex, 0 )		    edtPlot.Text  = Me.Cell( Me.ListIndex, 4 )		  Else		    lblTitle.Text = ""		    edtPlot.Text  = ""		  End If		  		  tmpPoster = Nil		  tmpFanart = Nil		  		  cvsFanart.Invalidate( False )		  cvsPoster.Invalidate( False )		  		  If Me.Cell( Me.ListIndex, 5 ) <> "" or Me.Cell( Me.ListIndex, 6 ) <> "" then		    pgWheel.Visible = True		    'tmrArt.Mode = 1		    ThrArt.Run		  End If		  		  // cvsPoster.Invalidate( False )		  // cvsFanart.Invalidate( False )		End Sub	#tag EndEvent	#tag Event		Sub DoubleClick()		  If Me.ListIndex > -1 then CancelSave.btnRight.Push		End Sub	#tag EndEvent	#tag Event		Function KeyDown(Key As String) As Boolean		  If Keyboard.AsyncKeyDown( &h4C ) or Keyboard.AsyncKeyDown( &h24 ) then // Pressed Enter		    If Me.ListIndex > -1 then CancelSave.btnRight.Push		  ElseIf Keyboard.AsyncKeyDown( &h35 ) then // Pressed Escape		    CancelSave.btnLeft.Push		  End If		End Function	#tag EndEvent#tag EndEvents#tag Events edtSearch	#tag Event		Sub Open()		  Me.Border = False		End Sub	#tag EndEvent	#tag Event		Function KeyDown(Key as String) As Boolean		  // Press Enter key		  If Keyboard.AsyncKeyDown( &h4C ) or Keyboard.AsyncKeyDown( &h24 ) then		    		    If edtSearch.Active and edtSearch.Text <> "" then		      Scrape.ManualSearch = True		      pgWheel.Visible = True		      		      If edtSearch.Text.Left(2) = "tt" then		        Self.Close		        'Scrape.TMDBApi( edtSearch.Text )		        dlgProgress.ScrapeMovie( edtSearch.Text, lstMovies.Cell( lstMovies.ListIndex, 0 ) )		      Else		        Scrape.TMDBApiSearch( edtSearch.Text )		        'dlgProgress.MovieName = edtSearch.Text		        'dlgProgress.Start( Localizable.kSearching + ":", edtSearch.Text, 3, "SearchMovie" )		        dlgProgress.Stop		        pgWheel.Visible = False		      End If		      		    Else		      CancelSave.btnRight.Push		      		    End If		    		    // Pressed Escape key		  ElseIf Keyboard.AsyncKeyDown( &h35 ) then		    CancelSave.btnLeft.Push		    		  End If		End Function	#tag EndEvent#tag EndEvents#tag Events cvsPoster	#tag Event		Sub Paint(g As Graphics)		  If tmpPoster = Nil then		    g.ForeColor = &cFFFFFF		    g.FillRect 0, 0, Me.Width, Me.Height		  Else		    g.DrawPicture( tmpPoster, 0, 0, Me.Width, Me.Height, 0, 0, tmpPoster.Width, tmpPoster.Height )		  End If		  		  g.ForeColor = &c000000		  g.DrawRect 0, 0, Me.Width, Me.Height		End Sub	#tag EndEvent#tag EndEvents#tag Events cvsFanart	#tag Event		Sub Paint(g As Graphics)		  If tmpFanart = Nil then		    g.ForeColor = &cFFFFFF		    g.FillRect 0, 0, Me.Width, Me.Height		  Else		    g.DrawPicture( tmpFanart, 0, 0, Me.Width, Me.Height, 0, 0, tmpFanart.Width, tmpFanart.Height )		  End If		  		  g.ForeColor = &c000000		  g.DrawRect 0, 0, Me.Width, Me.Height		End Sub	#tag EndEvent#tag EndEvents#tag Events CancelSave	#tag Event		Sub ActionCancel()		  Close		  dlgProgress.Stop		End Sub	#tag EndEvent	#tag Event		Sub ActionOK()		  'tmrArt.Mode = 0		  ThrArt.Kill		  scktArt.Close		  Scrape.ManualSearch = False		  		  dlgProgress.ScrapeMovie( lstMovies.Cell( lstMovies.ListIndex, 1 ), lstMovies.Cell( lstMovies.ListIndex, 0 ) )		  		  Close		  //Scrape.TMDBApi( lstMovies.Cell( lstMovies.ListIndex, 1 ) )		  //wndMain.UpdateRow		End Sub	#tag EndEvent	#tag Event		Sub Open()		  Me.btnRight.Enabled = lstMovies.ListIndex > -1		  Me.btnRight.Default = False		End Sub	#tag EndEvent#tag EndEvents#tag Events ThrArt	#tag Event		Sub Run()		  tmpPoster = Picture.FromData( scktArt.Get( lstMovies.Cell( lstMovies.ListIndex, 5 ), 0 ) )		  scktArt.Close		  cvsPoster.Invalidate( False )		  		  tmpFanart = Picture.FromData( scktArt.Get( lstMovies.Cell( lstMovies.ListIndex, 6 ), 0 ) )		  scktArt.Close		  cvsFanart.Invalidate( False )		  		  pgWheel.Visible = False		End Sub	#tag EndEvent#tag EndEvents