#tag WindowBegin Window wndSetManager   BackColor       =   &hFFFFFF   Backdrop        =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   400   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   3   Resizeable      =   True   Title           =   "#kSetManager"   Visible         =   True   Width           =   600   Begin AddRemoveButtons arSet      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Top             =   358      UseFocusRing    =   True      Visible         =   True      Width           =   45   End   Begin Listbox lstSets      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   ""      Border          =   True      ColumnCount     =   2      ColumnsResizable=   ""      ColumnWidths    =   "100%, 0"      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   22      Enabled         =   True      EnableDrag      =   False      EnableDragReorder=   True      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   ""      HeadingIndex    =   -1      Height          =   332      HelpTag         =   ""      Hierarchical    =   True      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      RequiresSelection=   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollBarVertical=   True      SelectionType   =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   14      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   250      _ScrollWidth    =   -1   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  Dim icns as new IconMBS( "fold", "MACS" )		  FolderIcon = icns.IconFamily.Small32BitData		  FolderIcon.Mask = icns.IconFamily.Small8BitMask		  		End Sub	#tag EndEvent	#tag MenuHandler		Function FileCloseWindow() As Boolean Handles FileCloseWindow.Action			Close			Return True					End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Sub init()		  Dim Sets() as String		  // Get all sets		  For i as integer = 0 to wndMain.lstMovies.ListCount - 1		    If wndMain.lstMovies.Cell( i, 9 ) <> "" then Sets.Append wndMain.lstMovies.Cell( i, 9 )		  Next		  		  // Sort sets and remove duplicates		  Sets.Sort		  For i as Integer = Sets.Ubound - 1 DownTo 0		    If Sets(i + 1) = Sets(i) Then Sets.Remove i + 1		  Next		  		  // Add sets to lstSets with a folder picture		  For i as Integer = 0 to Sets.Ubound		    lstSets.AddFolder Sets(i)		    lstSets.RowPicture(i) = FolderIcon		    lstSets.CellType(i, 0) = lstSets.TypeEditable		  Next		  		  // Expand all sets		  For i as Integer = 0 to lstSets.ListCount - 1		    lstSets.Expanded(i) = True		  Next		End Sub	#tag EndMethod	#tag Property, Flags = &h0		FolderIcon As Picture	#tag EndProperty	#tag Constant, Name = kSetManager, Type = String, Dynamic = True, Default = \"Set Manager", Scope = Protected		#Tag Instance, Platform = Any, Language = en, Definition  = \"Set Manager"		#Tag Instance, Platform = Any, Language = nl, Definition  = \"Set Manager"	#tag EndConstant#tag EndWindowCode#tag Events arSet	#tag Event		Sub ActionAdd()		  lstSets.AddFolder( "Untitled Set" )		  lstSets.RowPicture( lstSets.LastIndex ) = FolderIcon		  lstSets.CellType( lstSets.LastIndex, 0) = lstSets.TypeEditable		End Sub	#tag EndEvent	#tag Event		Sub ActionRemove()		  lstSets.RemoveRow( lstSets.ListIndex )		End Sub	#tag EndEvent#tag EndEvents#tag Events lstSets	#tag Event		Sub ExpandRow(row As Integer)		  For i as Integer = 0 to wndMain.lstMovies.ListCount - 1		    If wndMain.lstMovies.Cell( i, 9 ) = Me.Cell(row,0) then Me.AddRow wndMain.lstMovies.Cell( i, 0 ), wndMain.lstMovies.Cell( i, 1 )		    'Me.RowPicture( Me.LastIndex ) = miniconmovie		  Next		End Sub	#tag EndEvent	#tag Event		Sub Change()		  arSet.RemoveEnabled = Me.ListIndex > -1		End Sub	#tag EndEvent#tag EndEvents