#tag WindowBegin Window wndHTMLExporter   BackColor       =   &hFFFFFF   Backdrop        =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   5.8e+2   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   3   Resizeable      =   False   Title           =   "HTML Exporter"   Visible         =   True   Width           =   6.4e+2   Begin PopupMenu popTemplateSelector      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   182      ListIndex       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   14      Underline       =   ""      Visible         =   True      Width           =   250   End   Begin Label lblArray      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   0      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   1      TabPanelIndex   =   0      Text            =   "Select Template:"      TextAlign       =   2      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   14      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   150   End   Begin Canvas cvsPreview      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   400      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Top             =   126      UseFocusRing    =   True      Visible         =   True      Width           =   600   End   Begin Label lblArray      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   1      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   3      TabPanelIndex   =   0      Text            =   "Name:"      TextAlign       =   2      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   46      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   150   End   Begin Label lblArray      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   2      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   4      TabPanelIndex   =   0      Text            =   "Author:"      TextAlign       =   2      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   70      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   150   End   Begin Label lblTmplName      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   182      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   5      TabPanelIndex   =   0      Text            =   "Untitled"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   46      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   438   End   Begin Label lblTmplAuthor      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   182      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   6      TabPanelIndex   =   0      Text            =   "Untitled"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   70      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   438   End   Begin Label lblArray      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   3      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   7      TabPanelIndex   =   0      Text            =   "Description:"      TextAlign       =   2      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   94      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   150   End   Begin Label lblTmplDescription      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   182      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   8      TabPanelIndex   =   0      Text            =   "Untitled"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   94      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   438   End   Begin ccCancelSave CancelSave      AcceptFocus     =   ""      AcceptTabs      =   True      AutoDeactivate  =   True      BackColor       =   &hFFFFFF      Backdrop        =   ""      Enabled         =   True      EraseBackground =   True      HasBackColor    =   False      Height          =   22      HelpTag         =   ""      InitialParent   =   ""      Left            =   420      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   9      TabPanelIndex   =   0      TabStop         =   True      Top             =   538      UseFocusRing    =   ""      Visible         =   True      Width           =   200   End   Begin ProgressBar prgBar      AutoDeactivate  =   True      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Maximum         =   0      Scope           =   0      TabPanelIndex   =   0      Top             =   538      Value           =   0      Visible         =   False      Width           =   388   End   Begin Thread ThrProcess      Height          =   32      Index           =   -2147483648      Left            =   70      LockedInPosition=   False      Priority        =   5      Scope           =   0      StackSize       =   0      TabPanelIndex   =   0      Top             =   605      Width           =   32   EndEnd#tag EndWindow#tag WindowCode	#tag Property, Flags = &h21		Private DestinationFolder As FolderItem	#tag EndProperty#tag EndWindowCode#tag Events popTemplateSelector	#tag Event		Sub Change()		  HTMLTemplate.ReadTemplateInfo( Me.RowTag( Me.ListIndex ) )		  		  lblTmplName.Text = HTMLTemplate.TemplateName		  lblTmplAuthor.Text = HTMLTemplate.TemplateAuthor		  lblTmplDescription.Text = HTMLTemplate.TemplateDescription		  		  cvsPreview.Reload		End Sub	#tag EndEvent	#tag Event		Sub Open()		  Dim TemplatesFolder as FolderItem = Preferences.fAppSupport.Child("Templates")		  If NOT TemplatesFolder IsA FolderItem Then		    MsgBox "No templates available."		    Close		    Return		  End If		  		  		  For i as Integer = 1 to TemplatesFolder.Count		    If TemplatesFolder.Item(i) = Nil OR NOT TemplatesFolder.Item(i).Directory Then Continue		    Me.AddRow( TemplatesFolder.Item(i).Name )		    Me.RowTag( Me.ListCount -1 ) = TemplatesFolder.Item(i)		  Next		  		  If Me.ListCount > 0 Then Me.ListIndex = 0		End Sub	#tag EndEvent#tag EndEvents#tag Events cvsPreview	#tag Event		Sub Paint(g As Graphics, areas() As REALbasic.Rect)		  g.ForeColor = &c929292		  g.FillRect 0, 0, Width, Height		  		  If HTMLTemplate.Screenshot <> Nil Then		    Dim ScaledWidth as Double = ScaledDim( HTMLTemplate.Screenshot, g.Width, g.Height, True )		    Dim ScaledHeight as Double = ScaledDim( HTMLTemplate.Screenshot, g.Width, g.Height, False )		    		    g.ScaleImage( HTMLTemplate.Screenshot, g.Width, g.Height, ( g.Width / 2 ) - ( ScaledWidth / 2 ), ( g.Height / 2 ) - ( ScaledHeight / 2 ) )		  End If		  		  g.ForeColor = &c000000		  g.DrawRect 0, 0, g.Width, g.Height		End Sub	#tag EndEvent#tag EndEvents#tag Events CancelSave	#tag Event		Sub Open()		  Me.CaptionOK = Loc.dlgSave		End Sub	#tag EndEvent	#tag Event		Sub ActionCancel()		  Close		End Sub	#tag EndEvent	#tag Event		Sub ActionOK()		  		  If Trim( popTemplateSelector.Text ) = "" Then		    MessageBox "Make a selection first!"		    Return		  End If		  		  DestinationFolder = SelectFolder		  If DestinationFolder = Nil Or NOT DestinationFolder.Exists Then Return		  		  If ActiveSection = 0 Then		    Dim tmpMax as Integer = 0		    For i as Integer = 0 to wndMain.lstMovies.ListCount -1		      If wndMain.lstMovies.Cell( i, 2 ) = "" Then Continue		      tmpMax = tmpMax + 1		    Next		    prgBar.Maximum = tmpMax		    prgBar.Visible = True		  End If		  		  Me.btnLeft.Enabled = False		  Me.btnRight.Enabled = False		  		  HTMLTemplate.ProcessTemplate( popTemplateSelector.RowTag( popTemplateSelector.ListIndex ), DestinationFolder )		  		  prgBar.Visible = False		  		  Close		End Sub	#tag EndEvent#tag EndEvents#tag Events ThrProcess	#tag Event		Sub Run()		  		  		  Close		End Sub	#tag EndEvent#tag EndEvents