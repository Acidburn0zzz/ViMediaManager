#tag ModuleProtected Module TVAttr	#tag Method, Flags = &h1		Protected Sub ClearProperties()		  ReDim Actor_ID(-1)		  ReDim Actor_Name(-1)		  ReDim Actor_Role(-1)		  ReDim Actor_ThumbURL(-1)		  		  		  ReDim ART_PosterURLs(-1)		  ReDim ART_SeasonURLs(-1)		  ReDim ART_SeasonNumbers(-1)		  		  ReDim ART_FanartDimensions(-1)		  ReDim ART_FanartThumbURLs(-1)		  ReDim ART_FanartURLs(-1)		  		  ReDim Art_BannerURLs(-1)		  		  		  ART_Poster       = Nil		  ART_Fanart       = Nil		  ART_Banner       = Nil		  		  ART_Logo         = Nil		  ART_ClearArt     = Nil		  ART_TVThumb      = Nil		  ART_CharacterArt = Nil		  		  ART_MPAARating   = Nil		  ART_Studio       = Nil		  		  ID_IMDb   = ""		  ID_TVDB   = ""		  ID_TVRage = ""		  		  Title         = ""		  TitleSort     = ""		  TitleOriginal = ""		  		  		  CreditDirector = ""		  CreditWriter   = ""		  CreditMusic    = ""		  		  DatePremiered = ""		  DateYear = -1		  		  DescriptionTagline = ""		  DescriptionOutline = ""		  DescriptionPlot    = ""		  		  DurationRuntime = -1		  		  ReDim Genres(-1)		  		  NextAired_Date = ""		  NextAired_Episode = ""		  		  Rating = -1		  RatingMPAA = ""		  RatingVotes = -1		  		  Status = ""		  Studio = ""		End Sub	#tag EndMethod	#tag Method, Flags = &h1		Protected Function DestinationNFO(TVShowParent as FolderItem) As FolderItem		  		End Function	#tag EndMethod	#tag Method, Flags = &h1		Protected Sub LoadImages(TVParent as FolderItem)		  		End Sub	#tag EndMethod	#tag Method, Flags = &h1		Protected Sub NFORead(NFOParent as FolderItem)		  Dim Xml as New XmlDocument		  Dim xRoot, xNode, xItem as XmlNode		  		  If NFOParent = Nil OR NOT NFOParent.Exists Then Return		  Dim NFOFile as FolderItem = FindNFOFile( NFOParent )		  		  ClearProperties		  Xml.PreserveWhitespace = False		  		  // Is there an NFO file?		  Dim Content as String		  If NFOFile <> Nil And NFOFile.Exists Then		    Dim TextIn as TextInputStream = TextInputStream.Open( NFOFile )		    Content = Trim( TextIn.ReadAll )		    TextIn.Close		  Else		    Return		  End If		  		  Content = Trim( RemoveLinks( Content ) )		  If Content.Left(10).InStr( 0, "<?xml" ) > 0 Then		    Xml.LoadXml( Content )		  ElseIf Content.Left(5) = "http:" And Content.InStr( 0, "imdb.com" ) > 0 Then		    Dim s() as String = Content.Split("/")		    For i as Integer = 0 to s.Ubound		      If s(i).Left(2) = "tt" Then TVAttr.ID_IMDb = s(i)		    Next		    Return		  Else		    Return		  End If		  		  For i as Integer = 0 to Xml.ChildCount - 1		    If Xml.Child(i).Name = "tvshow" Then xRoot = Xml.Child(i)		  Next		  		  For i as Integer = 0 to xRoot.ChildCount - 1		    xNode = xRoot.Child(i)		    		    If xNode.FirstChild = Nil Then Continue		    		    Select Case xNode.Name		      		      // ID		    Case "id"		      If xNode.FirstChild.Value.Left(2) = "tt" Then		        TVAttr.ID_IMDb = xNode.FirstChild.Value		      Else		        TVAttr.ID_TVDB = xNode.FirstChild.Value		      End If		      		      If xNode.GetAttribute("moviedb") = "tvdb" then		        TVAttr.ID_TVDB   = xNode.FirstChild.Value		      ElseIf xNode.GetAttribute("moviedb") = "IMDb" then		        TVAttr.ID_IMDb   = xNode.FirstChild.Value		      ElseIf xNode.GetAttribute("moviedb") = "tvrage" Then		        TVAttr.ID_TVRage = xNode.FirstChild.Value		      End If		      		    case "boxeeTVDB"		      TVAttr.ID_TVDB = xNode.FirstChild.Value		    case "boxeeIMDb"		      TVAttr.ID_IMDb = xNode.FirstChild.Value		    case "boxeeTVRage"		      TVAttr.ID_TVRage = xNode.FirstChild.Value		      		      // Title		    case "title"		      TVAttr.Title = xNode.FirstChild.Value		    case "sorttitle"		      TVAttr.TitleSort = xNode.FirstChild.Value		    case "originaltitle"		      TVAttr.TitleOriginal = xNode.FirstChild.Value		      		    case "tagline"		      TVAttr.DescriptionTagline = xNode.FirstChild.Value		    case "outline"		      TVAttr.DescriptionOutline = xNode.FirstChild.Value		    case "plot"		      TVAttr.DescriptionPlot    = xNode.FirstChild.Value		      		    case "status"		      TVAttr.Status = xNode.FirstChild.Value		      		      // Rating		    case "rating"		      TVAttr.Rating = Val( xNode.FirstChild.Value )		    case "votes"		      TVAttr.RatingVotes = Val( xNode.FirstChild.Value )		    case "mpaa"		      TVAttr.RatingMPAA = xNode.FirstChild.Value		      		      // Dates		    case "year"		      TVAttr.DateYear = Val( xNode.FirstChild.Value )		    case "premiered"		      TVAttr.DatePremiered = xNode.FirstChild.Value		      		      // Other		    case "genre"		      TVAttr.Genres.Append xNode.FirstChild.Value		    case "studio"		      TVAttr.Studio = xNode.FirstChild.Value		    case "status"		      TVAttr.Status = xNode.FirstChild.Value		    case "runtime"		      TVAttr.DurationRuntime = Val( xNode.FirstChild.Value )		      		      // Actors		    case "actor"		      // Actor ID		      If xNode.AttributeCount > -1 Then Actor_ID.Append xNode.GetAttribute("id") Else Actor_ID.Append ""		      		      For n as Integer = 0 to xNode.ChildCount -1		        xItem = xNode.Child(n)		        		        If xNode.ChildCount > 2 Then		          Select case xItem.Name		          Case "name"		            If xItem.FirstChild <> Nil Then TVAttr.Actor_Name.Append xItem.FirstChild.Value Else TVAttr.Actor_Name.Append ""		          case "role"		            If xItem.FirstChild <> Nil Then TVAttr.Actor_Role.Append xItem.FirstChild.Value Else TVAttr.Actor_Role.Append ""		          case "thumb"		            If xItem.FirstChild <> Nil Then TVAttr.Actor_ThumbURL.Append xItem.FirstChild.Value Else TVAttr.Actor_ThumbURL.Append ""		            		          End Select		          		          		        ElseIf xNode.ChildCount = 2 Then		          Select case xItem.Name		          Case "name"		            If xItem.FirstChild <> Nil Then TVAttr.Actor_Name.Append xItem.FirstChild.Value Else TVAttr.Actor_Name.Append ""		          case "role"		            If xItem.FirstChild <> Nil Then TVAttr.Actor_Role.Append xItem.FirstChild.Value Else TVAttr.Actor_Role.Append ""		            		          End Select		          		          TVAttr.Actor_ThumbURL.Append ""		          		        ElseIf xNode.ChildCount = 1 Then		          Select case xItem.Name		          Case "name"		            If xItem.FirstChild <> Nil Then TVAttr.Actor_Name.Append xItem.FirstChild.Value Else TVAttr.Actor_Name.Append ""		          End Select		          		          TVAttr.Actor_Role.Append ""		          TVAttr.Actor_ThumbURL.Append ""		          		        End If		        		      Next		      		    case "thumb"		      If xNode.GetAttribute("type") = "season" and xNode.GetAttribute("season") <> "-1" Then		        TVAttr.ART_SeasonURLs.Append     xNode.FirstChild.Value		        TVAttr.ART_SeasonNumbers.Append  xNode.GetAttribute("season")		      ElseIf xNode.FirstChild.Value.InStr(0, "graphical") > 0 Or xNode.FirstChild.Value.InStr(0, "text") > 0 Or xNode.FirstChild.Value.InStr(0, "blank") > 0 Then		        TVAttr.Art_BannerURLs.Append     xNode.FirstChild.Value		      ElseIf xNode.FirstChild.Value.InStr(0, "poster") > 0 And xNode.AttributeCount = 0 And xNode.FirstChild.Value.Left(4) = "http" Then		        TVAttr.ART_PosterURLs.Append     xNode.FirstChild.Value		      End If		      		    case "fanart"		      For n as Integer = 0 to xNode.ChildCount - 1		        xItem = xNode.Child(n)		        		        TVAttr.ART_FanartURLs.Append        xItem.FirstChild.Value		        TVAttr.ART_FanartThumbURLs.Append   xItem.GetAttribute("preview")		        TVAttr.ART_FanartDimensions.Append  xItem.GetAttribute("dim")		      Next		      		    End Select		    		  Next		  		Exception err as NilObjectException		  MessageBox "File not found or invalid XML item found." + chr(13) + chr(13) + "Please let the author know about this as soon as possible."		  Return		  		Exception err as OutOfBoundsException		  MessageBox "Something went wrong while reading the movie " + MovieAttr.FolderParent.Name + "'s NFO file..." + chr(13) + chr(13) + "Please let the author know about this as soon as possible."		  Return		  		Exception err as XmlException		  MessageBox "Invalid or not well-formed XML NFO file found for movie " + MovieAttr.FolderParent.Name + chr(13) + chr(13) + "You should consider removing the NFO file for said movie item before continuing."		  Return		  		Exception err as IOException		  MessageBox "IOException error Number: " + str(err.ErrorNumber) + chr(13) + chr(13) + _		  err.Message + chr(13) + _		  "Something might have gone wrong while reading: " + MovieAttr.FolderParent.Name + chr(13) + _		  "Please contact the author."		  Return		End Sub	#tag EndMethod	#tag Method, Flags = &h1		Protected Sub NFOWrite(NFOParent as FolderItem)		  		End Sub	#tag EndMethod	#tag Property, Flags = &h1		Protected Actor_ID() As String	#tag EndProperty	#tag Property, Flags = &h1		Protected Actor_Name() As String	#tag EndProperty	#tag Property, Flags = &h1		Protected Actor_Role() As String	#tag EndProperty	#tag Property, Flags = &h1		Protected Actor_ThumbURL() As String	#tag EndProperty	#tag Property, Flags = &h1		Protected ART_Banner As Picture	#tag EndProperty	#tag Property, Flags = &h1		Protected Art_BannerURLs() As String	#tag EndProperty	#tag Property, Flags = &h1		Protected ART_CharacterArt As Picture	#tag EndProperty	#tag Property, Flags = &h1		Protected ART_ClearArt As Picture	#tag EndProperty	#tag Property, Flags = &h1		Protected ART_Fanart As Picture	#tag EndProperty	#tag Property, Flags = &h1		Protected ART_FanartDimensions() As String	#tag EndProperty	#tag Property, Flags = &h1		Protected ART_FanartThumbURLs() As String	#tag EndProperty	#tag Property, Flags = &h1		Protected ART_FanartURLs() As String	#tag EndProperty	#tag Property, Flags = &h1		Protected ART_Logo As Picture	#tag EndProperty	#tag Property, Flags = &h1		Protected ART_MPAARating As PIcture	#tag EndProperty	#tag Property, Flags = &h1		Protected ART_Poster As Picture	#tag EndProperty	#tag Property, Flags = &h1		Protected ART_PosterURLs() As String	#tag EndProperty	#tag Property, Flags = &h1		Protected ART_SeasonNumbers() As String	#tag EndProperty	#tag Property, Flags = &h1		Protected ART_SeasonURLs() As String	#tag EndProperty	#tag Property, Flags = &h1		Protected ART_Studio As Picture	#tag EndProperty	#tag Property, Flags = &h1		Protected ART_TVThumb As Picture	#tag EndProperty	#tag Property, Flags = &h1		Protected CreditDirector As String	#tag EndProperty	#tag Property, Flags = &h1		Protected CreditMusic As String	#tag EndProperty	#tag Property, Flags = &h1		Protected CreditWriter As String	#tag EndProperty	#tag Property, Flags = &h1		Protected DatePremiered As String	#tag EndProperty	#tag Property, Flags = &h1		Protected DateYear As Integer	#tag EndProperty	#tag Property, Flags = &h1		Protected DescriptionOutline As String	#tag EndProperty	#tag Property, Flags = &h1		Protected DescriptionPlot As String	#tag EndProperty	#tag Property, Flags = &h1		Protected DescriptionTagline As String	#tag EndProperty	#tag Property, Flags = &h1		Protected DurationRuntime As Integer	#tag EndProperty	#tag Property, Flags = &h1		Protected FolderParent As Folderitem	#tag EndProperty	#tag Property, Flags = &h1		Protected Genres() As String	#tag EndProperty	#tag Property, Flags = &h1		Protected ID_IMDb As String	#tag EndProperty	#tag Property, Flags = &h1		Protected ID_TVDB As String	#tag EndProperty	#tag Property, Flags = &h1		Protected ID_TVRage As String	#tag EndProperty	#tag Property, Flags = &h1		Protected NextAired_Date As String	#tag EndProperty	#tag Property, Flags = &h1		Protected NextAired_Episode As String	#tag EndProperty	#tag Property, Flags = &h1		Protected Rating As Double	#tag EndProperty	#tag Property, Flags = &h1		Protected RatingMPAA As String	#tag EndProperty	#tag Property, Flags = &h1		Protected RatingVotes As Integer	#tag EndProperty	#tag Property, Flags = &h1		Protected Status As String	#tag EndProperty	#tag Property, Flags = &h1		Protected Studio As String	#tag EndProperty	#tag Property, Flags = &h1		Protected Title As String	#tag EndProperty	#tag Property, Flags = &h1		Protected TitleOriginal As String	#tag EndProperty	#tag Property, Flags = &h1		Protected TitleSort As String	#tag EndProperty	#tag ViewBehavior		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Module#tag EndModule