#tag ModuleProtected Module PaintBucket	#tag Method, Flags = &h0		Function FlipImageHorizontal(P as Picture) As Picture		  Dim pic as picture		  Dim x, y, x2 as Integer		  Dim picS, maskS, picS2, maskS2 as RGBSurface		  		  pic    = New Picture( p.width, p.height, p.depth)		  picS   = p.rgbSurface		  maskS  = p.mask.rgbSurface		  picS2  = pic.rgbSurface		  maskS2 = pic.mask.rgbSurface		  		  For x = p.width-1 downTo 0		    For y = p.height-1 downTo 0		      picS2.Pixel(x,y) =  picS.Pixel(x2,y)		      maskS2.Pixel(x,y) = maskS.Pixel(x2,y)		    next		    x2=x2+1		  next		  		  Return pic		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function FlipImageVertical(P as Picture) As Picture		  Dim pic as picture		  Dim x, y, y2 as Integer		  Dim picS, maskS, picS2, maskS2 as RGBSurface		  		  pic    = New Picture( p.width, p.height, p.depth )		  picS   = p.rgbSurface		  maskS  = p.mask.rgbSurface		  picS2  = pic.rgbSurface		  maskS2 = pic.mask.rgbSurface		  		  For y = p.height-1 downTo 0		    For x = p.width-1 downTo 0		      picS2.Pixel(x,y) =  picS.Pixel(x,y2)		      maskS2.Pixel(x,y) = maskS.Pixel(x,y2)		    next		    y2=y2+1		  next		  		  Return pic		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function RotateImage90Deg(p as Picture) As Picture		  Dim pic as Picture		  Dim x, y, y2, w, h as Integer		  Dim picS, maskS, picS2, maskS2 as RGBSurface		  		  pic = New Picture( p.width, p.height, p.depth )		  		  picS = p.RGBSurface		  maskS = p.Mask.RGBSurface		  picS2 = pic.RGBSurface		  maskS2 = pic.Mask.RGBSurface		  		  w = p.Width - 1		  h = p.Height - 1		  		  For x = 0 To w		    For y = 0 to h		      picS2.Pixel( y, x )  = picS.Pixel(  w - x, y )		      maskS2.Pixel( y, x ) = maskS.Pixel( w - x, y )		    next		  next		  		  Return pic		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function ScaleImage(pic as Picture, Width As Integer, Height As Integer, UpScale As Boolean = False, ScaleWidth As Boolean = True, ScaleHeight As Boolean = True) As Picture		  Dim ScaledPic as Picture		  Dim Factor as Double		  If pic = Nil then Return Nil		  		  If NOT ScaleHeight AND ScaleWidth then		    Factor = Min( Width / pic.Width, pic.Height ) // Only scale width wise		  ElseIf NOT ScaleWidth AND ScaleHeight then		    Factor = Min( pic.Width, Height / pic.Height ) // Only scale height wise		  ElseIf ScaleWidth and ScaleHeight then		    Factor = Min( Width / pic.Width, Height / pic.Height ) // Scale both		  End if		  		  If NOT UpScale then Factor = Min( Factor, 1.0 )		  		  ScaledPic = New Picture( pic.Width * Factor, pic.Height * Factor, 32 )		  ScaledPic.Graphics.DrawPicture      pic,      0, 0, ScaledPic.Width, ScaledPic.Height,   0, 0, pic.Width, pic.Height		  ScaledPic.Mask.Graphics.DrawPicture pic.Mask, 0, 0, ScaledPic.Width, ScaledPic.Height,   0, 0, pic.Width, pic.Height		  		  Return ScaledPic		End Function	#tag EndMethodEnd Module#tag EndModule