#tag ClassProtected Class SuperTextAreaInherits TextArea	#tag Event		Sub DropObject(obj As DragItem, action As Integer)		  If obj.TextAvailable Then SelText = obj.Text		End Sub	#tag EndEvent	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  If NOT TargetCocoa And ( IsContextualClick Or ( TargetMacOS And Keyboard.AsyncControlKey ) ) then		    ContextualMenu		    Return True		  End If		End Function	#tag EndEvent	#tag Event		Sub Open()		  AcceptTextDrop		  Open		End Sub	#tag EndEvent	#tag Method, Flags = &h21		Private Sub ContextualMenu()		  Dim base as new MenuItem		  		  // Create menu		  base.Append New MenuItem(menu.EditCut)		  base.Append New MenuItem(menu.EditCopy)		  base.Append New MenuItem(menu.EditPaste)		  base.Append New MenuItem(menu.EditDelete)		  base.Append New MenuItem("-")		  base.Append New MenuItem(menu.EditSelectAll)		  		  // Set menu item names		  base.Item(0).Name = "Cut"		  base.Item(1).Name = "Copy"		  base.Item(2).Name = "Paste"		  base.Item(3).Name = "Delete"		  base.Item(5).Name = "SelectAll"		  		  // Cut enabler		  base.Item(0).Enabled = SelLength > 0 And ReadOnly = False		  // Copy enabler		  base.Item(1).Enabled = SelLength > 0		  // Paste enabler		  base.Item(2).Enabled = ReadOnly = False		  // Delete enabler		  base.Item(3).Enabled = base.Item(0).Enabled		  // Select all enabler		  base.Item(5).Enabled = len( Text ) > 0		  		  		  // Show menu		  Dim hitItem as MenuItem		  hitItem = base.PopUp		  		  If hitItem = Nil then Return		  		  // Actions		  Dim item as String = hitItem.Name		  		  Select case item		    		  Case "Cut"		    Copy		    SelText = ""		  Case "Copy"		    Copy		  Case "Paste"		    Paste		  Case "Delete"		    SelText = ""		  Case "SelectAll"		    SelectAll		    		  End Select		End Sub	#tag EndMethod	#tag Hook, Flags = &h0		Event Open()	#tag EndHook	#tag ViewBehavior		#tag ViewProperty			Name="AcceptTabs"			Visible=true			Group="Behavior"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Alignment"			Visible=true			Group="Behavior"			InitialValue="0"			Type="Integer"			EditorType="Enum"			InheritedFrom="TextArea"			#tag EnumValues				"0 - Default"				"1 - Left"				"2 - Center"				"3 - Right"			#tag EndEnumValues		#tag EndViewProperty		#tag ViewProperty			Name="AutoDeactivate"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="AutomaticallyCheckSpelling"			Visible=true			Group="Behavior"			InitialValue="True"			Type="boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="BackColor"			Visible=true			Group="Appearance"			InitialValue="&hFFFFFF"			Type="Color"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Bold"			Visible=true			Group="Font"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Border"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="DataField"			Visible=true			Group="Database Binding"			Type="String"			EditorType="DataField"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="DataSource"			Visible=true			Group="Database Binding"			Type="String"			EditorType="DataSource"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Enabled"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Format"			Visible=true			Group="Appearance"			Type="String"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Height"			Visible=true			Group="Position"			InitialValue="100"			Type="Integer"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="HelpTag"			Visible=true			Group="Appearance"			Type="String"			EditorType="MultiLineEditor"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="HideSelection"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			Type="Integer"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Italic"			Visible=true			Group="Font"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			Type="Integer"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="LimitText"			Visible=true			Group="Behavior"			InitialValue="0"			Type="Integer"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="LineHeight"			Visible=true			Group="Appearance"			InitialValue="0"			Type="Double"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="LineSpacing"			Visible=true			Group="Appearance"			InitialValue="1"			Type="Double"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="LockBottom"			Visible=true			Group="Position"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="LockLeft"			Visible=true			Group="Position"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="LockRight"			Visible=true			Group="Position"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="LockTop"			Visible=true			Group="Position"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Mask"			Visible=true			Group="Behavior"			Type="String"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Multiline"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			Type="String"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="ReadOnly"			Visible=true			Group="Behavior"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="ScrollbarHorizontal"			Visible=true			Group="Appearance"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="ScrollbarVertical"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Styled"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="TabIndex"			Visible=true			Group="Position"			InitialValue="0"			Type="Integer"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="TabPanelIndex"			Group="Position"			InitialValue="0"			Type="Integer"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="TabStop"			Visible=true			Group="Position"			InitialValue="True"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Text"			Visible=true			Group="Initial State"			Type="String"			EditorType="MultiLineEditor"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="TextColor"			Visible=true			Group="Appearance"			InitialValue="&h000000"			Type="Color"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="TextFont"			Visible=true			Group="Font"			InitialValue="System"			Type="String"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="TextSize"			Visible=true			Group="Font"			InitialValue="0"			Type="Single"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="TextUnit"			Visible=true			Group="Font"			InitialValue="0"			Type="FontUnits"			EditorType="Enum"			InheritedFrom="TextArea"			#tag EnumValues				"0 - Default"				"1 - Pixel"				"2 - Point"				"3 - Inch"				"4 - Millimeter"			#tag EndEnumValues		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			Type="Integer"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Underline"			Visible=true			Group="Font"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="UseFocusRing"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Visible"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="TextArea"		#tag EndViewProperty		#tag ViewProperty			Name="Width"			Visible=true			Group="Position"			InitialValue="100"			Type="Integer"			InheritedFrom="TextArea"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass