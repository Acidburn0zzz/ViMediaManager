#tag ClassProtected Class ListboxPROInherits Listbox	#tag Event		Function CellBackgroundPaint(g As Graphics, row As Integer, column As Integer) As Boolean		  Dim i as integer, ratio, endratio as Double		  Dim StartColor, EndColor, TopColor as Color		  		  // Background color(s)		  if AlternatingRows then		    AppleSidebar = false		    if row <= me.LastIndex then		      if row mod 2 = 0 then		        g.ForeColor = RGB(255, 255, 255)		      else		        g.ForeColor = RGB(237, 243, 254)		      end if		      		    else		      g.ForeColor = RGB(255, 255, 255)		    end if		    		  elseif AppleSidebar then		    AlternatingRows = false		    if self.Active = false or me.Enabled = false then		      g.ForeColor = RGB(237, 237, 237)		    elseif self.Active = true or me.Enabled then		      g.ForeColor = RGB(222, 228, 234)		    end if		  end if		  		  // Draw background color		  g.FillRect 0, 0, g.Width, g.Height		  		  // Selection background gradient		  if SelectionGradient then		    if not me.Selected(row) then return false		    		    // Pick our colors		    if me.Active = false or me.EnableD = False then		      StartColor = RGB(194, 194, 194)		      EndColor = RGB( 155, 155, 155)		      TopColor = RGB( 168, 168, 168)		    else		      StartColor = RGB(116, 163, 219)		      EndColor = RGB(50, 102, 183)		      TopColor = RGB(96, 146, 209)		    end if		    		    // Draw background gradient		    for i = 0 to g.Height		      // Determine the current line's color		      ratio = ( ( g.Height - i ) / g.Height )		      endratio = ( i / g.Height )		      g.ForeColor = RGB( _		      EndColor.Red * endratio + StartColor.Red * ratio, _		      EndColor.Green * endratio + StartColor.Green * ratio, _		      EndColor.Blue * endratio + StartColor.Blue * ratio )		      		      // Draw the step		      g.DrawLine 0, i, g.Width, i		    next		    		    // Draw the top border		    g.ForeColor = TopColor		    g.DrawLine 0, 0, g.Width, 0		    		    Return true		  end if		End Function	#tag EndEvent	#tag Event		Function CellTextPaint(g As Graphics, row As Integer, column As Integer, x as Integer, y as Integer) As Boolean		  if SelectionGradient then		    		    if me.listindex = row then		      		      if me.Active = false or me.Enabled = false then		        g.ForeColor = rgb(114, 114, 114)		      else		        g.ForeColor = rgb(51, 84, 133)		      end if		      g.Bold = true		      		      if RightSidePicture then		        g.drawstring cell( row, column ), 4, defaultRowHeight - ( defaultRowHeight - g.textsize ) \ 2 - 1, me.width - 12 - 24 - 40, True		      else		        g.drawstring cell( row, column ), 4, defaultRowHeight - ( defaultRowHeight - g.textsize ) \ 2 - 1, me.width - 8, True		      end if		      		      g.ForeColor = RGB(255, 255, 255)		    else		      		      g.ForeColor = RGB(0, 0, 0)		    end if		    		    if RightSidePicture then		      g.drawstring cell( row, column ), 4, defaultRowHeight - ( defaultRowHeight - g.textsize ) \ 2 - 2, me.width - 12 - 24 - 40, True		    else		      g.drawstring cell( row, column ), 4, defaultRowHeight - ( defaultRowHeight - g.textsize ) \ 2 - 2, me.width - 8, True		    end if		    		    if CellTextPaint(g, row, column, x, y) then		      return true		    else		      return true		    end if		    		  end if		  		  'if CellTextPaint(g, row, column, x, y) then return true		End Function	#tag EndEvent	#tag Event		Function KeyDown(Key As String) As Boolean		  Dim i As Integer		  		  if Keyboard.AsyncKeyDown(&h7D) then		    if ListIndex <> ListCount - 1 then ListIndex = ListIndex + 1		    Return True		  ElseIf Keyboard.AsyncKeyDown(&h7E) then		    if ListIndex <> 0 then ListIndex = ListIndex - 1		    Return True		  end if		  		  if ( Ticks - LastKeyPressedAt < 30 ) then LastKeyPressed = LastKeyPressed + Key else LastKeyPressed = Key		  LastKeyPressedAt = Ticks		  'ListIndex = ListIndex		  for i = 0 to ListCount - 1		    if ( Lowercase( Left( List(i), Len( LastKeyPressed ) ) ) = Lowercase( LastKeyPressed ) ) then		      ListIndex = i		      Exit		    end if		  next		  		  if KeyDown(Key) then		    return true		  else		    return true		  end if		End Function	#tag EndEvent	#tag Hook, Flags = &h0		Event CellTextPaint(g As Graphics, Row As Integer, Column As Integer, x As Integer, y As Integer) As Boolean	#tag EndHook	#tag Hook, Flags = &h0		Event KeyDown(Key As String) As Boolean	#tag EndHook	#tag Property, Flags = &h0		AlternatingRows As Boolean = False	#tag EndProperty	#tag Property, Flags = &h0		AppleSidebar As Boolean = True	#tag EndProperty	#tag Property, Flags = &h0		LastKeyPressed As String	#tag EndProperty	#tag Property, Flags = &h0		LastKeyPressedAt As Integer	#tag EndProperty	#tag Property, Flags = &h0		RightSidePicture As Boolean = False	#tag EndProperty	#tag Property, Flags = &h0		SelectionGradient As Boolean = True	#tag EndProperty	#tag ViewBehavior		#tag ViewProperty			Name="AlternatingRows"			Visible=true			Group="Behavior"			InitialValue="False"			Type="Boolean"		#tag EndViewProperty		#tag ViewProperty			Name="AppleSidebar"			Visible=true			Group="Behavior"			InitialValue="True"			Type="Boolean"		#tag EndViewProperty		#tag ViewProperty			Name="AutoDeactivate"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="AutoHideScrollbars"			Visible=true			Group="Behavior"			InitialValue="True"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="Bold"			Visible=true			Group="Font"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="Border"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="ColumnCount"			Visible=true			Group="Appearance"			InitialValue="1"			Type="Integer"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="ColumnsResizable"			Visible=true			Group="Behavior"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="ColumnWidths"			Visible=true			Group="Appearance"			Type="String"			EditorType="MultiLineEditor"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="DataField"			Visible=true			Group="Database Binding"			Type="String"			EditorType="DataField"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="DataSource"			Visible=true			Group="Database Binding"			Type="String"			EditorType="DataSource"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="DefaultRowHeight"			Visible=true			Group="Appearance"			InitialValue="-1"			Type="Integer"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="Enabled"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="EnableDrag"			Visible=true			Group="Behavior"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="EnableDragReorder"			Visible=true			Group="Behavior"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="GridLinesHorizontal"			Visible=true			Group="Appearance"			InitialValue="0"			Type="Integer"			EditorType="Enum"			InheritedFrom="Listbox"			#tag EnumValues				"0 - Default"				"1 - None"				"2 - ThinDotted"				"3 - ThinSolid"				"4 - ThickSolid"				"5 - DoubleThinSolid"			#tag EndEnumValues		#tag EndViewProperty		#tag ViewProperty			Name="GridLinesVertical"			Visible=true			Group="Appearance"			InitialValue="0"			Type="Integer"			EditorType="Enum"			InheritedFrom="Listbox"			#tag EnumValues				"0 - Default"				"1 - None"				"2 - ThinDotted"				"3 - ThinSolid"				"4 - ThickSolid"				"5 - DoubleThinSolid"			#tag EndEnumValues		#tag EndViewProperty		#tag ViewProperty			Name="HasHeading"			Visible=true			Group="Appearance"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="HeadingIndex"			Visible=true			Group="Appearance"			InitialValue="-1"			Type="Integer"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="Height"			Visible=true			Group="Position"			InitialValue="100"			Type="Integer"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="HelpTag"			Visible=true			Group="Appearance"			Type="String"			EditorType="MultiLineEditor"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="Hierarchical"			Visible=true			Group="Behavior"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			Type="Integer"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="InitialParent"			Group="Initial State"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="InitialValue"			Visible=true			Group="Appearance"			Type="String"			EditorType="MultiLineEditor"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="Italic"			Visible=true			Group="Font"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="LastKeyPressed"			Group="Behavior"			Type="String"			EditorType="MultiLineEditor"		#tag EndViewProperty		#tag ViewProperty			Name="LastKeyPressedAt"			Group="Behavior"			Type="Integer"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			Type="Integer"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="LockBottom"			Visible=true			Group="Position"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="LockLeft"			Visible=true			Group="Position"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="LockRight"			Visible=true			Group="Position"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="LockTop"			Visible=true			Group="Position"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			Type="String"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="RequiresSelection"			Visible=true			Group="Behavior"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="RightSidePicture"			Visible=true			Group="Behavior"			InitialValue="False"			Type="Boolean"		#tag EndViewProperty		#tag ViewProperty			Name="ScrollbarHorizontal"			Visible=true			Group="Appearance"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="ScrollBarVertical"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="SelectionGradient"			Visible=true			Group="Behavior"			InitialValue="True"			Type="Boolean"		#tag EndViewProperty		#tag ViewProperty			Name="SelectionType"			Visible=true			Group="Behavior"			InitialValue="0"			Type="Integer"			EditorType="Enum"			InheritedFrom="Listbox"			#tag EnumValues				"0 - Single"				"1 - Multiple"			#tag EndEnumValues		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="TabIndex"			Visible=true			Group="Position"			InitialValue="0"			Type="Integer"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="TabPanelIndex"			Group="Position"			InitialValue="0"			Type="Integer"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="TabStop"			Visible=true			Group="Position"			InitialValue="True"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="TextFont"			Visible=true			Group="Font"			InitialValue="System"			Type="String"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="TextSize"			Visible=true			Group="Font"			InitialValue="0"			Type="Single"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="TextUnit"			Visible=true			Group="Font"			InitialValue="0"			Type="FontUnits"			EditorType="Enum"			InheritedFrom="Listbox"			#tag EnumValues				"0 - Default"				"1 - Pixel"				"2 - Point"				"3 - Inch"				"4 - Millimeter"			#tag EndEnumValues		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			Type="Integer"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="Underline"			Visible=true			Group="Font"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="UseFocusRing"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="Visible"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="Width"			Visible=true			Group="Position"			InitialValue="100"			Type="Integer"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="_ScrollOffset"			Group="Appearance"			InitialValue="0"			Type="Integer"			InheritedFrom="Listbox"		#tag EndViewProperty		#tag ViewProperty			Name="_ScrollWidth"			Group="Appearance"			InitialValue="-1"			Type="Integer"			InheritedFrom="Listbox"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass