#tag WindowBegin Window wndUpdateProgress   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   False   Composite       =   False   Frame           =   1   FullScreen      =   False   HasBackColor    =   False   Height          =   107   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   False   MinWidth        =   64   Placement       =   3   Resizeable      =   False   Title           =   "Updating <AppName>"   Visible         =   True   Width           =   384   Begin Canvas cvsAppLogo      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   64      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   14      UseFocusRing    =   True      Visible         =   True      Width           =   64   End   Begin Label lblTitle      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   96      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Checking for updates..."      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   13      TextUnit        =   0      Top             =   14      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   268   End   Begin ProgressBar pgBar      AutoDeactivate  =   True      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   96      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Maximum         =   0      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Top             =   38      Value           =   0      Visible         =   True      Width           =   268   End   Begin PushButton btnCancel      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   True      Caption         =   "Cancel"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   284      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   70      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin Label lblProgressSize      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   96      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   70      Transparent     =   False      Underline       =   ""      Visible         =   False      Width           =   176   End   Begin HTTPSocket UpdateSocket      Address         =   ""      Height          =   32      Index           =   -2147483648      Left            =   332      LockedInPosition=   False      Port            =   0      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      Top             =   118      Width           =   32      yield           =   0   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Close()		  lblTitle.Text = "Updating " + app.kAppName		  lblProgressSize.Visible = False		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.Title = "Updating " + app.kAppName		End Sub	#tag EndEvent#tag EndWindowCode#tag Events cvsAppLogo	#tag Event		Sub Paint(g As Graphics)		  g.DrawPicture ViMMLogo, 0, 0, me.Width, me.Height, 0, 0, ViMMLogo.Width, ViMMLogo.Height		End Sub	#tag EndEvent#tag EndEvents#tag Events btnCancel	#tag Event		Sub Action()		  UpdateSocket.Close		  self.close		End Sub	#tag EndEvent#tag EndEvents#tag Events UpdateSocket	#tag Event		Sub ReceiveProgress(bytesReceived as integer, totalBytes as integer, newData as string)		  Dim BytesizeReceived as String		  		  pgBar.Maximum = totalBytes		  pgBar.Value = bytesReceived		  		  #if TargetMacOS then		    		    if bytesReceived > 1000000 then		      BytesizeReceived = str( floor( BytesReceived / 1000 / 100 ) / 10 ) + " MB of "		    else		      BytesizeReceived = str( floor( BytesReceived / 1000 ) ) + " KB of "		    end if		    		    lblProgressSize.Text = BytesizeReceived  + str( floor( totalBytes / 1000 / 1000 * 10 ) / 10 ) + " MB"		  #else		    		    if bytesReceived > 1048576 then		      BytesizeReceived = str( floor(BytesReceived / 1024 / 1024 * 10 ) / 10 ) + " MB of "		    else		      BytesizeReceived = str( BytesReceived / 1024 ) + " KB of "		    end if		    		    lblProgressSize.Text = BytesizeReceived + str( floor( totalBytes / 1024 / 1024 * 10 ) / 10 ) + " MB"		  #endif		End Sub	#tag EndEvent	#tag Event		Sub DownloadComplete(url as string, httpStatus as integer, headers as internetHeaders, file as folderItem)		  if file.PhysicalFileTotalLengthMBS < 5000 then		    MsgBox "The file could not be downloaded" + chr(13) + chr(13) + "Try again later, or get in contact with the developer"		    self.Close		    return		  end if		  		  #if TargetWin32 or TargetLinux then		    File.MoveFileTo SpecialFolder.Desktop.Child( file.Name )		  #elseif TargetMacOS then		    file.MoveFileTo SpecialFolder.UserHome.Child( "Downloads" ).Child( file.Name )		    MsgBox app.kAppName + " has been downloaded to the downloads folder"		  #endif		  		  me.Close		  self.Close		End Sub	#tag EndEvent	#tag Event		Sub PageReceived(url as string, httpStatus as integer, headers as internetHeaders, content as string)		  MsgBox "Page?"		End Sub	#tag EndEvent#tag EndEvents