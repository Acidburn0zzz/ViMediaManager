#tag WindowBegin Window wndUpdateAvailable   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   True   Composite       =   True   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   348   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   True   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   348   MinimizeButton  =   True   MinWidth        =   586   Placement       =   3   Resizeable      =   True   Title           =   "Software Update"   Visible         =   True   Width           =   586   Begin Canvas cvsAppLogo      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   64      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   14      UseFocusRing    =   True      Visible         =   True      Width           =   64   End   Begin Label lblTitle      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   96      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Text            =   "A new version of <appname> is available!"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   14      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   470   End   Begin Label lblExplanation      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   29      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   96      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Text            =   "<appname> <newversion> is now availableâ€”you have <oldversion>. Would you like to download it now?"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   38      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   470   End   Begin Label lblReleaseNotes      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   14      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   96      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Release Notes:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   79      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   100   End   Begin PushButton btnOK      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "Install Update"      Default         =   True      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   451      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   308      Underline       =   ""      Visible         =   True      Width           =   115   End   Begin PushButton btnCancel      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   True      Caption         =   "Remind Me Later"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   305      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   308      Underline       =   ""      Visible         =   True      Width           =   134   End   Begin PushButton btnSkip      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "Skip This Version"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   96      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   False      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   308      Underline       =   ""      Visible         =   True      Width           =   137   End   Begin CheckBox chkAuto      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Automatically download and install updates in the future"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   416      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      State           =   0      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   545      Underline       =   ""      Value           =   False      Visible         =   True      Width           =   470   End   Begin Rectangle rctHTMLBorder      AutoDeactivate  =   True      BorderWidth     =   1      BottomRightColor=   9013641      Enabled         =   True      FillColor       =   16777215      Height          =   200      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   96      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   9      TabPanelIndex   =   0      TabStop         =   True      Top             =   97      TopLeftColor    =   9013641      Visible         =   True      Width           =   470      Begin HTMLViewer HTMLReleaseNotes         AutoDeactivate  =   True         Enabled         =   True         Height          =   198         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "rctHTMLBorder"         Left            =   97         LockBottom      =   True         LockedInPosition=   False         LockLeft        =   True         LockRight       =   True         LockTop         =   True         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Top             =   98         Visible         =   True         Width           =   468      End   EndEnd#tag EndWindow#tag WindowCode	#tag MenuHandler		Function FileCloseWindow() As Boolean Handles FileCloseWindow.Action			self.Close			Return True					End Function	#tag EndMenuHandler#tag EndWindowCode#tag Events cvsAppLogo	#tag Event		Sub Paint(g As Graphics)		  g.DrawPicture ViMMLogo, 0, 0, me.Width, me.Height, 0, 0, ViMMLogo.Width, ViMMLogo.Height		End Sub	#tag EndEvent#tag EndEvents#tag Events lblTitle	#tag Event		Sub Open()		  me.Text = "A new version of " + app.kAppName + " is available!"		End Sub	#tag EndEvent#tag EndEvents#tag Events lblExplanation	#tag Event		Sub Open()		  me.Text = me.Text.ReplaceAll( "<appname>", app.kAppName )		  me.Text = me.Text.ReplaceAll( "<newversion>", Glimmer.NewVersion )		  me.Text = me.Text.ReplaceAll( "<oldversion>", Glimmer.CurrentVersion )		End Sub	#tag EndEvent#tag EndEvents#tag Events btnOK	#tag Event		Sub Action()		  Preferences.SkipVersion = ""		  Preferences.WritePrefs		  		  self.Close		  		  wndUpdateProgress.Show		  		  wndUpdateProgress.lblTitle.Text = "Downloading " + app.kAppName + " " + Glimmer.NewVersion		  wndUpdateProgress.lblProgressSize.Visible = True		  		  #if TargetMacOS then		    wndUpdateProgress.UpdateSocket.Get( Glimmer.DownloadURLMac, SpecialFolder.Temporary.Child( app.kAppName + " " + Glimmer.NewVersion + ".zip" ) )		  #elseif TargetWin32 then		    wndUpdateProgress.UpdateSocket.Get( Glimmer.DownloadURLWin, SpecialFolder.Temporary.Child( app.kAppName + " " + Glimmer.NewVersion + ".zip" ) )		  #elseif TargetLinux then		    wndUpdateProgress.UpdateSocket.Get( Glimmer.DownloadURLLinux, SpecialFolder.Temporary.Child( app.kAppName + " " + Glimmer.NewVersion + ".zip" ) )		  #endif		End Sub	#tag EndEvent#tag EndEvents#tag Events btnCancel	#tag Event		Sub Action()		  self.close		End Sub	#tag EndEvent#tag EndEvents#tag Events btnSkip	#tag Event		Sub Action()		  Preferences.SkipVersion = Glimmer.NewVersion		  self.Close		End Sub	#tag EndEvent#tag EndEvents