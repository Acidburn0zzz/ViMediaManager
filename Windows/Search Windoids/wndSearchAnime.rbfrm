#tag WindowBegin Window wndSearchAnime   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   False   Composite       =   True   Frame           =   8   FullScreen      =   False   HasBackColor    =   False   Height          =   455   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   300   MinimizeButton  =   False   MinWidth        =   500   Placement       =   0   Resizeable      =   False   Title           =   "Search AniDB"   Visible         =   True   Width           =   802   Begin ListboxPRO lstAnime      AlternatingRows =   True      AppleSidebar    =   False      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   ""      Border          =   True      ColumnCount     =   3      ColumnsResizable=   ""      ColumnWidths    =   "100%, 0, 0"      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   20      Enabled         =   True      EnableDrag      =   ""      EnableDragReorder=   ""      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   False      HeadingIndex    =   -1      Height          =   371      HelpTag         =   ""      Hierarchical    =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      LastKeyPressedAt=   0      Left            =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      RequiresSelection=   ""      RightSidePicture=   False      Scope           =   0      ScrollbarHorizontal=   True      ScrollBarVertical=   True      SelectionGradient=   True      SelectionType   =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   12      TextUnit        =   0      Top             =   32      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   300      _ScrollWidth    =   -1   End   Begin ccCancelSave CancelSave      AcceptFocus     =   ""      AcceptTabs      =   True      AutoDeactivate  =   True      BackColor       =   16777215      Backdrop        =   ""      Enabled         =   True      EraseBackground =   True      HasBackColor    =   False      Height          =   22      HelpTag         =   ""      InitialParent   =   ""      Left            =   610      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      mOKCaption      =   "&Save"      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Top             =   415      UseFocusRing    =   ""      Visible         =   True      Width           =   172   End   Begin HTMLViewer HTMLView      AutoDeactivate  =   True      Enabled         =   True      Height          =   100      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   831      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      Top             =   0      Visible         =   True      Width           =   100   End   Begin Label lblTitle      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   105      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   312      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   2      TabPanelIndex   =   0      Text            =   "Title"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   16      TextUnit        =   0      Top             =   14      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   325   End   Begin Label lblPremiered      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   312      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   3      TabPanelIndex   =   0      Text            =   "Premiered:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   146      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   70   End   Begin Label lblPremieredValue      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   394      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   4      TabPanelIndex   =   0      Text            =   "0000-00-00"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   146      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   243   End   Begin Label lblPlot      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   312      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   5      TabPanelIndex   =   0      Text            =   "Plot:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   194      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   70   End   Begin TextArea edtPlot      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   True      BackColor       =   16777215      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   177      HelpTag         =   ""      HideSelection   =   True      Index           =   -2147483648      Italic          =   ""      Left            =   299      LimitText       =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Mask            =   ""      Multiline       =   True      ReadOnly        =   True      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   True      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   226      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   503   End   Begin ProgressWheel pgwheel      AutoDeactivate  =   True      Enabled         =   True      Height          =   16      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   582      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      Top             =   415      Visible         =   False      Width           =   16   End   Begin Canvas cvsAniDB      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   200      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   649      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   9      TabPanelIndex   =   0      TabStop         =   True      Top             =   14      UseFocusRing    =   True      Visible         =   True      Width           =   133   End   Begin LinkLabel lblAniDBLinkValue      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   394      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   10      TabPanelIndex   =   0      Text            =   "Link"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   170      Transparent     =   False      Underline       =   ""      URL             =   ""      Visible         =   True      Width           =   108   End   Begin Label lblAniDBLink      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   312      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   11      TabPanelIndex   =   0      Text            =   "AniDB:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   170      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   70   End   Begin CheckBox ChkExact      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Exact Match"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      State           =   1      TabIndex        =   12      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   477      Underline       =   ""      Value           =   True      Visible         =   True      Width           =   138   End   Begin Canvas cvsSearch      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   1450526804      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   32      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   13      TabPanelIndex   =   0      TabStop         =   True      Top             =   0      UseFocusRing    =   True      Visible         =   True      Width           =   300      Begin TextField edtSearch         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   16777215         Bold            =   ""         Border          =   False         CueText         =   "Anime Title OR anidb:1234"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   16         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "cvsSearch"         Italic          =   ""         Left            =   28         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   ""         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   9         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   255      End   End   Begin Line seperatorline      BorderWidth     =   1      Height          =   50      Index           =   -2147483648      InitialParent   =   ""      Left            =   ""      LineColor       =   11974326      LockedInPosition=   False      Scope           =   0      TabPanelIndex   =   0      Top             =   ""      Visible         =   True      Width           =   100      X1              =   0      X2              =   802      Y1              =   401      Y2              =   403   End   Begin Label lblType      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   312      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   14      TabPanelIndex   =   0      Text            =   "Type:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   123      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   70   End   Begin Label lblTypeValue      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   394      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   15      TabPanelIndex   =   0      Text            =   "TV Series / OVA / Movie"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   123      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   243   End   Begin TextField edtDBID      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   ""      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      Italic          =   ""      Left            =   20      LimitText       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Mask            =   ""      Password        =   ""      ReadOnly        =   ""      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   415      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   263   End   Begin Label lblDBID      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   26      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   295      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   17      TabPanelIndex   =   0      Text            =   "Add IMDb, TMDb or TVDB ID for extra metadata and episode guide."      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   414      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   212   EndEnd#tag EndWindow#tag WindowCode	#tag Method, Flags = &h0		Sub quickDecode(XmlContent As String)		  Dim Xml as new XmlDocument		  Dim xroot, xnode, xitem as XmlNode		  Dim i, n as Integer		  Dim xjat, en as String		  		  lblAniDBLinkValue.URL = "http://anidb.net/perl-bin/animedb.pl?show=anime&aid=" + lstAnime.Cell( lstAnime.ListIndex, 1 )		  lblAniDBLinkValue.Text = lstAnime.Cell( lstAnime.ListIndex, 1 )		  		  // RegEx		  Dim myRegEx As new RegEx		  Dim myMatch As RegExMatch		  myRegEx.Options.TreatTargetAsOneLine = True		  myRegEx.SearchPattern = "http://anidb.net/[a-z][a-z0-9]\d* "		  myRegEx.ReplacementPattern = ""		  		  // Pop up all matches one by one		  myMatch = myRegEx.Search( XmlContent )		  While myMatch <> Nil		    XmlContent = myRegEx.Replace( XmlContent )		    myMatch = myRegEx.Search()		  Wend		  		  XmlContent = XmlContent.ReplaceAll( "[", ""  )		  XmlContent = XmlContent.ReplaceAll( "]", ""  )		  XmlContent = XmlContent.ReplaceAll( "`", "'" )		  		  Xml.PreserveWhitespace = False		  Xml.LoadXml( XmlContent )		  xroot = Xml.Child(0)		  		  if xroot.FirstChild = nil then Return		  		  for i = 0 to xroot.ChildCount - 1		    xnode = xroot.Child(i)		    		    Select case xnode.Name		      		    case "titles"		      		      for n = 0 to xnode.ChildCount - 1		        xitem = xnode.Child(n)		        if xitem.GetAttribute("xml:lang") = "x-jat" and xitem.GetAttribute("type") = "main" then		          xjat = xitem.FirstChild.Value		        elseif xitem.GetAttribute("xml:lang") = "en" and xitem.GetAttribute("type") = "official" then		          en = xitem.FirstChild.Value		        end if		        		        'if xitem.GetAttribute("lang") = "en" and xitem.GetAttribute("type") = "official" then en = xitem.FirstChild.Value.ReplaceAll("`", "'")		        'if xitem.GetAttribute("lang") = "x-jat" and xitem.GetAttribute("type") = "main" then xjat = xitem.FirstChild.Value.ReplaceAll("`", "'")		        		        if en <> "" or xjat <> "" then		          lblTitle.Text = en + EndOfLine + xjat		        else		          lblTitle.Text = xitem.FirstChild.Value		        end if		        		      next		      		    case"startdate"		      lblPremieredValue.Text = xnode.FirstChild.Value		      		    case "description"		      edtPlot.Text = xnode.FirstChild.Value.ReplaceAll( chr(10), EndOfLine + EndOfLine )		      		    case "type"		      lblTypeValue.Text = xnode.FirstChild.Value		      		    case "picture"		      Dim pic as Picture = URL2Picture( "http://img7.anidb.net/pics/anime/" + xnode.FirstChild.Value, "AniDBPic" )		      if NOT closed and pic <> nil then cvsAniDB.Backdrop = ScalePic( pic, cvsAniDB.Width, cvsAniDB.Height )		      		      'cvsAniDB.Backdrop = URL2Picture( "http://img7.anidb.net/pics/anime/" + xnode.FirstChild.Value, "AniDBPic" )		      'cvsAniDB.Backdrop = ScalePic( pic, pic.Width, pic.Height )		    end select		    		  next		End Sub	#tag EndMethod	#tag Property, Flags = &h0		closed As Boolean = True	#tag EndProperty	#tag Property, Flags = &h0		lindex As Integer	#tag EndProperty#tag EndWindowCode#tag Events lstAnime	#tag Event		Sub Change()		  if me.Cell( me.ListIndex, 2 ) = "" then		    HTMLView.LoadURL "http://api.anidb.net:9001/httpapi?request=anime&client=vimediamanager&clientver=1&protover=1&aid=" + me.Cell( me.ListIndex, 1 )		  else		    quickDecode me.Cell( me.ListIndex, 2 )		  end if		End Sub	#tag EndEvent	#tag Event		Sub Close()		  closed = True		End Sub	#tag EndEvent	#tag Event		Sub Open()		  Closed = False		End Sub	#tag EndEvent	#tag Event		Sub DoubleClick()		  Scrape.AniDBApi( me.Cell( me.ListIndex, 2 ) )		End Sub	#tag EndEvent#tag EndEvents#tag Events CancelSave	#tag Event		Sub ActionCancel()		  self.close		End Sub	#tag EndEvent	#tag Event		Sub ActionOK()		  if edtDBID.Text <> "" then		    		    if edtDBID.Text.Left(2)  = "tt" and lblTypeValue.Text  = "Movie" then AnimeAttr.ID_IMDB = edtDBID.Text		    if edtDBID.Text.Left(2) <> "tt" and lblTypeValue.Text  = "Movie" then AnimeAttr.ID_TMDB = edtDBID.Text		    if edtDBID.Text.Left(2) <> "tt" and lblTypeValue.Text <> "Movie" then AnimeAttr.ID_TVDB = edtDBID.Text		    		    if edtSearch.Text <> "" and edtSearch.Text.Left(6) = "anidb:" then		      Scrape.AniDBApi( edtDBID.Text.ReplaceAll( "anidb:", "" ), True )		    else		      Scrape.AniDBApi( lstAnime.Cell( lstAnime.ListIndex, 2 ) )		    end if		    		    self.Close		    wndMain.PopulateAnimeList		    		  else		    		    if dlgWindow( "Are you sure you don't want to use a TVDB or TMDB ID?", "Without the ID, XBMC might not match the episodes, and you'll miss out on extra metadata." ) then		      		      if edtSearch.Text <> "" and edtSearch.Text.Left(6) = "anidb:" then		        Scrape.AniDBApi( edtSearch.Text.ReplaceAll( "anidb:", "" ), True )		      else		        Scrape.AniDBApi( lstAnime.Cell( lstAnime.ListIndex, 2 ) )		      end if		      		      self.Close		      wndMain.PopulateAnimeList		      		    else		      		    end if		    		  end if		  		  		End Sub	#tag EndEvent	#tag Event		Sub Open()		  #if TargetMacOS then		    me.btnRight.Default = False		  #else		    me.btnLeft.Default = False		  #endif		End Sub	#tag EndEvent#tag EndEvents#tag Events HTMLView	#tag Event		Sub DocumentBegin(URL as String)		  pgwheel.Visible = True		  lindex = lstAnime.ListIndex		End Sub	#tag EndEvent	#tag Event		Sub DocumentComplete(URL as String)		  if lindex = lstAnime.ListIndex then		    lstAnime.Cell( lstAnime.ListIndex, 2 ) = DefineEncoding( me.mainFrameMBS.dataSource.data, Encodings.UTF8 )		    quickDecode lstAnime.Cell( lstAnime.ListIndex, 2 )		  end if		  if NOT closed then pgwheel.Visible = False		End Sub	#tag EndEvent#tag EndEvents#tag Events cvsAniDB	#tag Event		Sub Paint(g As Graphics)		  g.ForeColor = &c000000		  if me.Backdrop <> nil then g.DrawRect( 0, 0, me.Backdrop.Width, me.Backdrop.Height )		End Sub	#tag EndEvent#tag EndEvents#tag Events ChkExact	#tag Event		Sub Action()		  Preferences.AniDBSearchExact = me.Value		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.Value = Preferences.AniDBSearchExact		End Sub	#tag EndEvent#tag EndEvents#tag Events edtSearch	#tag Event		Function KeyDown(Key As String) As Boolean		  if Keyboard.AsyncKeyDown(&h4C) or Keyboard.AsyncKeyDown(&h24) then		    		    if me.text <> "" and me.Text.Left(6) = "anidb:" then		      Scrape.ManualSearch = False		      		      if edtDBID.text = "" then		        		        if dlgWindow( "Are you sure you don't want to use a TVDB or TMDB ID?", "Without the ID, XBMC might not match the episodes, and you'll miss out on extra metadata." ) then		          self.close		          scrape.AniDBApi( me.text.ReplaceAll( "anidb:", "" ), True )		          wndMain.PopulateAnimeList		        else		          Return True		        end if		        		      elseif edtDBID.text <> "" then		        Scrape.tmpID = edtDBID.Text		        'if edtDBID.Text.Left(2)  = "tt" and lblTypeValue.Text  = "Movie" then AnimeAttr.ID_IMDB = edtDBID.Text		        'if edtDBID.Text.Left(2) <> "tt" and lblTypeValue.Text  = "Movie" then AnimeAttr.ID_TMDB = edtDBID.Text		        'if edtDBID.Text.Left(2) <> "tt" and lblTypeValue.Text <> "Movie" then AnimeAttr.ID_TVDB = edtDBID.Text		        		        self.close		        scrape.AniDBApi( me.text.ReplaceAll( "anidb:", "" ), True )		        'wndMain.PopulateAnimeList		        		      end if		    elseif me.text <> "" then		      pgwheel.Visible = True		      Scrape.ManualSearch = True		      Scrape.AniDBApiSearch( me.Text )		      Scrape.ManualSearch = False		    end if		    		  elseif Keyboard.AsyncKeyDown(&h35) then		    		    #if TargetMacOS then		      CancelSave.btnLeft.Push		    #else		      CancelSave.btnRight.Push		    #endif		    		  end if		End Function	#tag EndEvent#tag EndEvents