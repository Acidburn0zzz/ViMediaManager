#tag WindowBegin Window wndSearchShow   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   False   Composite       =   True   Frame           =   8   FullScreen      =   False   HasBackColor    =   False   Height          =   455   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   300   MinimizeButton  =   False   MinWidth        =   500   Placement       =   0   Resizeable      =   False   Title           =   "Search TVDB"   Visible         =   True   Width           =   540   Begin ccCancelSave CancelSave      AcceptFocus     =   ""      AcceptTabs      =   True      AutoDeactivate  =   True      BackColor       =   16777215      Backdrop        =   ""      Enabled         =   True      EraseBackground =   True      HasBackColor    =   False      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   348      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      mOKCaption      =   "&Save"      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Top             =   415      UseFocusRing    =   ""      Visible         =   True      Width           =   172   End   Begin Canvas cvsBanner      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   True      Enabled         =   True      EraseBackground =   False      Height          =   100      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Top             =   0      UseFocusRing    =   True      Visible         =   True      Width           =   540      Begin Line SeperatorTop         BorderWidth     =   1         Height          =   50         Index           =   -2147483648         InitialParent   =   "cvsBanner"         Left            =   0         LineColor       =   0         LockedInPosition=   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Top             =   100         Visible         =   True         Width           =   100         X1              =   0         X2              =   540         Y1              =   100         Y2              =   100      End      Begin HTTPSocket BannerSocket         Address         =   ""         Height          =   32         Index           =   -2147483648         InitialParent   =   "cvsBanner"         Left            =   20         LockedInPosition=   False         Port            =   0         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         Top             =   20         Width           =   32         yield           =   0      End      Begin Timer dwnloadTimer         Height          =   32         Index           =   -2147483648         InitialParent   =   "cvsBanner"         Left            =   64         LockedInPosition=   False         Mode            =   0         Period          =   1000         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         Top             =   20         Width           =   32      End   End   Begin Label lblTitle      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   187      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Title"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   16      TextUnit        =   0      Top             =   112      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   333   End   Begin Label lblPremiered      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   187      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Premiered:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   136      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   100   End   Begin Label lblPremieredValue      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   299      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      Text            =   "0000-00-00"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   136      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   221   End   Begin Label lblPlot      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   187      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Plot:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   161      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   333   End   Begin TextArea taPlot      AcceptTabs      =   ""      Alignment       =   1      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   221      HelpTag         =   ""      HideSelection   =   True      Index           =   -2147483648      Italic          =   ""      Left            =   174      LimitText       =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Mask            =   ""      Multiline       =   True      ReadOnly        =   True      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   True      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   183      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   366   End   Begin Line SeperatorBottom      BorderWidth     =   1      Height          =   50      Index           =   -2147483648      InitialParent   =   ""      Left            =   0      LineColor       =   11974326      LockedInPosition=   False      Scope           =   0      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      Top             =   403      Visible         =   True      Width           =   100      X1              =   0      X2              =   540      Y1              =   403      Y2              =   403   End   Begin ListboxPRO lstFoundShows      AlternatingRows =   True      AppleSidebar    =   False      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   ""      Border          =   True      ColumnCount     =   1      ColumnsResizable=   ""      ColumnWidths    =   "100%, 0, 0, 0, 0"      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   20      Enabled         =   True      EnableDrag      =   ""      EnableDragReorder=   ""      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   ""      HeadingIndex    =   -1      Height          =   271      HelpTag         =   ""      Hierarchical    =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      LastKeyPressedAt=   0      Left            =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      RequiresSelection=   ""      RightSidePicture=   False      Scope           =   0      ScrollbarHorizontal=   ""      ScrollBarVertical=   True      SelectionGradient=   True      SelectionType   =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   12      TextUnit        =   0      Top             =   133      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   175      _ScrollWidth    =   -1   End   Begin Canvas cvsSearchField      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   700553708      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   33      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   101      UseFocusRing    =   True      Visible         =   True      Width           =   175      Begin TextField edtSearchField         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   16777215         Bold            =   ""         Border          =   False         CueText         =   "TV show title"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   16         HelpTag         =   "TV show title"         Index           =   -2147483648         InitialParent   =   "cvsSearchField"         Italic          =   ""         Left            =   28         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   ""         TextColor       =   0         TextFont        =   "System"         TextSize        =   12         TextUnit        =   0         Top             =   110         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   130      End   End   Begin ProgressWheel pgwDownloadInfo      AutoDeactivate  =   True      Enabled         =   True      Height          =   16      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   320      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      Top             =   418      Visible         =   False      Width           =   16   End   Begin Label lblDBID      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   26      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   9      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Use the search field with an TVDb ID to use that instead of a search result."      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   415      Transparent     =   False      Underline       =   ""      Visible         =   False      Width           =   267   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Close()		  BannerSocket.Close		  dwnloadTimer.Mode = 0		  tmpBanner = nil		  Scrape.ManualSearch = False		End Sub	#tag EndEvent	#tag Event		Function KeyDown(Key As String) As Boolean		  ManualSearch		End Function	#tag EndEvent	#tag Event		Sub Open()		  		  'self.FullScreenAuxiliaryMBS = true		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub ManualSearch()		  if Keyboard.AsyncKeyDown(&h4C) or Keyboard.AsyncKeyDown(&h24) then		    		    if edtSearchField.Active and edtSearchField.text <> "" then		      if edtSearchField.Text.Left(5) = "tvdb:" then		        self.Close		        Scrape.TVDBApi( edtSearchField.Text.ReplaceAll( "tvdb:", "" ) )		      else		        pgwDownloadInfo.Visible = True		        Scrape.ManualSearch = True		        Scrape.TVDBApiSearch( edtSearchField.Text )		        lstFoundShows.ListIndex = 0		      end if		    else		      		      #if TargetMacOS then		        CancelSave.btnRight.Push		      #else		        CancelSave.btnLeft.Push		      #endif		      		    end if		    		  elseif Keyboard.AsyncKeyDown(&h35) then		    #if TargetMacOS then		      CancelSave.btnLeft.Push		    #else		      CancelSave.btnRight.Push		    #endif		    		  end if		End Sub	#tag EndMethod	#tag Property, Flags = &h0		tmpBanner As Picture	#tag EndProperty#tag EndWindowCode#tag Events CancelSave	#tag Event		Sub ActionCancel()		  self.close		End Sub	#tag EndEvent	#tag Event		Sub ActionOK()		  self.close		  Scrape.TVDBApi( lstFoundShows.Cell( lstFoundShows.ListIndex, 1 ) )		  wndMain.PopulateTVShowsList		End Sub	#tag EndEvent	#tag Event		Sub Open()		  #if TargetMacOS then		    me.btnRight.Default = False		  #else		    me.btnLeft.Default = False		  #endif		End Sub	#tag EndEvent#tag EndEvents#tag Events cvsBanner	#tag Event		Sub Paint(g As Graphics)		  if tmpBanner = nil then		    		    Dim startColor, endColor as Color		    Dim i as Integer, ratio, endratio as Double		    		    #if TargetMacOS then		      if SystemInformationMBS.MacMinorVersion > 6 then		        startColor = RGB(232, 232, 232)		        endColor = RGB(193, 193, 193)		      else		        startColor = RGB(208, 208, 208)		        EndColor = RGB(167, 167, 167)		      end if		    #elseif TargetWin32 then		      if SystemInformationMBS.isWindowsXP then		        startColor = RGB(21, 170, 237)		        EndColor = RGB(35, 91, 217)		      elseif SystemInformationMBS.isWindows7 then		        startColor = RGB(161, 185, 211)		        endColor = RGB(189, 207, 227)		      end if		    #else		      		    #endif		    		    		    For i = 0 to g.Height		      		      ratio = ( ( g.Height - i) / g.Height )		      endratio = ( i / g.Height )		      g.ForeColor = RGB( _		      endColor.Red * endratio + startColor.Red * ratio, _		      endColor.Green * endratio + startColor.Green * ratio, _		      endColor.Blue * endratio + startColor.Blue * ratio )		      		      g.DrawLine 0, i, g.Width, i		      		    next		    		  else		    		    g.DrawPicture( tmpBanner, 0, 0, me.Width, me.Height, 0, 0, tmpBanner.Width, tmpBanner.Height )		    		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events BannerSocket	#tag Event		Sub Error(code as integer)		  SocketError(code, me)		End Sub	#tag EndEvent#tag EndEvents#tag Events dwnloadTimer	#tag Event		Sub Action()		  		  tmpBanner = Picture.FromData( BannerSocket.Get( "http://thetvdb.com/banners/" + lstFoundShows.Cell( lstFoundShows.ListIndex, 4 ), 0 ) )		  BannerSocket.Close		  pgwDownloadInfo.Visible = false		  cvsBanner.Refresh(false)		End Sub	#tag EndEvent#tag EndEvents#tag Events lstFoundShows	#tag Event		Sub Change()		  //  Title  ||  TVDBID  ||  Premiered  ||  Plot  ||  BannerURL  //		  		  pgwDownloadInfo.Visible = False		  BannerSocket.Close		  BannerSocket.Yield = true		  		  		  lblTitle.Text = me.Cell( me.ListIndex, 0)		  lblPremieredValue.Text = me.Cell( me.ListIndex, 2 )		  taPlot.Text = me.Cell( me.ListIndex, 3 )		  		  tmpBanner = nil		  		  if me.Cell( me.ListIndex, 4 ) <> "" then		    pgwDownloadInfo.Visible = True		    dwnloadTimer.Mode = 1		  end if		  		  cvsBanner.Refresh(false)		End Sub	#tag EndEvent	#tag Event		Sub DoubleClick()		  #if TargetMacOS then		    CancelSave.btnRight.Push		  #else		    CancelSave.btnLeft.Push		  #endif		End Sub	#tag EndEvent	#tag Event		Function KeyDown(Key As String) As Boolean		  if Keyboard.AsyncKeyDown(&h4C) or Keyboard.AsyncKeyDown(&h24) then		    		    if me.ListIndex > -1 then		      		      #if TargetMacOS then		        CancelSave.btnRight.Push		      #else		        CancelSave.btnLeft.Push		      #endif		      		    end if		  elseif Keyboard.AsyncKeyDown(&h35) then		    #if TargetMacOS then		      CancelSave.btnLeft.Push		    #else		      CancelSave.btnRight.Push		    #endif		    		  end if		End Function	#tag EndEvent#tag EndEvents#tag Events edtSearchField	#tag Event		Function KeyDown(Key As String) As Boolean		  ManualSearch		End Function	#tag EndEvent#tag EndEvents