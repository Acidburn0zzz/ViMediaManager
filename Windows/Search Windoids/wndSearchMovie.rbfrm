#tag WindowBegin Window wndSearchMovie   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   False   Composite       =   True   Frame           =   8   FullScreen      =   False   HasBackColor    =   False   Height          =   455   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   400   MinimizeButton  =   False   MinWidth        =   500   Placement       =   0   Resizeable      =   False   Title           =   "Search TMDb"   Visible         =   True   Width           =   760   Begin Canvas cvsPoster      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   True      Enabled         =   True      EraseBackground =   False      Height          =   168      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   312      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   47      UseFocusRing    =   True      Visible         =   True      Width           =   115   End   Begin Canvas cvsFanart      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   True      Enabled         =   True      EraseBackground =   False      Height          =   169      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   439      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Top             =   47      UseFocusRing    =   True      Visible         =   True      Width           =   300      Begin HTTPSocket ArtSocket         Address         =   ""         Height          =   32         Index           =   -2147483648         InitialParent   =   "cvsFanart"         Left            =   452         LockedInPosition=   False         Port            =   0         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Top             =   59         Width           =   32         yield           =   0      End      Begin Timer tmrDownloader         Height          =   32         Index           =   -2147483648         InitialParent   =   "cvsFanart"         Left            =   496         LockedInPosition=   False         Mode            =   0         Period          =   1000         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         Top             =   59         Width           =   32      End   End   Begin ListboxPRO lstFoundMovies      AlternatingRows =   True      AppleSidebar    =   False      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   ""      Border          =   True      ColumnCount     =   6      ColumnsResizable=   ""      ColumnWidths    =   "100%, *"      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   20      Enabled         =   True      EnableDrag      =   ""      EnableDragReorder=   ""      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   ""      HeadingIndex    =   -1      Height          =   371      HelpTag         =   ""      Hierarchical    =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      LastKeyPressedAt=   0      Left            =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      RequiresSelection=   True      RightSidePicture=   False      Scope           =   0      ScrollbarHorizontal=   True      ScrollBarVertical=   True      SelectionGradient=   True      SelectionType   =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   12      TextUnit        =   0      Top             =   32      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   300      _ScrollWidth    =   -1   End   Begin Label lblTitle      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   312      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Title"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   14      TextUnit        =   0      Top             =   14      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   427   End   Begin ccCancelSave CancelSave      AcceptFocus     =   ""      AcceptTabs      =   True      AutoDeactivate  =   True      BackColor       =   16777215      Backdrop        =   ""      Enabled         =   True      EraseBackground =   True      HasBackColor    =   False      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   568      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      mOKCaption      =   "&Save"      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Top             =   415      UseFocusRing    =   ""      Visible         =   True      Width           =   172   End   Begin Canvas cvsSearchField      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   1450526804      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   33      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   0      UseFocusRing    =   True      Visible         =   True      Width           =   300      Begin TextField edtSearchField         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   16777215         Bold            =   ""         Border          =   False         CueText         =   "Movie title (year) or IMDb ID"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   16         HelpTag         =   "Movie title (year) or IMDb ID"         Index           =   -2147483648         InitialParent   =   "cvsSearchField"         Italic          =   ""         Left            =   27         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   ""         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   9         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   255      End   End   Begin TextArea edtPlot      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   True      BackColor       =   16777215      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   175      HelpTag         =   ""      HideSelection   =   True      Index           =   -2147483648      Italic          =   ""      Left            =   299      LimitText       =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Mask            =   ""      Multiline       =   True      ReadOnly        =   True      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   True      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   228      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   461   End   Begin ProgressWheel pgWheel      AutoDeactivate  =   True      Enabled         =   True      Height          =   16      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   540      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   False      Scope           =   0      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      Top             =   418      Visible         =   False      Width           =   16   End   Begin Label lblDBID      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Use the search field with an IMDb ID to use that instead of a search result."      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   415      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   480   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Close()		  tmrDownloader.Mode = 0		  ArtSocket.Close		  Scrape.ManualSearch = False		End Sub	#tag EndEvent	#tag Event		Sub Open()		  'self.FullScreenAuxiliaryMBS = true		End Sub	#tag EndEvent	#tag Property, Flags = &h0		tmpFanart As Picture	#tag EndProperty	#tag Property, Flags = &h0		tmpPoster As Picture	#tag EndProperty#tag EndWindowCode#tag Events cvsPoster	#tag Event		Sub Paint(g As Graphics)		  if tmpPoster = nil then		    // Do nothing?		    g.ForeColor = &cFFFFFF		    g.FillRect 0, 0, me.Width, me.Height		  else		    g.DrawPicture( tmpPoster, 0, 0, me.Width, me.Height, 0, 0, tmpPoster.Width, tmpPoster.Height )		  end if		  		  g.ForeColor = &c000000		  g.DrawRect 0, 0, me.Width, me.Height		End Sub	#tag EndEvent#tag EndEvents#tag Events cvsFanart	#tag Event		Sub Paint(g As Graphics)		  if tmpFanart = nil then		    		    // Do nothing?		    		    g.ForeColor = &cFFFFFF		    g.FillRect 0, 0, me.Width, me.Height		    		    		  else		    		    g.DrawPicture( tmpFanart, 0, 0, me.Width, me.Height, 0, 0, tmpFanart.Width, tmpFanart.Height )		    		  end if		  		  		  g.ForeColor = &c000000		  g.DrawRect 0, 0, me.Width, me.Height		End Sub	#tag EndEvent#tag EndEvents#tag Events tmrDownloader	#tag Event		Sub Action()		  		  tmpPoster = Picture.FromData( ArtSocket.Get( lstFoundMovies.Cell( lstFoundMovies.ListIndex, 5 ), 0 ) )		  ArtSocket.Close		  cvsPoster.Refresh(false)		  		  tmpFanart = Picture.FromData( ArtSocket.Get( lstFoundMovies.Cell( lstFoundMovies.ListIndex, 6 ), 0 ) )		  ArtSocket.Close		  cvsFanart.Refresh(false)		  		  pgWheel.Visible = False		End Sub	#tag EndEvent#tag EndEvents#tag Events lstFoundMovies	#tag Event		Sub Change()		  // 0. sortTitle  ||  1. TMDbID  ||  2. Title  ||  3. Premiered  ||  4. Plot  ||  5. PosterThumbURL  ||  6. FanartThumbURL  //		  		  ArtSocket.Yield = True		  		  tmrDownloader.Mode = 0		  ArtSocket.close		  pgWheel.Visible = False		  		  if me.ListIndex > -1 then		    lblTitle.text = me.Cell( me.ListIndex, 2 ) + " (" + me.Cell( me.ListIndex, 3 ).Left(4) + ")"		    edtPlot.text = me.Cell( me.ListIndex, 4 )		  else		    lblTitle.text = ""		    edtPlot.Text = ""		  end if		  		  tmpPoster = nil		  tmpFanart = nil		  		  if me.Cell( me.ListIndex, 5 ) <> "" or me.Cell( me.ListIndex, 6 ) <> "" then		    pgWheel.Visible = True		    tmrDownloader.Mode = 1		  end if		  		  cvsPoster.Refresh(false)		  cvsFanart.Refresh(false)		End Sub	#tag EndEvent	#tag Event		Sub DoubleClick()		  if me.ListIndex > -1 then		    #if TargetMacOS then		      CancelSave.btnRight.Push		    #else		      CancelSave.btnLeft.Push		    #endif		  end if		End Sub	#tag EndEvent	#tag Event		Function KeyDown(Key As String) As Boolean		  if Keyboard.AsyncKeyDown(&h4C) or Keyboard.AsyncKeyDown(&h24) then		    		    if me.ListIndex > -1 then		      		      #if TargetMacOS then		        CancelSave.btnRight.Push		      #else		        CancelSave.btnLeft.Push		      #endif		      		    end if		    		  elseif Keyboard.AsyncKeyDown(&h35) then		    #if TargetMacOS then		      CancelSave.btnLeft.Push		    #else		      CancelSave.btnRight.Push		    #endif		    		  end if		End Function	#tag EndEvent#tag EndEvents#tag Events CancelSave	#tag Event		Sub ActionCancel()		  tmrDownloader.Mode = 0		  ArtSocket.Close		  Scrape.ManualSearch = False		  		  self.close		End Sub	#tag EndEvent	#tag Event		Sub ActionOK()		  tmrDownloader.Mode = 0		  ArtSocket.Close		  Scrape.ManualSearch = False		  		  self.close		  Scrape.TMDBApi( lstFoundMovies.Cell( lstFoundMovies.ListIndex, 1 ) )		  wndMain.PopulateMoviesList		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.btnRight.Default = false		End Sub	#tag EndEvent#tag EndEvents#tag Events edtSearchField	#tag Event		Function KeyDown(Key As String) As Boolean		  if Keyboard.AsyncKeyDown(&h4C) or Keyboard.AsyncKeyDown(&h24) then		    		    if edtSearchField.Active and edtSearchField.text <> "" then		      		      Scrape.ManualSearch = True		      pgWheel.Visible = True		      		      if edtSearchField.Text.Left(2) = "tt" then		        self.Close		        Scrape.TMDBApi( edtSearchField.Text )		      else		        Scrape.TMDBApiSearch( edtSearchField.Text )		      end if		      		    else		      #if TargetMacOS then		        CancelSave.btnRight.Push		      #else		        CancelSave.btnLeft.Push		      #endif		      		    end if		    		  elseif Keyboard.AsyncKeyDown(&h35) then		    #if TargetMacOS then		      CancelSave.btnLeft.Push		    #else		      CancelSave.btnRight.Push		    #endif		    		    		  end if		End Function	#tag EndEvent#tag EndEvents