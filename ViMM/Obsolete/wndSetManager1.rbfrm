#tag WindowBegin Window wndSetManager1   BackColor       =   &hFFFFFF   Backdrop        =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   4.84e+2   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   3   Resizeable      =   True   Title           =   "#kSetManager"   Visible         =   True   Width           =   1.16e+3   Begin AddRemoveButtons arSet      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   972      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Top             =   442      UseFocusRing    =   True      Visible         =   True      Width           =   45   End   Begin Listbox lstSets      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   ""      Border          =   True      ColumnCount     =   2      ColumnsResizable=   True      ColumnWidths    =   "100%, *"      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   22      Enabled         =   True      EnableDrag      =   True      EnableDragReorder=   True      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   True      HeadingIndex    =   -1      Height          =   416      HelpTag         =   ""      Hierarchical    =   True      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   972      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      RequiresSelection=   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollBarVertical=   True      SelectionType   =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   12      TextUnit        =   0      Top             =   14      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   168      _ScrollWidth    =   -1   End   Begin ListboxPRO ListboxPRO1      AlternatingRows =   True      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   ""      Border          =   True      ColumnCount     =   3      ColumnsResizable=   True      ColumnWidths    =   "33%, 40%, *"      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   22      Enabled         =   True      EnableDrag      =   True      EnableDragReorder=   False      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   True      HeadingIndex    =   -1      Height          =   450      HelpTag         =   ""      Hierarchical    =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      RequiresSelection=   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollBarVertical=   True      SelectionGradient=   True      SelectionType   =   1      SourceList      =   False      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   14      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   475      _ScrollWidth    =   -1   End   Begin Label Label1      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   139      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   507      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Untitled"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   66      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   453   End   Begin Label Label2      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   40      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   507      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Untitled"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   22      TextUnit        =   0      Top             =   14      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   453   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  Dim icns as new IconMBS( "fold", "MACS" )		  FolderIcon = icns.IconFamily.Small32BitData		  FolderIcon.Mask = icns.IconFamily.Small8BitMask		  		End Sub	#tag EndEvent	#tag MenuHandler		Function FileCloseWindow() As Boolean Handles FileCloseWindow.Action			Close			Return True					End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Sub init()		  Dim Sets() as String		  // Get all sets		  For i as integer = 0 to wndMain.lstMovies.ListCount - 1		    If wndMain.lstMovies.Cell( i, 9 ) <> "" then Sets.Append wndMain.lstMovies.Cell( i, 9 )		  Next		  		  // Sort sets and remove duplicates		  Sets.Sort		  For i as Integer = Sets.Ubound - 1 DownTo 0		    If Sets(i + 1) = Sets(i) Then Sets.Remove i + 1		  Next		  		  // Add sets to lstSets with a folder picture		  For i as Integer = 0 to Sets.Ubound		    lstSets.AddFolder Sets(i)		    lstSets.RowPicture(i) = FolderIcon		    lstSets.CellType(i, 0) = lstSets.TypeEditable		  Next		  		  // Expand all sets		  For i as Integer = 0 to lstSets.ListCount - 1		    lstSets.Expanded(i) = True		  Next		End Sub	#tag EndMethod	#tag Property, Flags = &h0		FolderIcon As Picture	#tag EndProperty	#tag Constant, Name = kSetManager, Type = String, Dynamic = True, Default = \"Set Manager", Scope = Protected		#Tag Instance, Platform = Any, Language = en, Definition  = \"Set Manager"		#Tag Instance, Platform = Any, Language = nl, Definition  = \"Set Manager"	#tag EndConstant#tag EndWindowCode#tag Events arSet	#tag Event		Sub ActionAdd()		  lstSets.AddFolder( "Untitled Set" )		  lstSets.RowPicture( lstSets.LastIndex ) = FolderIcon		  lstSets.CellType( lstSets.LastIndex, 0) = lstSets.TypeEditable		End Sub	#tag EndEvent	#tag Event		Sub ActionRemove()		  lstSets.RemoveRow( lstSets.ListIndex )		End Sub	#tag EndEvent#tag EndEvents#tag Events lstSets	#tag Event		Sub ExpandRow(row As Integer)		  For i as Integer = 0 to wndMain.lstMovies.ListCount - 1		    If wndMain.lstMovies.Cell( i, 9 ) = Me.Cell(row,0) then Me.AddRow wndMain.lstMovies.Cell( i, 0 ), wndMain.lstMovies.Cell( i, 1 )		    'Me.RowPicture( Me.LastIndex ) = miniconmovie		  Next		End Sub	#tag EndEvent	#tag Event		Sub Change()		  arSet.RemoveEnabled = Me.ListIndex > -1		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.AcceptTextDrop		End Sub	#tag EndEvent	#tag Event		Sub DropObject(obj As DragItem, action As Integer)		  If obj.TextAvailable Then		    me.AddRow( obj.Text )		  End If		End Sub	#tag EndEvent#tag EndEvents#tag Events ListboxPRO1	#tag Event		Sub Change()		  Dim f as FolderItem = GetFolderItem( me.Cell( me.ListIndex, 1 ) )		  MovieAttr.NFORead( f )		  		  Label1.Text = MovieAttr.DescriptionOutline		  label2.Text = MovieAttr.Title + " (" + str( MovieAttr.DateYear ) + ")"		End Sub	#tag EndEvent	#tag Event		Sub Open()		  		  For i as integer = 0 to wndMain.lstMovies.ListCount - 1		    If wndMain.lstMovies.Cell( i, 2 ) <> "" Then ListboxPRO1.AddRow wndMain.lstMovies.Cell( i, 3 ), wndMain.lstMovies.Cell( i, 1 )		  Next		  		  Me.SortedColumn = 0		  Me.Sort		End Sub	#tag EndEvent	#tag Event		Sub Close()		  wndMain.lstMovies.ListIndex = wndMain.lstMovies.ListIndex		End Sub	#tag EndEvent	#tag Event		Function DragRow(drag As DragItem, row As Integer) As Boolean		  drag.Text = me.List( row ) + chr(13)		  Return True		  		  		  drag.Text=Me.List(Row)+chr(13) //get the text		  Return True //allow the drag		End Function	#tag EndEvent#tag EndEvents