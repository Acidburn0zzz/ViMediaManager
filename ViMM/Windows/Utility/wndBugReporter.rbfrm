#tag WindowBegin Window wndBugReporter   BackColor       =   &hFFFFFF   Backdrop        =   ""   CloseButton     =   True   Composite       =   False   Frame           =   1   FullScreen      =   False   HasBackColor    =   False   Height          =   3.15e+2   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   True   Title           =   "#kBugReporter"   Visible         =   True   Width           =   500   Begin PushbuttonPro btnOK      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   True      Caption         =   "#kEmailBugReport"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   320      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   275      Underline       =   ""      Visible         =   True      Width           =   160   End   Begin SuperTextArea edtUserDescription      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   True      BackColor       =   &hFFFFFF      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   107      HelpTag         =   ""      HideSelection   =   True      Index           =   -2147483648      Italic          =   ""      Left            =   20      LimitText       =   0      LineHeight      =   0      LineSpacing     =   1      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Mask            =   ""      Multiline       =   True      ReadOnly        =   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   True      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   156      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   460   End   Begin cvsLogo cvsLogo1      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   64      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      Top             =   14      UseFocusRing    =   True      Visible         =   True      Width           =   64   End   Begin Label lblArray      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   2      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   8      TabPanelIndex   =   0      Text            =   "#kWhatWhereYouDoing"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   132      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   460   End   Begin PushbuttonPro btnCancel      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "#Loc.dlgCancel"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   228      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   275      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin Label lblArray      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   68      HelpTag         =   ""      Index           =   1      InitialParent   =   ""      Italic          =   ""      Left            =   96      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   10      TabPanelIndex   =   0      Text            =   "#kBugReportMessage"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   60      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   384   End   Begin TextArea edtSystemInfo      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   True      BackColor       =   &hFFFFFF      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Format          =   ""      Height          =   100      HelpTag         =   ""      HideSelection   =   True      Index           =   -2147483648      Italic          =   ""      Left            =   20      LimitText       =   0      LineHeight      =   0      LineSpacing     =   1      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Mask            =   ""      Multiline       =   True      ReadOnly        =   True      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   True      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   323      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   460   End   Begin Label lblArray      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   34      HelpTag         =   ""      Index           =   0      InitialParent   =   ""      Italic          =   ""      Left            =   96      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   11      TabPanelIndex   =   0      Text            =   "#kBugReportTitle"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   14      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   384   EndEnd#tag EndWindow#tag WindowCode	#tag Method, Flags = &h0		Function encodeURL(s as string) As string		  // Converts the input string to an encoded format suitable for use in URLs.		  // Non-alphanumeric characters are converted to "%xx" hexadecimal codes.		  dim a, bound, char as integer, result as string		  		  bound = len(s)		  for a = 1 to bound		    char = asc(mid(s, a, 1))		    if char < 16 then //add a zero		      result = result + "%0" + hex(char)		    elseif (char>47 and char<58) or (char>64 and char<91) or (char>96 and char<123) then		      result = result + chr(char) //0-9,A-Z,a-z		    else //special character		      result = result + "%"+ hex(char)		    end if		  next		  		  return result		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub Init(err as RuntimeException, Location as String = "")		  		  Dim EmailAddress as String = "ViMediaManager <vimediamanager@gmail.com>"		  		  		  Dim ErrInfo, ErrStack as String		  ErrInfo = "Runtime Exception: " + typeOfException( err ) + EndOfLine		  ErrInfo = ErrInfo + "Error: " + Str( err.ErrorNumber ) + EndOfLine		  ErrInfo = ErrInfo + "Message: " + err.Message + EndOfLine		  ErrInfo = ErrInfo + "Location: " + Location + EndOfLine + EndOfLine		  		  Dim Stack() as String = err.Stack		  		  If UBound( Stack ) > 0 Then		    ErrStack = "Stack: " + EndOfLine		    For i as Integer = 0 to Stack.Ubound		      If Stack(i).InStr(0, "REALPlugin") <= 0 Then ErrStack = ErrStack + Stack(i) + EndOfLine		    Next		  End If		  		  		  'edtError.Text = ErrInfo + ErrStack		  		  		  ShowModal		  		  Dim Subject as String = "ViMediaManager " + App.VersionCurrent.ReplaceAll("α", "a") + " / " + App.ExecutableFile.CreationDate.SQLDateTime.ReplaceAll( " ", "T" )		  		  Dim Settings as String		  Settings = Settings + EndOfLine + "Database Language: " + Prefs.stringForKey("DBLanguage")		  Settings = Settings + EndOfLine + "Retina: " + Str( App.ScalingFactor )		  Settings = Settings + EndOfLine + "Experimental: " + Str( App.Experimental )		  		  		  Dim Body as String		  body = ErrInfo + edtSystemInfo.Text + EndOfLine + EndOfLine		  body = body + "Settings:" + Settings + EndOfLine + EndOfLine		  body = body + "Description:" + EndOfLine + edtUserDescription.Text + EndOfLine + EndOfLine		  body = body + ErrStack		  		  If OKToSend Then ShowURL "mailto:" + encodeURL( EmailAddress ) + "?subject=" + encodeURL( Subject ) + "&body=" + encodeURL( Body )		  		  self.Close		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function typeOfException(err as RuntimeException) As string		  // Returns a text string indicating the type of RuntimeException passed in.		  Dim result as String		  		  If err isA IllegalCastException then		    result = "Illegal Cast Exception"		  ElseIf err isA KeyNotFoundException then		    result = "Key Not Found Exception"		  ElseIf err isA OutOfBoundsException then		    result = "Out Of Bounds Exception"		  ElseIf err isA OutOfMemoryException then		    result = "Out Of Memory Exception"		  ElseIf err isA RbScriptAlreadyRunningException then		    result = "RB Script Already Running Exception"		  ElseIf err isA RbScriptException then		    result = "RB Script Exception"		  ElseIf err isA RegExException then		    result = "RegEx Exception"		  ElseIf err isA ShellNotAvailableException then		    result = "Shell Not Available Exception"		  ElseIf err isA ShellNotRunningException then		    result = "Shell Not Running Exception"		  ElseIf err isA StackOverflowException then		    result = "Stack Overflow Exception"		  ElseIf err isA TypeMismatchException then		    result = "Type Mismatch Exception"		  ElseIf err isA UnsupportedFormatException then		    result = "Unsupported Format Exception"		  ElseIf err isA NoOpenTransportException then		    result = "No Open Transport Exception"		  ElseIf err isA InvalidParentException then		    result = "Invalid Parent Exception"		  ElseIf err isA EndException then		    result = "End Exception"		  ElseIf err isA NilObjectException then		    result = "Nil Object Exception"		    		    ' uncomment these lines if you are using the Office Automation plug-ins		    ' elseif err isA WordException then		    ' result = "WordException"		    ' elseif err isA ExcelException then		    ' result = "ExcelException"		    ' elseif err isA PowerPointException then		    ' result = "PowerPointException"		    		  End If		  		  Return result		End Function	#tag EndMethod	#tag Property, Flags = &h0		OKToSend As Boolean = True	#tag EndProperty	#tag Constant, Name = kBugReporter, Type = String, Dynamic = True, Default = \"Bug Reporter", Scope = Protected		#Tag Instance, Platform = Any, Language = en, Definition  = \"Bug Reporter"		#Tag Instance, Platform = Any, Language = nl, Definition  = \"Bug Reporter"	#tag EndConstant	#tag Constant, Name = kBugReportMessage, Type = String, Dynamic = True, Default = \"Please e-mail the developer with details of how and where this problem occurred\x2C so that it can be fixed in a future release.", Scope = Protected		#Tag Instance, Platform = Any, Language = en, Definition  = \"Please e-mail the developer with details of how and where this problem occurred\x2C so that it can be fixed in a future release."		#Tag Instance, Platform = Any, Language = nl, Definition  = \"Stuur alsjeblieft een email naar de ontwikkelaar met details over hoe en waar dit probleem zich voordeed zodat deze kan worden hersteld."	#tag EndConstant	#tag Constant, Name = kBugReportTitle, Type = String, Dynamic = True, Default = \"The program has encountered a serious error\x2C and may be about to crash.", Scope = Protected		#Tag Instance, Platform = Any, Language = en, Definition  = \"The program has encountered a serious error\x2C and may be about to crash."		#Tag Instance, Platform = Any, Language = nl, Definition  = \"Een ernstige fout is opgetreden in het programma en kan ieder ogenblik crashen."	#tag EndConstant	#tag Constant, Name = kEmailBugReport, Type = String, Dynamic = True, Default = \"E-mail Bug Report", Scope = Protected		#Tag Instance, Platform = Any, Language = en, Definition  = \"E-mail Bug Report"		#Tag Instance, Platform = Any, Language = nl, Definition  = \"E-Mail probleem rapport"	#tag EndConstant	#tag Constant, Name = kWhatWhereYouDoing, Type = String, Dynamic = True, Default = \"What you were doing when the problem occurred: (English)", Scope = Protected		#Tag Instance, Platform = Any, Language = en, Definition  = \"What you were doing when the problem occurred: (English)"		#Tag Instance, Platform = Any, Language = nl, Definition  = \"Wat u deed toen het probleem optrad:"	#tag EndConstant#tag EndWindowCode#tag Events btnOK	#tag Event		Sub Action()		  OKToSend = True		  self.Hide		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.Left = self.Width - Me.Width - 20		End Sub	#tag EndEvent#tag EndEvents#tag Events btnCancel	#tag Event		Sub Open()		  Me.Left = btnOK.Left - 10 - me.Width		End Sub	#tag EndEvent	#tag Event		Sub Action()		  OKToSend = False		  self.Hide		End Sub	#tag EndEvent#tag EndEvents#tag Events edtSystemInfo	#tag Event		Sub Open()		  Dim s as String = App.kAppName + " " + App.VersionCurrent + " / " + App.ExecutableFile.CreationDate.SQLDateTime.ReplaceAll( " ", "T" ) + EndOfLine + EndOfLine		  		  Dim v, OS as String, result as Integer		  if System.Gestalt("sysv", result) Then		    OS = hex(result)		    OS = left(OS, len(OS) - 2) + "." + mid(OS, len(OS) - 1, 1) + "." + right(OS, 1)		    v = OS		  end if		  		  s = s + "Machine Information:" + EndOfLine		  s = s + "Mac Model: " + SystemInformationMBS.MacModel + EndOfLine		  s = s + "OS Version: " + v + EndOfLine 'SystemInformationMBS.OSVersionString + EndOfLine		  s = s + "CPU Model: " + Trim( SystemInformationMBS.CPUBrandString )		  		  Me.Text = s		End Sub	#tag EndEvent#tag EndEvents