#tag WindowBegin Window wndBugReporter   BackColor       =   &hFFFFFF   Backdrop        =   ""   CloseButton     =   False   Composite       =   True   Frame           =   1   FullScreen      =   False   HasBackColor    =   False   Height          =   3.41e+2   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   False   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "#kBugReporter"   Visible         =   True   Width           =   6.0e+2   Begin PushbuttonPro btnOK      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   True      Caption         =   "#kEmailBugReport"      Default         =   False      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   464      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   301      Underline       =   ""      Visible         =   True      Width           =   116   End   Begin SuperTextArea edtUserDescription      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   True      BackColor       =   &hFFFFFF      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   107      HelpTag         =   ""      HideSelection   =   True      Index           =   -2147483648      Italic          =   ""      Left            =   160      LimitText       =   0      LineHeight      =   0      LineSpacing     =   1      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Mask            =   ""      Multiline       =   True      ReadOnly        =   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   True      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   "&c333333"      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   182      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   420   End   Begin cvsLogo AppLogo      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   128      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      Top             =   14      UseFocusRing    =   True      Visible         =   True      Width           =   128   End   Begin PushbuttonPro btnCancel      AutoDeactivate  =   False      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "#Loc.dlgCancel"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   372      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   301      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin Label lblArray      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   82      HelpTag         =   ""      Index           =   1      InitialParent   =   ""      Italic          =   ""      Left            =   160      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   10      TabPanelIndex   =   0      Text            =   "#kBugReportMessage"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   60      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   420   End   Begin TabPanel TabPanel1      AutoDeactivate  =   True      Bold            =   ""      Enabled         =   True      Height          =   212      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Panels          =   ""      Scope           =   0      SmallTabs       =   False      TabDefinition   =   "System\rException\rPreferences"      TabIndex        =   14      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   357      Underline       =   ""      Value           =   2      Visible         =   True      Width           =   560      Begin TextArea edtSystem         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   True         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   165         HelpTag         =   ""         HideSelection   =   True         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   33         LimitText       =   0         LineHeight      =   0         LineSpacing     =   1         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Multiline       =   True         ReadOnly        =   True         Scope           =   0         ScrollbarHorizontal=   ""         ScrollbarVertical=   True         Styled          =   True         TabIndex        =   0         TabPanelIndex   =   1         TabStop         =   True         Text            =   ""         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   395         Underline       =   ""         UseFocusRing    =   True         Visible         =   True         Width           =   532      End      Begin TextArea edtError         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   True         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   165         HelpTag         =   ""         HideSelection   =   True         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   33         LimitText       =   0         LineHeight      =   0         LineSpacing     =   1         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Multiline       =   True         ReadOnly        =   True         Scope           =   0         ScrollbarHorizontal=   ""         ScrollbarVertical=   True         Styled          =   True         TabIndex        =   0         TabPanelIndex   =   2         TabStop         =   True         Text            =   ""         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   395         Underline       =   ""         UseFocusRing    =   True         Visible         =   True         Width           =   532      End      Begin TextArea edtPrefs         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   True         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   165         HelpTag         =   ""         HideSelection   =   True         Index           =   -2147483648         InitialParent   =   "TabPanel1"         Italic          =   ""         Left            =   33         LimitText       =   0         LineHeight      =   0         LineSpacing     =   1         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Multiline       =   True         ReadOnly        =   ""         Scope           =   0         ScrollbarHorizontal=   ""         ScrollbarVertical=   True         Styled          =   True         TabIndex        =   0         TabPanelIndex   =   3         TabStop         =   True         Text            =   ""         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   395         Underline       =   ""         UseFocusRing    =   True         Visible         =   True         Width           =   532      End   End   Begin Label lblArray      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   32      HelpTag         =   ""      Index           =   3      InitialParent   =   ""      Italic          =   ""      Left            =   160      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   15      TabPanelIndex   =   0      Text            =   "#kBugReportTitle"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   22      TextUnit        =   0      Top             =   14      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   420   End   Begin Label lblArray      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   2      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   16      TabPanelIndex   =   0      Text            =   "#Loc.kDescription"      TextAlign       =   2      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   182      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   128   End   Begin SMTPSecureSocket MailSocket      CertificateFile =   ""      CertificatePassword=   ""      CertificateRejectionFile=   ""      ConnectionType  =   2      Height          =   32      Index           =   -2147483648      Left            =   823      LockedInPosition=   False      Scope           =   0      Secure          =   True      TabPanelIndex   =   0      Top             =   34      Width           =   32   End   Begin Label lblArray      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   4      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   True      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   17      TabPanelIndex   =   0      Text            =   "#kEmail"      TextAlign       =   2      TextColor       =   0      TextFont        =   "System"      TextSize        =   0.0e+      TextUnit        =   0      Top             =   149      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   128   End   Begin TextField edtEmail      AcceptTabs      =   False      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   False      Border          =   True      CueText         =   "someone@somewhere.com"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      Italic          =   False      Left            =   160      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   True      Mask            =   ""      Password        =   False      ReadOnly        =   False      Scope           =   0      TabIndex        =   18      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0.0e+      TextUnit        =   0      Top             =   148      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   200   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  'self.bottomBorderThickness = 48		  'self.bottomBorderThickness = 32		End Sub	#tag EndEvent	#tag Event		Sub Paint(g As Graphics, areas() As REALbasic.Rect)		  'Dim BottomHeight as Integer = g.Height		  '#If TargetCocoa Then		  'BottomHeight = g.Height - 14 - 20 - 14 - 1		  'g.DrawGradient( hsl(0, 0, 95), hsl(0, 0, 75), 0, 0, g.Width, BottomHeight )		  '#endif		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Function encodeURL(s as string) As string		  // Converts the input string to an encoded format suitable for use in URLs.		  // Non-alphanumeric characters are converted to "%xx" hexadecimal codes.		  dim a, bound, char as integer, result as string		  		  bound = len(s)		  for a = 1 to bound		    char = asc(mid(s, a, 1))		    if char < 16 then //add a zero		      result = result + "%0" + hex(char)		    elseif (char>47 and char<58) or (char>64 and char<91) or (char>96 and char<123) then		      result = result + chr(char) //0-9,A-Z,a-z		    else //special character		      result = result + "%"+ hex(char)		    end if		  next		  		  return result		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub Init(err as RuntimeException, Location as String = "")		  		  'Dim EmailAddress as String = "vimediamanager@gmail.com"		  		  		  Dim ErrInfo, ErrStack as String		  'ErrInfo = "Runtime Exception: " + typeOfException( err ) + EndOfLine		  'ErrInfo = ErrInfo + "Error: " + Str( err.ErrorNumber ) + EndOfLine		  'ErrInfo = ErrInfo + "Message: " + err.Message + EndOfLine		  'ErrInfo = ErrInfo + "Location: " + Location + EndOfLine + EndOfLine		  		  Dim Stack() as String = err.Stack		  		  If UBound( Stack ) > 0 Then		    ErrStack = "Stack: " + EndOfLine		    For i as Integer = 0 to Stack.Ubound		      'If Stack(i).InStr(0, "REALPlugin") <= 0 Then		      ErrStack = ErrStack + Stack(i) + EndOfLine		      'End If		    Next		  End If		  		  		  edtError.Text = ErrStack		  		  TheError = err		  TheErrorLocation = Location		  		  		  ShowModal		  		  'Dim Subject as String = "ViMediaManager " + App.VersionCurrent.ReplaceAll("α", "a") + " / " + App.ExecutableFile.CreationDate.SQLDateTime.ReplaceAll( " ", "T" )		  		  'Dim Settings as String		  '		  'Settings = Settings + EndOfLine + "DB Language: " + Prefs.stringForKey("DBLanguage")		  'Settings = Settings + EndOfLine + "Media Player: " + Prefs.stringForKey("MediaPlayer")		  'Settings = Settings + EndOfLine + "Retina: " + Str( App.ScalingFactor >= 2 )		  'Settings = Settings + EndOfLine + "Screen Width: " + Str( Screen(0).Width )		  'Settings = Settings + EndOfLine + "Screen Height: " + Str( Screen(0).Height )		  'Settings = Settings + EndOfLine + "Experimental: " + Str( App.Experimental )		  'Settings = Settings + EndOfLine + "MassSearch: " + Str( CommonCore.MassSearch )		  'Settings = Settings + EndOfLine + "Section: "		  'If ActiveSection = 0 Then		  'Settings = Settings + "Movies"		  'ElseIf ActiveSection = 1 Then		  'Settings = Settings + "TV Shows"		  'ElseIf ActiveSection = 2 Then		  'Settings = Settings + "Anime"		  'End If		  '		  'Settings = Settings + EndOfLine		  'Settings = Settings + EndOfLine + "Poster Size: " + Prefs.stringForKey("PosterSize")		  'Settings = Settings + EndOfLine + "Fanart Size: " + Prefs.stringForKey("FanartSize")		  		  		  'Dim Body as String		  'body = ErrInfo + edtSystem.Text + EndOfLine + EndOfLine		  'body = body + "Settings:" + Settings + EndOfLine + EndOfLine		  'body = body + "Description:" + EndOfLine + edtUserDescription.Text + EndOfLine + EndOfLine		  'body = body + ErrStack		  		  'If OKToSend Then ShowURL "mailto:" + encodeURL( EmailAddress ) + "?subject=" + encodeURL( Subject ) + "&body=" + encodeURL( Body )		  		  self.Close		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SendMail()		  		  self.Hide		  		  dim BuildTime as new NativeSubclass.DateExtended( App.ExecutableFile.CreationDate )		  'BuildTime = app.ExecutableFile.CreationDate		  		  dim CreationDate as String		  if BuildTime <> Nil then		    CreationDate = BuildTime.ISO8601		  end if		  		  dim subject as string = "Bug Report" + " " + App.kAppName + " " + App.VersionCurrent + " / " + CreationDate		  dim message as string		  message = "<b>" + subject + "</b>"		  'if chkSendSystemProfile.Value then		  'message = message + pInfoSystem		  'end if		  'message = message + pInfoSettings		  '		  'if popFeedbackType.ListIndex = 0 then		  'message = message + "<h2>_______ User Rating _______</h2>" + "<br/>"		  'message = message + Str( cvsRating.Rating ) + " Stars"		  'message = message + "<br/>"		  'end if		  '		  'if trim( edtEmail.Text ) <> ""  then		  'message = message + "<h2>_______ eMail Address _______</h2>" + "<br/>"		  'message = message + trim( edtEmail.Text )		  'message = message + "<br/>"		  'end if		  '		  'if trim( edtDescription.Text ) <> "" then		  'message = message + "<h2>_______ Description _______</h2>" + "<br/>"		  'message = message + trim( edtDescription.Text.ReplaceAll( EndOfLine, "<br/>" ) ) + "<br/>"		  'message = message + "<br/>"		  'end if		  'message = message + pInfoError		  		  Dim ErrInfo as String		  ErrInfo = "Runtime Exception: " + typeOfException( TheError ) + EndOfLine		  ErrInfo = ErrInfo + "Error: " + Str( TheError.ErrorNumber ) + EndOfLine		  ErrInfo = ErrInfo + "Error Message: " + TheError.Message + EndOfLine		  ErrInfo = ErrInfo + "Last Message: " + App.ErrorMessage + EndOfLine		  ErrInfo = ErrInfo + "Location: " + TheErrorLocation		  		  message = message + EndOfLine + EndOfLine + ErrInfo		  		  		  if trim( edtEmail.Text ) <> "" then		    message = message + EndOfLine + EndOfLine + "<b>_______ Email _______</b>" + EndOfLine + EndOfLine		    message = message + trim( edtEmail.Text )		  end if		  		  if Trim( edtUserDescription.Text ) <> "" then		    message = message + EndOfLine + EndOfLine + "<b>_______ Description _______</b>" + EndOfLine + EndOfLine		    message = message + Trim( edtUserDescription.Text )		  else		  end if		  		  message = message + EndOfLine + EndOfLine + "<b>_______ System _______</b>" + EndOfLine + EndOfLine		  message = message + edtSystem.Text		  		  message = message + EndOfLine + EndOfLine + "<b>_______ Error _______</b>" + EndOfLine + EndOfLine		  message = message + edtError.Text		  		  message = message + EndOfLine + EndOfLine + "<b>_______ Prefs _______</b>" + EndOfLine + EndOfLine		  message = message + edtPrefs.Text		  		  message = message.ReplaceAll( EndOfLine, "<br/>" + EndOfLine )		  		  // Some CSS		  dim style as string = "<style>" + EndOfLine		  style = style + "h1 { font-size: 1.5em; display: block; }" + EndOfLine		  style = style + "h2 { font-size: 1.2em; display: inline-block; }" + EndOfLine		  style = style + "b { display: inline-block; min-width: 180px; }" + EndOfLine		  style = style + "</style>"		  		  // Attachments		  'dim attch() as EmailAttachment		  '		  'if FileAttachments <> Nil and FileAttachments.Ubound > -1 then		  'for each file as FolderItem in FileAttachments		  'if file <> Nil and file.Exists and file.IsReadable then		  'dim theAttachment as new EmailAttachment		  'theAttachment.LoadFromFile( file )		  'if theAttachment <> Nil then		  'attch.Append theAttachment		  'end if		  '		  'end if // @END file <> Nil		  'next		  'end if		  		  // Set and Send Mail message		  #if False then		    MailSocket.Address = "smtp.gmail.com"		    MailSocket.Port = 465		    		    MailSocket.Username = "ViMediaManager@gmail.com" '"vidal.vanbergen@gmail.com"		    MailSocket.Password = "Back_To_The_Future_86"		    		    dim mail as new EmailMessage		    if trim( edtEmail.Text ) <> "" then		      mail.FromAddress = trim( edtEmail.Text )		    end if		    if mail.FromAddress = "" then		      mail.FromAddress = "ViMediaManager@gmail.com"		    end if		    mail.Subject = subject		    mail.BodyPlainText = imdb.RemoveTags( message.ReplaceAll( "<br/>", EndOfLine ) )		    mail.BodyHTML = style + Message		    'if attch <> Nil and attch.Ubound > -1 then		    'mail.Attachments = attch		    'end if		    mail.Headers.AppendHeader( "X-Mailer","Xojo SMTP Demo" )		    mail.AddRecipient "vimediamanager@gmail.com"		    		    MailSocket.Messages.Append( mail )		    MailSocket.SendMail		  #else		    // Set and Send Mail message		    MailSocket.Address = "smtp.gmail.com"		    MailSocket.Port = 465		    		    MailSocket.Username = "vidal.vanbergen@gmail.com"		    MailSocket.Password = DecodeHex( "4261636B5F546F5F5468655F4675747572655F3836" )		    		    dim mail as new EmailMessage		    if trim( edtEmail.Text ) <> "" then		      mail.FromAddress = trim( edtEmail.Text )		    end if		    if mail.FromAddress = "" then		      mail.FromAddress = "Mariusth86@gmail.com"		    end if		    mail.Subject = subject		    mail.BodyPlainText = imdb.RemoveTags( message.ReplaceAll( "<br/>", EndOfLine ) )		    mail.BodyHTML = style + Message		    'if attch <> Nil and attch.Ubound > -1 then		    'mail.Attachments = attch		    'end if		    mail.Headers.AppendHeader( "X-Mailer","Xojo SMTP Demo" )		    mail.AddRecipient "vimediamanager@gmail.com"		    		    MailSocket.Messages.Append( mail )		    MailSocket.SendMail		  #endif		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function typeOfException(err as RuntimeException) As string		  // Returns a text string indicating the type of RuntimeException passed in.		  Dim result as String		  		  If err isA IllegalCastException then		    result = "Illegal Cast Exception"		  ElseIf err isA KeyNotFoundException then		    result = "Key Not Found Exception"		  ElseIf err isA OutOfBoundsException then		    result = "Out Of Bounds Exception"		  ElseIf err isA OutOfMemoryException then		    result = "Out Of Memory Exception"		  ElseIf err isA RbScriptAlreadyRunningException then		    result = "RB Script Already Running Exception"		  ElseIf err isA RbScriptException then		    result = "RB Script Exception"		  ElseIf err isA RegExException then		    result = "RegEx Exception"		  ElseIf err isA ShellNotAvailableException then		    result = "Shell Not Available Exception"		  ElseIf err isA ShellNotRunningException then		    result = "Shell Not Running Exception"		  ElseIf err isA StackOverflowException then		    result = "Stack Overflow Exception"		  ElseIf err isA TypeMismatchException then		    result = "Type Mismatch Exception"		  ElseIf err isA UnsupportedFormatException then		    result = "Unsupported Format Exception"		  ElseIf err isA NoOpenTransportException then		    result = "No Open Transport Exception"		  ElseIf err isA InvalidParentException then		    result = "Invalid Parent Exception"		  ElseIf err isA EndException then		    result = "End Exception"		  ElseIf err isA NilObjectException then		    result = "Nil Object Exception"		    		    ' uncomment these lines if you are using the Office Automation plug-ins		    ' elseif err isA WordException then		    ' result = "WordException"		    ' elseif err isA ExcelException then		    ' result = "ExcelException"		    ' elseif err isA PowerPointException then		    ' result = "PowerPointException"		    		  End If		  		  Return result		End Function	#tag EndMethod	#tag Property, Flags = &h0		OKToSend As Boolean = True	#tag EndProperty	#tag Property, Flags = &h0		TheError As RuntimeException	#tag EndProperty	#tag Property, Flags = &h0		TheErrorLocation As String	#tag EndProperty	#tag Constant, Name = kBugReporter, Type = String, Dynamic = True, Default = \"Bug Reporter", Scope = Protected		#Tag Instance, Platform = Any, Language = en, Definition  = \"Bug Reporter"		#Tag Instance, Platform = Any, Language = nl, Definition  = \"Bug Reporter"		#Tag Instance, Platform = Any, Language = de, Definition  = \"Bug Reporter"	#tag EndConstant	#tag Constant, Name = kBugReportMessage, Type = String, Dynamic = True, Default = \"ViMediaManager has encountered a bug\x2C I\'m sorry for the inconvenience and would appreciate a detailed description of the last actions you\'ve taken before this problem occurred.\rI will investigate the problem for possible solutions.", Scope = Protected		#Tag Instance, Platform = Any, Language = en, Definition  = \"ViMediaManager has encountered a bug\x2C I\'m sorry for the inconvenience and would appreciate a detailed description of the last actions you\'ve taken before this problem occurred.\rI will investigate the problem for possible solutions."		#Tag Instance, Platform = Any, Language = nl, Definition  = \"Stuur alsjeblieft een email naar de ontwikkelaar met details over hoe en waar dit probleem zich voordeed zodat deze kan worden hersteld."	#tag EndConstant	#tag Constant, Name = kBugReportTitle, Type = String, Dynamic = True, Default = \"Something went wrong...", Scope = Protected		#Tag Instance, Platform = Any, Language = en, Definition  = \"Something went wrong..."		#Tag Instance, Platform = Any, Language = nl, Definition  = \"Er ging iets mis..."		#Tag Instance, Platform = Any, Language = de, Definition  = \"Etwas schief gelaufen ist..."	#tag EndConstant	#tag Constant, Name = kEmail, Type = String, Dynamic = True, Default = \"Email:", Scope = Protected		#Tag Instance, Platform = Any, Language = en, Definition  = \"Email:"		#Tag Instance, Platform = Any, Language = nl, Definition  = \"Email:"	#tag EndConstant	#tag Constant, Name = kEmailBugReport, Type = String, Dynamic = True, Default = \"Send Report", Scope = Protected		#Tag Instance, Platform = Any, Language = en, Definition  = \"Send Report"		#Tag Instance, Platform = Any, Language = nl, Definition  = \"Rapport verzenden"		#Tag Instance, Platform = Any, Language = de, Definition  = \"Send Report"	#tag EndConstant	#tag Constant, Name = kWhatWhereYouDoing, Type = String, Dynamic = True, Default = \"What you were doing when the problem occurred: (English)", Scope = Protected		#Tag Instance, Platform = Any, Language = en, Definition  = \"What you were doing when the problem occurred: (English)"		#Tag Instance, Platform = Any, Language = nl, Definition  = \"Wat u deed toen het probleem optrad:"		#Tag Instance, Platform = Any, Language = de, Definition  = \"Was Sie taten\x2C als das Problem auftrat: (englisch)"	#tag EndConstant#tag EndWindowCode#tag Events btnOK	#tag Event		Sub Action()		  'OKToSend = True		  SendMail		  self.Hide		End Sub	#tag EndEvent	#tag Event		Sub Open()		  'me.Left = self.Width - Me.Width - 20		  '#If TargetCarbon Then Me.Top = self.Height - Me.Height - 20		End Sub	#tag EndEvent#tag EndEvents#tag Events btnCancel	#tag Event		Sub Action()		  OKToSend = False		  self.Hide		End Sub	#tag EndEvent	#tag Event		Sub Open()		  'Me.Left = btnOK.Left - 10 - me.Width		  '#If TargetCarbon Then Me.Top = self.Height - Me.Height - 20		  'Me.Visible = DebugBuild		End Sub	#tag EndEvent#tag EndEvents#tag Events edtSystem	#tag Event		Sub Open()		  		  'LANGUAGE = en		  'CPU_64BIT = YES		  'CPU_COUNT = 8		  'CPU_SPEED = 2600		  'CPU_TYPE = Intel(R) Core(TM) i7-3720QM CPU @ 2.60GHz		  'RAM_SIZE = 16384		  'MACHINE_MODEL = MacBookPro10,1		  'OS_VERSION = 10.8.3		  		  Dim s as String		  		  s = s + "LANGUAGE = "      + Prefs.dictionaryRepresentation.Lookup("NSLanguageName", "") + EndOfLine		  s = s + "CPU_SPEED = "     + Trim( Str( SystemInformationMBS.CPUSpeed / 1000000000 ) ) + " Ghz" + EndOfLine		  s = s + "CPU_TYPE = "      + Trim( SystemInformationMBS.CPUBrandString ) + EndOfLine		  s = s + "RAM_SIZE = "      + Trim( Str( SystemInformationMBS.PhysicalRAM / 1000000000 ) ) + EndOfLine		  s = s + "MACHINE_MODEL = " +  Trim( SystemInformationMBS.MacModel ) + EndOfLine		  s = s + "OS_VERSION = "    + Trim( SystemInformationMBS.OSVersionString.ReplaceAll("Mac OS X", "") ) + EndOfLine		  s = s + "SCREEN_WIDTH = "  + Str( Screen(0).Width ) + EndOfLine		  s = s + "SCREEN_HEIGHT = " + Str( Screen(0).Height ) + EndOfLine		  s = s + "RETINA = "        + Str( App.ScalingFactor >= 2 ) + EndOfLine		  		  s = s + EndOfLine		  s = s + "EXPERIMENTAL = "  + Str( App.Experimental ) + EndOfLine		  s = s + "MASSEARCH = "     + Str( CommonCore.MassSearch ) + EndOfLine		  		  		  Dim Settings as String		  		  Settings = Settings + EndOfLine + "DB Language: " + Prefs.stringForKey("DBLanguage")		  Settings = Settings + EndOfLine + "Media Player: " + Prefs.stringForKey("MediaPlayer")		  Settings = Settings + EndOfLine + "Section: "		  If ActiveSection = 0 Then		    Settings = Settings + "Movies"		  ElseIf ActiveSection = 1 Then		    Settings = Settings + "TV Shows"		  ElseIf ActiveSection = 2 Then		    Settings = Settings + "Anime"		  End If		  Settings = Settings + EndOfLine + "Poster Size: " + Prefs.stringForKey("PosterSize")		  Settings = Settings + EndOfLine + "Fanart Size: " + Prefs.stringForKey("FanartSize")		  		  s = s + chr(13) + Settings		  		  Me.Text = s		End Sub	#tag EndEvent#tag EndEvents#tag Events edtPrefs	#tag Event		Sub Open()		  Dim Dict as Dictionary = Prefs.dictionaryRepresentation		  		  Dim MyPrefs() as String		  		  For each key as String in Dict.Keys		    Dim Value as Variant = Dict.Value( key )		    If Value = Nil OR Value.IsArray Then Continue		    		    If Key.Contains( "Apple" ) OR Key.Contains( "com." ) Then Continue		    If Key.Left(2) = "NS" Then Continue		    		    If Value.Type = Variant.TypeInteger OR _		      Value.Type = Variant.TypeBoolean OR _		      Value.Type = Variant.TypeColor OR _		      Value.Type = Variant.TypeDouble OR _		      Value.Type = Variant.TypeSingle OR _		      Value.Type = Variant.TypeDate Then		      MyPrefs.Append Key + " = " + Str( Value )		      		    ElseIf Value.Type = Variant.TypeString Then		      MyPrefs.Append Key + " = " + Value		      		      		      		    Else		      MyPrefs.Append Key + " = " + "???"		    End If		    		  Next		  		  MyPrefs.Sort		  		  For each Pref as String in MyPrefs		    Me.Text = Me.Text + Pref + Chr(13)		  Next		End Sub	#tag EndEvent#tag EndEvents#tag Events MailSocket	#tag Event		Sub ServerError(ErrorID as integer, ErrorMessage as string, Email as EmailMessage)		  #Pragma Unused ErrorID		  #Pragma Unused Email		  		  log "Error: " + ErrorMessage		End Sub	#tag EndEvent#tag EndEvents